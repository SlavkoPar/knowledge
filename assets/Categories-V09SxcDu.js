const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/AutoSuggestAnswers-BoUWgdyd.js","assets/index-qR-_KCtn.js","assets/index-CykrPP6v.css","assets/lib-D2nWr6mQ.js","assets/utilities-8g5q_ELR.js","assets/AutoSuggestAnswers-vl2QUoNQ.css"])))=>i.map(i=>d[i]);
import{_ as ae,A as r,d as St,a as jt,b as Nt,F as x,I as Re,u as Ne,c as le,r as E,C as ve,e as Te,f as de,g as Pe,h as _t,Q as $e,i as Ee,j as At,k as je,l as vt,m as It,n as e,B as $,o as Ot,p as Ue,R as we,D as Se,q as me,s as bt,t as Qt,v as Dt,w as kt}from"./index-qR-_KCtn.js";import{L as ee,F as ie,f as Me,a as ze,u as xe,M as K,b as Lt,c as Gt,d as _e,B as Ae,e as Ve,g as Ke,h as Ye,i as Ie,j as O,S as De,k as Oe,s as qt,l as Ft,C as Be,m as We,n as Pt,o as $t,p as Ut,q as Mt,r as zt}from"./Options-DmJ7Hian.js";import{f as He,a as Vt}from"./utilities-8g5q_ELR.js";import{A as Kt}from"./AutoSuggestQuestions-8Ssdk3R-.js";import"./lib-D2nWr6mQ.js";const be={topId:"",parentId:"null",id:ae,categoryTitle:"",title:"",assignedAnswers:[],numOfAssignedAnswers:0,relatedFilters:[],numOfRelatedFilters:0,source:0,status:0,included:!1},Xe={topId:"null",parentId:"null",id:"define at BackEnd",kind:0,title:"",link:"",header:"",level:0,variations:[],hasSubCategories:!1,categoryRows:[],questionRows:[],numOfQuestions:0,hasMoreQuestions:!1,isExpanded:!1,doc1:""},Yt=(t,i)=>{console.log("------------------------------->"),console.log("------------------------------->",i.type),console.log("------------------------------->");const{categoryRow:g}=i.payload;if(i.type===r.SET_KEY_EXPANDED){const{keyExpanded:l}=i.payload;return{...t,keyExpanded:l,nodeOpened:l===null?!0:t.nodeOpened}}let n=g?!St.includes(i.type):!1;const{topRows:a}=t,u=jt.includes(i.type)?{...t}:Bt(t,i);if(n&&g){let l;const h=i.type==="SET_CATEGORY_ADDED",{topId:T,id:C}=g;if(C===T){const j=h?ae:T;l=a.map(o=>o.id===j?new Z(g).categoryRow:new Z(o).categoryRow)}else{const j=a.find(S=>S.id===T);Z.idToSet=i.type==="SET_CATEGORY_ADDED"?ae:C,Z.newCategoryRow=g;const o=new Z(j).categoryRow;l=a.map(S=>S.id===T?o:new Z(S).categoryRow),Z.idToSet=""}u.topRows=l}if(Nt.includes(i.type)){const{keyExpanded:l}=u,h={keyExpanded:l};localStorage.setItem("CATEGORIES_STATE",JSON.stringify(h))}return console.log("CategoryReducer newState",u),u},Bt=(t,i)=>{switch(i.type){case r.SET_TOP_ROWS_LOADING:return{...t,loadingCategories:!0,topRowsLoading:!0,topRowsLoaded:!1};case r.SET_TOP_ROWS:{const{topRows:n}=i.payload;return console.log("=> CategoriesReducer ActionTypes.SET_TOP_ROWS",t.topRows,n),{...t,topRows:n,topRowsLoading:!1,topRowsLoaded:!0,loadingCategories:!1}}case r.SET_ALL_CATEGORY_ROWS:{const{allCategoryRows:n}=i.payload;return{...t,allCategoryRows:n,allCategoryRowsLoaded:Date.now()}}case r.SET_ALL_GROUP_ROWS:{const{allGroupRows:n}=i.payload;return{...t,allGroupRows:n,allGroupRowsLoaded:Date.now()}}case r.SET_NODE_EXPANDING_UP_THE_TREE:{const{categoryId_questionId_done:n}=i.payload;return{...t,categoryId_questionId_done:n,nodeOpening:!0,loadingCategories:!0,nodeOpened:!1,activeCategory:null,activeQuestion:null}}case r.SET_NODE_EXPANDED_UP_THE_TREE:{const{category:n,questionId:a,question:u,formMode:l}=i.payload;return{...t,activeCategory:n,activeQuestion:u,selectedQuestionId:a,formMode:l,nodeOpening:!1,nodeOpened:!0,loadingCategories:!1}}case r.SET_LOADING_CATEGORIES:return{...t,loadingCategories:!0};case r.SET_LOADING_CATEGORY:return{...t,loadingCategory:!0,categoryLoaded:!1};case r.FORCE_OPEN_NODE:const{keyExpanded:g}=i.payload;return alert("FORCE_OPEN_NODE is deprecated, use SET_QUESTION_SELECTED instead"),{...t,topRows:t.topRows.filter(n=>n.parentId===null),keyExpanded:g,nodeOpened:!1,activeCategory:null,activeQuestion:null,selectedQuestionId:null};case r.SET_SUB_CATEGORIES:return{...t,loadingCategory:!1};case r.SET_ERROR:{const{error:n,whichRowId:a}=i.payload;return{...t,error:n,whichRowId:a,loadingCategories:!1,loadingQuestions:!1,loadingCategory:!1,categoryLoaded:!1,loadingQuestion:!1,questionLoaded:!1}}case r.SET_CATEGORY:{const{categoryRow:n}=i.payload;return console.assert(Re(n)),{...t,loadingCategory:!1,categoryLoaded:!0,activeCategory:n,activeQuestion:null,selectedQuestionId:null}}case r.SET_ROW_EXPANDING:return{...t,rowExpanding:!0,rowExpanded:!1,loadingCategories:!0};case r.SET_ROW_EXPANDED:{const{categoryRow:n}=i.payload,{topId:a,id:u}=n,{keyExpanded:l}=t,h=l?l.questionId:null;return{...t,loadingCategories:!1,keyExpanded:{topId:a,categoryId:u,questionId:h},activeQuestion:null,selectedQuestionId:h,loadingQuestion:!1,questionLoaded:!1,rowExpanding:!1,rowExpanded:!0}}case r.SET_ROW_COLLAPSED:{const{categoryRow:n}=i.payload,{topId:a,parentId:u}=n;return{...t,loadingCategories:!1,keyExpanded:{topId:a,categoryId:u??"",questionId:null},rowExpanding:!1,rowExpanded:!0,activeCategory:null,activeQuestion:null,selectedQuestionId:null}}case r.SET_CATEGORY_TO_VIEW:{const{categoryRow:n}=i.payload;console.assert(Re(n));const u={...n,isExpanded:!1};return{...t,formMode:x.ViewingCategory,loadingCategory:!1,activeCategory:u,activeQuestion:null,selectedQuestionId:null,error:void 0}}case r.SET_CATEGORY_TO_ADD:{const{newCategoryRow:n}=i.payload,{parentId:a}=n;return{...t,loadingCategory:!1,categoryLoaded:!0,activeCategory:{...n,doc1:""},activeQuestion:null,selectedQuestionId:null,topRows:a?t.topRows:[n,...t.topRows],formMode:x.AddingCategory}}case r.SET_CATEGORY_ADDED:{const{categoryRow:n}=i.payload;console.assert(Re(n));const u={...n,isExpanded:!1},{topId:l,id:h}=u;return{...t,formMode:x.EditingCategory,loadingCategory:!1,categoryLoaded:!1,activeCategory:u,activeQuestion:null,selectedQuestionId:null,keyExpanded:{topId:l,categoryId:h,questionId:null}}}case r.SET_CATEGORY_TO_EDIT:case r.SET_CATEGORY_UPDATED:{const{categoryRow:n,category:a}=i.payload;console.assert(Re(n));const{topId:u,id:l}=a;return{...t,formMode:x.EditingCategory,loadingCategory:!1,categoryLoaded:!0,keyExpanded:{topId:u,categoryId:l,questionId:null},activeCategory:a,activeQuestion:null,selectedQuestionId:null,error:void 0}}case r.SET_CATEGORY_QUESTIONS_LOADING:return{...t,loadingQuestions:!0,questionLoaded:!1};case r.CATEGORY_QUESTIONS_LOADED:return{...t,loadingQuestions:!1};case r.CATEGORY_DELETED:{const{categoryRow:n,id:a}=i.payload,u=n?t.topRows:t.topRows.filter(l=>l.id!==a);return{...t,topRows:u,loadingCategories:!1,activeCategory:null,formMode:x.None,error:void 0,whichRowId:void 0,keyExpanded:{topId:n?n.topId:"",categoryId:n?n.parentId??"":"",questionId:""}}}case r.CANCEL_CATEGORY_FORM:case r.CLOSE_CATEGORY_FORM:return{...t,activeCategory:null,formMode:x.None};case r.CANCEL_ADD_CATEGORY:{const{topRows:n}=i.payload;return{...t,topRows:n,activeCategory:null,activeQuestion:null,selectedQuestionId:null,formMode:x.None}}case r.SET_LOADING_QUESTION:return{...t,loadingQuestion:!0,questionLoaded:!1};case r.CANCEL_ADD_QUESTION:return{...t,formMode:x.None,activeQuestion:null,selectedQuestionId:null};case r.SET_QUESTION_SELECTED:{const{questionKey:n}=i.payload,{topId:a,parentId:u,id:l}=n;return{...t,topRows:t.topRows.filter(h=>h.parentId===null),keyExpanded:{topId:a,categoryId:u,questionId:l},activeCategory:null,activeQuestion:null,selectedQuestionId:null}}case r.ADD_NEW_QUESTION_TO_ROW:{const{newQuestionRow:n}=i.payload;return{...t,selectedQuestionId:n.id}}case r.SET_QUESTION:{const{question:n,formMode:a}=i.payload;return console.log(r.SET_QUESTION,n),{...t,activeCategory:null,activeQuestion:n,formMode:a,error:void 0,loadingCategory:!1,loadingQuestion:!1,questionLoaded:!0}}case r.SET_QUESTION_AFTER_ASSIGN_ANSWER:{const{question:n}=i.payload;return{...t,activeQuestion:n,loadingQuestion:!1,questionLoaded:!0}}case r.SET_QUESTION_TO_VIEW:{const{question:n}=i.payload,{keyExpanded:a}=t;return{...t,formMode:x.ViewingQuestion,keyExpanded:a,activeQuestion:n,loadingQuestion:!1,questionLoaded:!0}}case r.SET_QUESTION_TO_EDIT:{const{question:n}=i.payload,{topId:a,id:u,parentId:l}=n;return{...t,keyExpanded:{topId:a,categoryId:l,questionId:u},activeQuestion:n,formMode:x.EditingQuestion,selectedQuestionId:n.id,loadingQuestion:!1,questionLoaded:!0}}case r.QUESTION_DELETED:return{...t,activeQuestion:null,selectedQuestionId:null,formMode:x.None,loadingQuestion:!1,questionLoaded:!0};case r.CANCEL_QUESTION_FORM:case r.CLOSE_QUESTION_FORM:return{...t,formMode:x.None,activeQuestion:null,selectedQuestionId:null};default:return alert(`Action ${i.type} not allowed`),{...t}}};class Z{static idToSet;static newCategoryRow;constructor(i){const{topId:g,id:n,parentId:a,title:u,link:l,kind:h,header:T,level:C,variations:j,numOfQuestions:o,hasSubCategories:S,categoryRows:N,created:b,modified:q,questionRows:A,isExpanded:G}=i,F=N.map(R=>(console.log("DeepClone >>>>>>>>>>>>>>>",R.id),R.id===Z.idToSet?{...Z.newCategoryRow}:new Z(R).categoryRow));this.categoryRow={topId:g,parentId:a,id:n,kind:h,title:u,link:l,header:T,level:C,hasSubCategories:S,categoryRows:F,numOfQuestions:o,questionRows:A,variations:j??[],created:b,modified:q,isExpanded:G}}categoryRow}const Je=E.createContext({}),Ze=E.createContext(()=>null),Wt={formMode:x.None,allCategoryRows:new Map,allCategoryRowsLoaded:void 0,allGroupRows:new Map,allGroupRowsLoaded:void 0,topRows:[],topRowsLoading:!1,topRowsLoaded:!1,nodeOpening:!1,nodeOpened:!1,keyExpanded:null,categoryId_questionId_done:void 0,activeCategory:null,activeQuestion:null,selectedQuestionId:null,loadingCategories:!1,loadingQuestions:!1,loadingCategory:!1,categoryLoaded:!1,loadingQuestion:!1,questionLoaded:!1,error:void 0,rowExpanding:!1,rowExpanded:!1},Ht=({children:t})=>{const{loadAllCategoryRowsGlobal:i,loadAllGroupRowsGlobal:g}=Ne(),n=le(),{KnowledgeAPI:a,isAuthenticated:u,workspace:l,authUser:h,canEdit:T}=n,{nickName:C}=h,[j,o]=E.useReducer(Yt,Wt),{formMode:S,activeCategory:N,activeQuestion:b,keyExpanded:q,topRows:A,allCategoryRows:G,allCategoryRowsLoaded:F}=j;console.log("----->>> ----->>> ----->>> CategoryProvider",A),E.useEffect(()=>{let d=l==="DEMO"?{topId:"MTS",categoryId:"REMOTECTRLS",questionId:"qqqqqq111"}:null;if("localStorage"in window){let s=localStorage.getItem("CATEGORIES_STATE");if(console.log("CATEGORIES_STATE from localStorage",s),s!==null){const y=JSON.parse(s);y.keyExpanded!==null&&(d=y.keyExpanded)}}o({type:r.SET_KEY_EXPANDED,payload:{keyExpanded:d}})},[l]);const R=E.useCallback(async(d,s,y=null,p=void 0)=>{const c=localStorage.getItem("accessToken");if(c)try{console.log("------Execute endpoint:",s);let w=null;const f=new Headers,I=`Bearer ${c}`;f.append("Authorization",I),y&&f.append("Content-Type","application/json");let Q={method:d,headers:f,body:y?JSON.stringify(y):null};if(w=await fetch(s,Q),w.ok||w.status===404){if(w.status===200||w.status===201){let M=null;try{M=await w.json()}catch{o({type:r.SET_ERROR,payload:{error:new Error(`Response status: ${w.status}`),whichRowId:p}})}finally{return M}}}else{const{errors:M}=await w.json(),X=new Error(M?.map(ne=>ne.message).join(`
`)??"unknown");o({type:r.SET_ERROR,payload:{error:X,whichRowId:p}})}}catch(w){console.log("-------------->>> execute",d,s,w),o({type:r.SET_ERROR,payload:{error:new Error("fetch eror"),whichRowId:p}})}return null},[]),L=E.useCallback(async()=>new Promise(async d=>{const s=await i();o(s?{type:r.SET_ALL_CATEGORY_ROWS,payload:{allCategoryRows:s}}:{type:r.SET_ERROR,payload:{error:new Error("Zajeb allCategoryRows")}}),d(s)}),[i]),U=E.useCallback(async()=>new Promise(async d=>{const s=await g();o(s?{type:r.SET_ALL_GROUP_ROWS,payload:{allGroupRows:s}}:{type:r.SET_ERROR,payload:{error:new Error("Zajeb allGroupRows")}}),d(s)}),[g]),_=E.useCallback(async d=>{try{return G.get(d)}catch(s){console.log(s),o({type:r.SET_ERROR,payload:{error:s}})}},[G]);E.useEffect(()=>{(async()=>await L())()},[L]);const k=E.useCallback(async d=>{try{let s="";const y=[];return G.forEach((p,c)=>{c===d?s="":p.parentId===d&&y.push(p)}),{subCats:y,parentHeader:s}}catch(s){return console.log(s),o({type:r.SET_ERROR,payload:{error:s}}),{subCats:[],parentHeader:"Kiks subCats"}}},[G]),v=E.useCallback(async()=>new Promise(async d=>{try{o({type:r.SET_TOP_ROWS_LOADING,payload:{}});const s=`${a.endpointCategoryRow}/${l}/toprows`;console.log("CategoryProvider loadTopRows url:",s),console.log("loadTopRows AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"),console.time(),await R("GET",s).then(y=>{console.timeEnd(),console.log("loadTopRows CCCCCCCCCCCCCCCCCCCC");const p=y.map(c=>(c.IsExpanded=q?c.Id===q.categoryId:!1,new ve(c).categoryRow));o({type:r.SET_TOP_ROWS,payload:{topRows:p}}),d(!0)})}catch(s){console.log(s),o({type:r.SET_ERROR,payload:{error:s}})}}),[R,a.endpointCategoryRow,q,l]),P=E.useCallback(async(d,s)=>{const{topId:y,id:p}=d;return console.log({categoryKey:d,includeQuestionId:s}),new Promise(async c=>{try{const w=`${a.endpointCategory}/${l}/${y}/${p}/${fe}/${s}`;console.time(),console.log("================ getCategory ======================="),await R("GET",w).then(f=>{console.timeEnd();const{categoryDto:I,msg:Q}=f;c(I?new Te(I).category:new Error(Q))})}catch(w){console.log(w),c(w)}})},[R,a.endpointCategory,l]),m=E.useCallback(async(d,s)=>{if(d.topId===s)return d;const{categoryRows:y}=d;let p=y.find(c=>c.id===s);if(!p)for(const c of y){const w=await m(c,s);if(w){p=w,console.log("findCategory Stop the loop for: "+s);break}}return p},[]),B=E.useCallback(async(d,s,y=!1)=>new Promise(async p=>{try{let{topId:c,parentId:w,id:f}=d;console.assert(f!==null,"id ne sme biti null u expandNodesUpToTheTree"),o({type:r.SET_NODE_EXPANDING_UP_THE_TREE,payload:{fromChatBotDlg:y,categoryId_questionId_done:`${f}_${s}`}}),console.time();const I={topId:c,id:f,parentId:null},Q=new de(I).toQuery(l),M=`${a.endpointCategoryRow}?${Q}&pageSize=${fe}&includeQuestionId=${s??null}`;await R("GET",M).then(async X=>{const{categoryRowDto:ne}=X;if(console.timeEnd(),ne){let ge=null,ye=null;const Ce=new ve(ne).categoryRow,pe=await m(Ce,f);if(w!==null&&(ge={...pe,doc1:""},s)){const qe=pe.questionRows.find(Fe=>Fe.id===s&&Fe.included);qe&&(ge=null,ye={...qe,assignedAnswers:[],numOfAssignedAnswers:0,numOfRelatedFilters:0,relatedFilters:[],source:0,status:0})}console.log(">>> expandNodeUpToTheTree categoryRow",{categoryRow:pe,questionId:"'"+(s??"jok")+"'"+(s??"JOK")});const Tt=s?T?x.EditingQuestion:x.ViewingQuestion:T?x.EditingCategory:x.ViewingCategory;o({type:r.SET_NODE_EXPANDED_UP_THE_TREE,payload:{catKey:d,categoryRow:Ce,category:ge,questionId:s??null,question:ye,formMode:Tt,fromChatBotDlg:y}}),p(!0)}else p(!1)})}catch(c){console.log(c),o({type:r.SET_ERROR,payload:{error:c}})}}),[l,a.endpointCategoryRow,R,G,m,T]),te=E.useCallback(async(d,s=!1,y=null)=>{const p=new de(d).toQuery(l);return new Promise(async c=>{try{const w=`${a.endpointCategoryRow}/${s}/${fe}/${y}?${p}`;console.time(),await R("GET",w).then(f=>{console.timeEnd();const{categoryRowDto:I,msg:Q}=f;c(I?new ve(I).categoryRow:new Error(Q))})}catch(w){console.log(w),c(w)}})},[R,a.endpointCategoryRow,l]),D=E.useCallback(async({categoryKey:d,includeQuestionId:s,newQuestionRow:y,formMode:p})=>{try{o({type:r.SET_ROW_EXPANDING,payload:{}});const c=await te(d,!0,s);if(c instanceof Error)o({type:r.SET_ERROR,payload:{error:c}}),console.error({cat:c});else{let w;return s&&c.questionRows.filter(f=>f.included).length>0&&(w=s),y&&(c.questionRows=[y,...c.questionRows]),c.isExpanded=!0,console.log("@@@@@@@@@@@@@@@@@ expandCategory:",p,s),p===x.None&&s&&(p=T?x.EditingQuestion:x.ViewingQuestion),o({type:r.SET_ROW_EXPANDED,payload:{categoryRow:c,formMode:p,selectedQuestionId:w}}),c}}catch(c){return console.log("error",c),o({type:r.SET_ERROR,payload:{error:c}}),null}},[T,te]),J=E.useCallback(async d=>{const{topId:s,id:y}=d,p=A.find(w=>w.id===s),c=await m(p,y);c?(d={...c,isExpanded:!1,categoryRows:[],questionRows:[]},o({type:r.SET_ROW_COLLAPSED,payload:{categoryRow:d}})):o({type:r.SET_ERROR,payload:{error:new Error("findCategory sranje"),whichRowId:y}})},[m,A]),ce=E.useCallback(async d=>{try{o({type:r.CLOSE_CATEGORY_FORM,payload:{}});const{topId:s,id:y,level:p}=d??{topId:ae,id:ae,level:0},c={...Xe,topId:s,parentId:d?y:null,id:ae,level:p+1,title:"New Category",isExpanded:!1};if(d===null)o({type:r.SET_CATEGORY_TO_ADD,payload:{newCategoryRow:c}});else{const w={...d,level:p+1,categoryRows:[c,...d.categoryRows],hasSubCategories:!0,isExpanded:!0};o({type:r.SET_CATEGORY_TO_ADD,payload:{categoryRow:w,newCategoryRow:{...c}}})}}catch(s){console.log("error",s),o({type:r.SET_ERROR,payload:{error:s}})}},[]),W=E.useCallback(async()=>{try{const{parentId:d}=N;let s,y=[];A.forEach(async p=>{d===null?y=A.filter(c=>c.id!==ae):(s=await m(p,d),s&&(s.categoryRows=s.categoryRows.filter(c=>c.id!==ae)))}),o({type:r.CANCEL_ADD_CATEGORY,payload:{topRows:y.length>0?y:A}})}catch(d){console.log("error",d),o({type:r.SET_ERROR,payload:{error:d}})}},[N,D]),ue=E.useCallback(async d=>{const{id:s}=d;o({type:r.SET_LOADING_CATEGORY,payload:{}});try{const y=new Pe(d,l).categoryDto;console.log("categoryDto",{categoryDto:y});const p=`${a.endpointCategory}`;console.time(),await R("POST",p,y,s).then(async c=>{console.timeEnd();const{categoryDto:w}=c;if(w){const f=new Te(w).category;console.log("Category successfully created",{category:f}),o({type:r.CLOSE_CATEGORY_FORM,payload:{}}),G.set(f.id,{...f,isExpanded:!1}),f.parentId===null?o({type:r.SET_CATEGORY_ADDED,payload:{categoryRow:f}}):o({type:r.SET_CATEGORY_ADDED,payload:{categoryRow:f}})}})}catch(y){console.log(y),o({type:r.SET_ERROR,payload:{error:new Error("Server Error"),whichRowId:s}})}},[R,a.endpointCategory,L,v,l]),Y=E.useCallback(async()=>{try{const{topId:d,parentId:s}=b,p={categoryKey:{topId:d,parentId:s,id:s},formMode:x.None},c=await D(p);c&&o({type:r.CANCEL_ADD_QUESTION,payload:{categoryRow:c}})}catch(d){console.log("error",d),o({type:r.SET_ERROR,payload:{error:d}})}},[b,D]),V=E.useCallback(async(d,s)=>{S===x.AddingQuestion?await Y():S===x.AddingCategory&&await W(),o({type:r.SET_LOADING_CATEGORY,payload:{categoryRow:d}});const y=new de(d).categoryKey,p=await P(y,s);p instanceof Error?o({type:r.SET_ERROR,payload:{error:p}}):(p.topId=d.topId,o({type:r.SET_CATEGORY_TO_VIEW,payload:{categoryRow:p}}))},[W,Y,S,P]),oe=E.useCallback(async(d,s)=>{S===x.AddingQuestion?await Y():S===x.AddingCategory&&await W(),o({type:r.SET_LOADING_CATEGORY,payload:{}});const y=new de(d).categoryKey,p=await P(y,s);if(p instanceof Error)o({type:r.SET_ERROR,payload:{error:p}});else{const c={...p,isExpanded:!1,categoryRows:[],questionRows:[]};o({type:r.SET_CATEGORY_TO_EDIT,payload:{categoryRow:c,category:p}})}},[W,Y,S,P]),H=E.useCallback(async d=>{o({type:r.SET_LOADING_CATEGORY,payload:{}});try{const s=new Pe(d,l).categoryDto,y=`${a.endpointCategory}`;console.time(),await R("PUT",y,s).then(p=>{console.timeEnd();const{categoryDto:c,msg:w}=p;if(c){const f=new Te(c).category,{topId:I}=f;f.isExpanded=!1,f.topId=I,o({type:r.SET_CATEGORY_UPDATED,payload:{category:f}})}else o({type:r.SET_ERROR,payload:{error:new Error(`${w}`)}})})}catch(s){return console.log(s),o({type:r.SET_ERROR,payload:{error:new Error("Karambol")}}),s}},[R,a.endpointCategory,l]),se=E.useCallback(async d=>{try{const{parentId:s,id:y}=d;d.modified={time:new Date,nickName:C};const p=new _t(d,l).categoryRowDto,c=`${a.endpointCategory}`;console.time(),o({type:r.SET_LOADING_CATEGORIES,payload:{}}),await R("DELETE",c,p).then(async w=>{console.timeEnd();const{categoryDto:f,msg:I}=w;if(I==="OK"){console.log("Category successfully deleted",{categoryRow:d});let Q;if(s!==null){for await(const M of A)if(Q=await m(M,s),Q)break;Q.hasSubCategories=f.HasSubCategories,Q.hasSubCategories||(Q.isExpanded=!1),Q.categoryRows=Q.categoryRows.filter(M=>M.id!==y)}o({type:r.CATEGORY_DELETED,payload:{categoryRow:Q,id:y}})}else o(I==="HasSubCategories"?{type:r.SET_ERROR,payload:{error:new Error("First remove sub categories"),whichRowId:f.Id}}:I==="HasQuestions"?{type:r.SET_ERROR,payload:{error:new Error("First remove category questions"),whichRowId:f.Id}}:{type:r.SET_ERROR,payload:{error:new Error(I),whichRowId:f.Id}})})}catch(s){return console.log(s),s}},[R,a.endpointCategory,D,L,v,l]),ct=async(d,s)=>{try{console.log("Deleting Category Tag...",{categoryKey:d,variationName:s}),console.log("Category Tag successfully deleted")}catch(y){console.log("error",y),o({type:r.SET_ERROR,payload:{error:y}})}},fe=12,ut=E.useCallback(async({categoryKey:d,startCursor:s,includeQuestionId:y})=>{try{const{topId:p,id:c}=d;o({type:r.SET_CATEGORY_QUESTIONS_LOADING,payload:{}});try{const w=`${a.endpointQuestion}/${l}/${p}/${c}/${s}/${fe}/${y}`;console.time(),await R("GET",w).then(f=>{console.timeEnd();const{categoryDto:I}=f;if(I!==null){const Q=new Te(I).category;o({type:r.CATEGORY_QUESTIONS_LOADED,payload:{categoryRow:Q}})}})}catch(w){console.log(w),o({type:r.SET_ERROR,payload:{error:w}})}}catch(p){console.log(p),o({type:r.SET_ERROR,payload:p})}},[R,a.endpointQuestion,l]),gt=E.useCallback(async d=>{try{const{topId:s,id:y}=d;let p=await _(y);if(!p){alert(`Not found ${y}. Reload all Categories`);return}const c={topId:s,parentId:d.id,id:ae,title:"question text",categoryTitle:p.title,numOfAssignedAnswers:0,included:!0},w={...be,...c,title:""},f=j.topRows.find(Q=>Q.id===s),I=await m(f,y);o({type:r.ADD_NEW_QUESTION_TO_ROW,payload:{categoryRow:{...I,questionRows:[c,...I.questionRows]},newQuestionRow:c}}),o({type:r.SET_QUESTION,payload:{question:w,formMode:x.AddingQuestion}})}catch(s){console.log("error",s),o({type:r.SET_ERROR,payload:{error:s}})}},[D,m,_,j.topRows]),yt=E.useCallback(async d=>{const{topId:s,id:y,parentId:p}=d;o({type:r.SET_LOADING_CATEGORY,payload:{}});try{d.created.nickName=C;const c=new $e(d,l).questionDto,w=`${a.endpointQuestion}`;console.time(),console.log(">>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> createQuestion",c),await R("POST",w,c).then(async f=>{if(console.timeEnd(),f){console.log("::::::::::::::::::::",{questionDtoEx:f});const{questionDto:I}=f;if(I){const Q=new Ee(I).question;Q.topId=s,console.log("Question successfully created"),await L().then(async()=>{const X={categoryKey:{topId:s,parentId:p,id:p},formMode:x.EditingQuestion};await D(X).then(()=>{o({type:r.SET_QUESTION,payload:{formMode:x.EditingQuestion,question:Q}})})})}}})}catch(c){console.log(c),o({type:r.SET_ERROR,payload:{error:new Error("Server Error"),whichRowId:y}})}},[R,a.endpointQuestion,D,L,C,l]),pt=E.useCallback(async(d,s,y)=>{const{id:p}=s;try{s.modified.nickName=C;const c=new $e(s,l).questionDto,w=`${a.endpointQuestion}`;console.time(),c.oldParentId=d,console.log(">>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> updateQuestion",c);let f=null;return await R("PUT",w,c).then(async I=>{console.timeEnd();const{questionDto:Q,msg:M}=I;if(Q){f=new Ee(Q).question,console.log("Question successfully updated: ",f);const{topId:X,parentId:ne}=f;if(y){const{topId:ge,parentId:ye,id:Ce}=f,pe={topId:ge,categoryId:ye,questionId:Ce};o({type:r.FORCE_OPEN_NODE,payload:{keyExpanded:pe}})}else{const ye={categoryKey:{topId:X,parentId:ne,id:ne},formMode:x.EditingQuestion};await D(ye).then(()=>{o({type:r.SET_QUESTION,payload:{formMode:x.EditingQuestion,question:f}})})}}else o({type:r.SET_ERROR,payload:{error:new Error(M)}})}),f}catch(c){console.log(c),o({type:r.SET_ERROR,payload:{error:new Error("Server Error"),whichRowId:p}})}},[R,a.endpointQuestion,D,C,l]),Et=E.useCallback(async(d,s)=>{const{id:y,parentId:p,topId:c}=d;o({type:r.SET_LOADING_QUESTION,payload:{}});try{const w=new At(d,l).questionRowDto,f=`${a.endpointQuestion}`;console.time(),await R("DELETE",f,w).then(async I=>{const{questionDto:Q}=I;if(console.timeEnd(),Q){const M=new Ee(Q).question;console.log("Question successfully deleted"),s&&o({type:r.QUESTION_DELETED,payload:{question:M}});const ne={categoryKey:{topId:c,parentId:p,id:p},formMode:x.None};await D(ne).then(()=>{})}else console.error(I),o({type:r.SET_ERROR,payload:{error:new Error("Server Error"),whichRowId:y}})})}catch(w){console.log(w),o({type:r.SET_ERROR,payload:{error:new Error("Server Error"),whichRowId:y}})}},[R,a.endpointQuestion,D,l]),he=E.useCallback(async d=>new Promise(async s=>{try{const y=new je(d).toQuery(l),p=`${a.endpointQuestion}?${y}`;console.time(),console.log("getQuestion",d),await R("GET",p).then(c=>{console.timeEnd();const{questionDto:w,msg:f}=c;if(w){const I={question:new Ee(w).question,msg:f};s(I)}else s({question:null,msg:f})})}catch(y){console.log(y),s({question:null,msg:"Problemos"})}}),[R,a.endpointQuestion,l]),mt=E.useCallback(async d=>{const s=new je(d).questionKey;o({type:r.SET_LOADING_QUESTION,payload:{}});const y=await he(s);S===x.AddingQuestion?await Y():S===x.AddingCategory&&await W();const{question:p,msg:c}=y;p?(p.topId=d.topId,o({type:r.SET_QUESTION_TO_VIEW,payload:{question:p}})):o({type:r.SET_ERROR,payload:{error:new Error(c)}})},[W,Y,S,he]),wt=E.useCallback(async d=>{const s=new je(d).questionKey;S===x.AddingQuestion?await Y():S===x.AddingCategory&&await W(),o({type:r.SET_LOADING_QUESTION,payload:{}}),console.log("editQuestion:",s);const y=await he(s),{question:p,msg:c}=y;p?(p.topId=d.topId,o({type:r.CLOSE_QUESTION_FORM,payload:{question:p}}),o({type:r.SET_QUESTION_TO_EDIT,payload:{question:p}})):o({type:r.SET_ERROR,payload:{error:new Error(c)}})},[W,Y,S,he]),xt=E.useCallback(async()=>new Promise(async d=>{try{const s=`${a.endpointAnswer}/${l}`;await R("GET",s).then(y=>{d(y)})}catch(s){console.log("error",s),o({type:r.SET_ERROR,payload:{error:s}})}}),[R,a.endpointAnswer,l]),ft=E.useCallback(async(d,s,y)=>{try{var{topId:p,id:c}=y,w={topId:p,id:c,created:{time:new Date,nickName:C}};const f=new vt(w).assignedAnswerDto;f.QuestionKeyDto=new It(s,l).dto;let I=null;const Q=`${a.endpointQuestionAnswer}/${d}`;console.time(),await R("POST",Q,f).then(async M=>{console.timeEnd();const{questionDto:X}=M;console.log("::::::::::::::::::::",{questionDtoEx:M}),X&&(I=new Ee(X).question,console.log("Question successfully modified"))}),I&&o({type:r.SET_QUESTION_AFTER_ASSIGN_ANSWER,payload:{question:I}})}catch(f){console.log("error",f),o({type:r.SET_ERROR,payload:{error:f}})}},[R,a.endpointQuestionAnswer,C,l]),ht=E.useCallback(async(d,s,y)=>{const p=A.find(w=>w.id===d);let c=await m(p,s);console.log("PROVIDER onCategoryTitleChanged::",c.title,y),c.title!==y&&(c.title=y===""?"New Category":y,o({type:r.RE_RENDER_TREE,payload:{}}))},[m,A]),Ct=E.useCallback(async(d,s,y)=>{const p=A.find(w=>w.id===d);let c=await m(p,s);if(c){const w=c.questionRows.find(f=>f.id===s);w.title!==y&&(w.title=y===""?"New Question":y,console.log("onQuestionTitleChanged+++>>>",s,c),o({type:r.QUESTION_TITLE_CHANGED,payload:{categoryRow:c}}))}},[m,A]),Rt={state:j,loadAllCategoryRows:L,getSubCats:k,getCat:_,loadAllGroupRows:U,expandNodesUpToTheTree:B,loadTopRows:v,addCategory:ce,cancelAddCategory:W,createCategory:ue,viewCategory:V,editCategory:oe,updateCategory:H,deleteCategory:se,deleteCategoryVariation:ct,expandCategory:D,collapseCategory:J,onCategoryTitleChanged:ht,loadCategoryQuestions:ut,addQuestion:gt,cancelAddQuestion:Y,createQuestion:yt,viewQuestion:mt,editQuestion:wt,updateQuestion:pt,deleteQuestion:Et,onQuestionTitleChanged:Ct,getAnswerCount:xt,assignQuestionAnswer:ft};return!u||!F?null:e.jsx(Je.Provider,{value:Rt,children:e.jsx(Ze.Provider,{value:o,children:t})})};function z(){return E.useContext(Je)}const et=()=>E.useContext(Ze),tt="/knowledge/assets/QPlus-Bq0XSb8N.png";var re=(t=>(t.SET_LOADING="SET_LOADING",t.SET_SUB_CATS="SET_SUB_CATS",t.SET_ERROR="SET_ERROR",t.SET_EXPANDED="SET_EXPANDED",t.SET_PARENT_CAT="SET_PARENT_CAT",t))(re||{});const Xt=({cat:t,dispatch:i,setParentCat:g,selId:n})=>{const{topId:a,parentId:u,id:l,title:h,level:T,isExpanded:C}=t,j={topId:a,parentId:u,id:l},o=b=>{i({type:re.SET_EXPANDED,payload:{id:l,expanding:!C}})},S=b=>{g(b)},N=e.jsxs("div",{className:"d-flex justify-content-start align-items-center w-100 text-primary",children:[e.jsx($,{variant:"link",size:"sm",className:"py-0 px-1",onClick:b=>{o(),b.stopPropagation(),b.preventDefault()},title:"Expand",children:e.jsx(ie,{icon:C?Me:ze,size:"lg"})}),e.jsx($,{variant:"link",size:"sm",className:"py-0 mx-0 text-decoration-none",title:l,onClick:()=>S(t),children:h})]});return e.jsxs(e.Fragment,{children:[e.jsx(ee.Item,{variant:"primary",className:"py-0 px-1 w-100",as:"li",children:N}),C&&e.jsx(ee.Item,{className:"py-0 px-0",variant:"primary",as:"li",children:e.jsx(st,{selId:n,level:T+1,categoryKey:j,setParentId:g})})]})},Jt={loading:!1,parentId:null,title:"",cats:[]},Zt=(t,i)=>{switch(i.type){case re.SET_LOADING:return{...t,loading:!0};case re.SET_SUB_CATS:{const{subCats:g}=i.payload;return{...t,cats:t.cats.concat(g),loading:!1}}case re.SET_ERROR:{const{error:g}=i.payload;return{...t,error:g,loading:!1}}case re.SET_EXPANDED:{const{id:g,expanding:n}=i.payload;let{cats:a}=t;if(!n){const u=ot(a,g);console.log("clean:",u),u.length>0&&(a=a.filter(l=>!u.includes(l.id)))}return{...t,cats:t.cats.map(u=>u.id===g?{...u,isExpanded:n}:u)}}case re.SET_PARENT_CAT:{const{cat:g}=i.payload,{id:n,title:a}=g;return{...t,parentId:n,title:a}}default:return t}};function ot(t,i){let g=t.filter(n=>n.parentId===i).map(n=>n.id);return g.forEach(n=>{const a=n?ot(t,n):[];g=g.concat(a)}),g}const st=({selId:t,categoryKey:i,level:g,setParentId:n})=>{const[a,u]=E.useReducer(Zt,Jt),{getSubCats:l}=z(),{id:h}=i??{id:null},[T]=E.useState(i);E.useEffect(()=>{(async()=>{const o=await l(h),{subCats:S}=o;u({type:re.SET_SUB_CATS,payload:{subCats:S}})})()},[l,T,h]);const C=a.cats.filter(o=>o.parentId===h),j=o=>{u({type:re.SET_PARENT_CAT,payload:{cat:o}}),n(o)};return e.jsxs("div",{className:g>1?"border  border-7 ms-4 h-25":"border border-7  h-25",style:{overflowY:"auto"},children:[e.jsx(ee,{as:"ul",variant:"dark",className:"mb-0",children:C.filter(o=>o.id!==t).map(o=>e.jsx(Xt,{cat:o,selId:t,dispatch:u,setParentCat:j},o.id))}),a.error&&a.error.message]})},eo=({questionTitle:t,assignedAnswer:i,isDisabled:g,unAssignAnswer:n})=>{const{id:a,answerTitle:u,created:l}=i,{time:h,nickName:T}=l,C=localStorage.getItem("emailFromClient"),j=`Created by: ${T}, ${He(new Date(h))}`,{canEdit:o,isDarkMode:S}=le(),N=!1,b=()=>{n(i)},q=v=>{console.log(`Selected Answer id=${v}`)},A=()=>{},[G,F]=E.useState(!1),R=()=>F(!1),L=v=>{navigator.clipboard&&navigator.clipboard.writeText(v).then(()=>{console.log("Copied to clipboard successfully."),alert("Answer copied to clipboard")},P=>{console.log("Failed to copy the text to clipboard.",P)})},[U,_]=xe(),k=e.jsxs("div",{ref:U,className:"d-flex justify-content-start align-items-center w-100 text-light bg-info",children:[e.jsx($,{variant:"link",size:"sm",className:"py-0 px-0 text-info",onClick:()=>C?F(!0):L(u),children:e.jsx(ie,{icon:C?Lt:Gt,size:"sm",title:"Send this Answer in a reply on Question"})}),e.jsx($,{variant:"link",size:"sm",className:"py-0 mx-1 text-decoration-none text-white text-wrap",title:j,onClick:()=>q(a),disabled:N,children:u}),o&&!N&&_&&!g&&e.jsx($,{variant:"link",size:"sm",className:"ms-1 py-0 mx-1 text-secondary",onClick:b,children:e.jsx(ie,{icon:_e,size:"lg"})})]});return e.jsxs(ee.Item,{variant:"info",className:"py-0 px-0",as:"li",children:[k,e.jsxs(K,{show:G,onHide:R,animation:!0,centered:!0,size:"lg",className:`${S?"bg":""}`,contentClassName:`${S?"bg-info bg-gradient":""}`,children:[e.jsx(K.Header,{closeButton:!0,children:"Send Answer in a reply on Question"}),e.jsx(K.Body,{className:"py-0",children:e.jsx("table",{className:"table-info table-hover table-bordered w-100 h-100",children:e.jsxs("tbody",{children:[e.jsxs("tr",{className:"border-top-0",children:[e.jsx("td",{children:"To:"}),e.jsx("td",{children:C})]}),e.jsxs("tr",{children:[e.jsx("td",{children:"Subject:"}),e.jsx("td",{children:t})]}),e.jsxs("tr",{className:"border-bottom-0",children:[e.jsx("td",{children:"Body:"}),e.jsx("td",{children:u})]})]})})}),e.jsxs(K.Footer,{children:[e.jsx($,{variant:"secondary",size:"sm",onClick:R,children:"Cancel"}),e.jsx($,{variant:"primary",size:"sm",onClick:A,children:"Send E-Mail"})]})]})]},a)},to=({})=>e.jsx("span",{children:"Posle"}),oo=E.lazy(()=>Ot(()=>import("./AutoSuggestAnswers-BoUWgdyd.js"),__vite__mapDeps([0,1,2,3,4,5])).then(t=>({default:t.AutoSuggestAnswers}))),so=({questionKey:t,questionTitle:i,assignedAnswers:g,isDisabled:n})=>{const{globalState:a,searchAnswers:u}=Ne(),{isDarkMode:l,variant:h}=a,[T,C]=E.useState(!1),j=()=>C(!1),o=()=>{j()},{state:S,assignQuestionAnswer:N,getAnswerCount:b}=z(),{allGroupRows:q}=S,[A,G]=E.useState(!1),[F,R]=E.useState(""),L=async v=>{await N("Assign",t,v),G(!1)},U=async v=>{v&&await L({topId:v.topId,id:v.id}),j()},_=async v=>{await N("UnAssign",t,v)},k=async()=>{if(await b()===0){R("No answer available to assign. Please navigate to Answers and create an answer first.");return}G(!0)};return e.jsxs("div",{className:"mx-0 my-0 px-1 py-1 border border-2 rounded-2 border-info bg-info",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-muted bg-info fs-6",children:"Assigned Answers"}),e.jsx(ee,{as:"ul",variant:h,className:"my-1",children:g.map(v=>e.jsx(eo,{questionTitle:i,assignedAnswer:v,groupInAdding:!1,isDisabled:n,unAssignAnswer:_},v.id))}),S.error&&e.jsx("div",{children:"state.error"})]}),e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"d-flex justify-content-start w-100 align-items-center py-1",children:[e.jsx($,{size:"sm",className:"button-edit py-0 rounded-1",title:"Assign a new Answer",style:{border:"1px solid silver",fontSize:"12px"},variant:h,disabled:n,onClick:k,children:"Assign answer"}),e.jsx($,{size:"sm",className:"button-edit py-0 rounded-1 mx-1",title:"Add and Assign a new Answer",style:{border:"1px solid silver",fontSize:"12px"},variant:h,disabled:n,onClick:async v=>{C(!0),v.preventDefault()},children:"Add a new answer"})]}),e.jsx("div",{className:"text-muted d-block",children:F&&e.jsx("span",{className:"text-danger",children:F})})]}),e.jsxs(K,{show:T,onHide:j,animation:!0,centered:!0,size:"lg",className:"",contentClassName:`${l?"bg-info bg-gradient":""}`,children:[e.jsx(K.Header,{closeButton:!0,children:e.jsx(K.Title,{children:i})}),e.jsx(K.Body,{children:e.jsx(to,{inLine:!0,closeModal:o,onAnswerCreated:U})})]}),e.jsxs(K,{show:A,onHide:()=>G(!1),animation:!0,size:"lg",centered:!0,className:`${l?"dark":""}`,contentClassName:`${l?"dark":""}`,children:[e.jsx(K.Header,{closeButton:!0,children:e.jsx(K.Title,{children:"Assign the answer"})}),e.jsx(K.Body,{style:{height:"40vh",width:"50vw"},className:"answers",children:e.jsx(E.Suspense,{fallback:e.jsx("div",{children:"Loading..."}),children:e.jsx(oo,{tekst:"tekst",onSelectAnswer:L,allGroupRows:q,searchAnswers:u})})})]})]})},no=({relatedFilter:t})=>{const{filter:i,numOfUsages:g,created:n,lastUsed:a}=t,{time:u,nickName:l}=n,h=`Created by: ${l}, ${He(new Date(u))}`,T=!1,C=N=>{console.log("RelatedFilter onSelectAnswer",{filter:N})},[j,o]=xe(),S=e.jsxs("div",{ref:j,className:"d-flex justify-content-start align-items-center w-100 text-light related-filter-row",children:[e.jsx($,{variant:"link",size:"sm",className:"py-0 mx-0 title text-light text-wrap",title:h,onClick:()=>C(i),disabled:T,children:i}),e.jsxs(Ae,{pill:!0,bg:"secondary",className:`text-light ${g===0?"d-none":"d-inline"}`,children:[g,g===1?" usage":" usages"]}),e.jsx("span",{className:"small ms-1",children:Vt(a.time)}),o]});return e.jsx(ee.Item,{className:"py-0 px-0",as:"li",children:S},i)},ao=({relatedFilters:t})=>{const{globalState:i}=Ne(),{variant:g}=i,{state:n}=z(),a=async u=>{console.log("RelatedFilters unAssignFilter",{relatedFilter:u})};return e.jsx("div",{className:"mx-0 my-1 border rounded-2 px-1 py-1border-light fs-6 related-filters",children:e.jsxs("div",{children:[e.jsx("label",{className:"text-muted",children:"Most frequently selected Filters (for the next Question in ChatBot)"}),t.length>0?e.jsx(ee,{as:"ul",variant:g,className:"my-1",children:t.map(u=>e.jsx(no,{relatedFilter:u,unAssignFilter:a},u.filter))}):e.jsx("div",{className:"border text-light",children:"No filters"}),n.error&&e.jsx("div",{children:"state.error"})]})})},ke=({question:t,submitForm:i,children:g,showCloseButton:n,source:a=0,closeModal:u})=>{const{state:l,onQuestionTitleChanged:h}=z();let{formMode:T}=l;const C=T===x.ViewingQuestion,j=T===x.EditingQuestion,o=T===x.AddingQuestion,S=C,{topId:N,id:b,assignedAnswers:q,relatedFilters:A,title:G}=t,F=new je(t).questionKey,R=et(),L=()=>{u?u():R({type:r.CLOSE_QUESTION_FORM,payload:{question:t}})},U=()=>{u?u():R({type:r.CANCEL_QUESTION_FORM,payload:{question:t}})},[_,k]=E.useState(G),v=Ve(_,500),P=E.useRef(null),m=Ke({enableReinitialize:!0,initialValues:t,validationSchema:Ye().shape({title:Ie().required("Required"),parentId:Ie().required("Required").notOneOf(["000000000000000000000000"])}),onSubmit:D=>{i(D),k(D.title)}});E.useEffect(()=>{(async()=>m.values.title!==v&&h(N,b,m.values.title))()},[v,m.values.title,h,N,b]),E.useEffect(()=>{P.current.focus(),a!==0&&m.setFieldValue("source",a)},[m,P,a]);const B=D=>{m.handleChange(D);const J=D.target.value;k(J)},te=D=>{m.setFieldValue("parentId",D.id),m.setFieldValue("categoryTitle",D.title)};return e.jsxs("div",{className:"form-wrapper px-3 py-1 my-0 my-1 w-100 question-form",children:[n&&e.jsx(Ue,{onClick:L,className:"float-end"}),e.jsx(we,{className:"text-center",children:e.jsxs(O.Label,{children:["Question  ",C?"Viewing":j?"Editing":"Adding"]})}),e.jsxs(O,{onSubmit:m.handleSubmit,children:[e.jsxs(De,{direction:"horizontal",gap:0,className:"border",children:[e.jsx("div",{className:"p-0",children:e.jsx(O.Label,{children:"Category:"})}),e.jsx("div",{className:"p-1",children:e.jsxs(O.Group,{controlId:"parentId",className:"category-select form-select-sm w-90",children:[e.jsxs(Se,{children:[e.jsx(Se.Toggle,{variant:"light",id:"dropdown-basic",className:"px-2 py-0 text-primary border",disabled:S,children:e.jsx("span",{className:"text-wrap me-1",children:m.values.categoryTitle})}),e.jsx(Se.Menu,{className:"p-0 border",children:e.jsx(Se.Item,{className:"p-0 m-0 rounded-3",children:e.jsx(st,{selId:m.values.parentId,categoryKey:null,level:1,setParentId:te})})})]}),e.jsx(O.Control,{as:"input",name:"parentId",onChange:m.handleChange,value:m.values.parentId?m.values.parentId:"",placeholder:"Category",className:"text-primary w-100",disabled:S,hidden:!0}),e.jsx(O.Text,{className:"text-danger",children:m.touched.parentId&&m.errors.parentId?e.jsx("div",{className:"text-danger",children:m.errors.parentId?"required":""}):null})]})})]}),e.jsxs(O.Group,{controlId:"title",children:[e.jsx(O.Label,{children:"Title"}),e.jsx(O.Control,{as:"textarea",name:"title",placeholder:m.values.title==="new Question"?"new Question":"question text",ref:P,onChange:B,value:m.values.title,rows:3,className:"text-primary w-100",disabled:S}),e.jsx(O.Text,{className:"text-danger",children:m.touched.title&&m.errors.title?e.jsx("div",{className:"text-danger",children:m.errors.title}):null})]}),e.jsxs(we,{children:[e.jsx(me,{children:e.jsxs(O.Group,{controlId:"source",children:[e.jsx(O.Label,{children:"Source"}),e.jsx(Oe,{id:"source",name:"source",options:qt,onChange:(D,J)=>{D.preventDefault(),m.setFieldValue("source",J)},value:m.values.source,disabled:S,classes:"text-primary"}),e.jsx(O.Text,{className:"text-danger",children:m.touched.source&&m.errors.source?e.jsx("div",{className:"text-danger",children:m.errors.source}):null})]})}),e.jsx(me,{children:e.jsxs(O.Group,{controlId:"status",children:[e.jsx(O.Label,{children:"Status"}),e.jsx(Oe,{id:"status",name:"status",options:Ft,onChange:(D,J)=>{D.preventDefault(),m.setFieldValue("status",J)},value:m.values.status,disabled:S,classes:"text-primary"}),e.jsx(O.Text,{className:"text-danger",children:m.touched.status&&m.errors.status?e.jsx("div",{className:"text-danger",children:m.errors.status}):null})]})})]}),(C||j)&&e.jsxs("div",{className:"my-1",children:[e.jsx(so,{questionKey:F,questionTitle:_,assignedAnswers:q,isDisabled:S}),e.jsx(ao,{questionKey:F,questionTitle:_,relatedFilters:A}),e.jsx(Be,{created:t.created,modified:t.modified,classes:"text-primary"})]}),(m.dirty&&j||o)&&e.jsx(We,{cancelForm:U,handleSubmit:m.handleSubmit,title:g}),l.error&&e.jsx("div",{className:"text-danger",children:l.error.message})]})]})},Le=({closeModal:t,showCloseButton:i,source:g,setError:n})=>{const{state:a,cancelAddQuestion:u,createQuestion:l}=z(),{activeQuestion:h}=a,T=h?h.topId:"",C=async()=>{await u()},j=async o=>{const S={...o,topId:T,created:{time:new Date,nickName:""},modified:void 0},N=await l(S,t!==void 0);N&&(N.message?n(N.message):t&&t())};return h?e.jsx(ke,{question:h,showCloseButton:i??!0,source:g??0,closeModal:C,submitForm:j,children:"Create Question"}):null},nt=({})=>{const{state:t,updateQuestion:i,loadAllGroupRows:g}=z(),{activeQuestion:n,allGroupRowsLoaded:a}=t;if(!n)return null;if(!n)return e.jsx("div",{children:"Loading question to edit..."});E.useEffect(()=>{(async()=>a===void 0&&await g())()},[a,g]);const u=async l=>{const h={...l,created:void 0,modified:{time:new Date,nickName:""}},{parentId:T}=n,C=T!==h.parentId;await i(T,h,C)};return e.jsx(ke,{question:n,showCloseButton:!0,source:0,submitForm:u,children:"Update Question"})},at=({inLine:t})=>{console.log(t?"ViewQuestion inLine":"ViewQuestion not inLine");const{state:i}=z(),{activeQuestion:g}=i,[n,a]=E.useState(null);return E.useEffect(()=>{console.log("#################################### ViewQuestion setQuestion ...",{activeQuestion:g}),a(g)},[g]),e.jsx(ke,{question:n,showCloseButton:!0,source:0,submitForm:()=>{},children:"View Question"})},ro=({questionRow:t,isSelected:i})=>{const{id:g,topId:n,parentId:a,title:u,numOfAssignedAnswers:l}=t,h={topId:n,parentId:a,id:a},{canEdit:T,authUser:C}=le(),{state:j,viewQuestion:o,addQuestion:S,editQuestion:N,deleteQuestion:b}=z(),{activeQuestion:q,formMode:A,loadingQuestion:G,questionLoaded:F}=j,R=q!==null&&q.id===g,L=A===x.AddingQuestion,U=()=>{t.modified={time:new Date,nickName:C.nickName},b(t,R)},_=async m=>{console.log("QuestionRow onSelectQuestion",{id:m}),T?await N(t):await o(t)},[k,v]=xe();E.useEffect(()=>{(async()=>{if(i&&!G&&!F){switch(A){case x.ViewingQuestion:await o(t);break;case x.EditingQuestion:console.log("Zovem from QuestionRow"),T?await N(t):await o(t);break}document.getElementById(`QuestionRow${g}`)?.scrollIntoView({behavior:"smooth",block:"end"})}})()},[T,N,A,g,i,G,F,t,o]);const P=e.jsxs("div",{id:`QuestionRow${g}`,className:`d-relative d-flex justify-content-start align-items-center w-100 mt-0 question-row${i?"-selected":""}`,style:{marginTop:"1px"},children:[e.jsx($,{variant:"link",size:"sm",className:"d-flex align-items-center px-1 text-secondary",children:e.jsx("img",{width:"22",height:"18",src:bt,alt:"Question"})}),e.jsx($,{variant:"link",size:"sm",className:`p-0 px-1 m-1 ms-0 question-row-title ${R?"fw-bold":""}`,title:`id:${g.toString()}`,onClick:()=>_(g),disabled:L,children:u}),e.jsxs(Ae,{pill:!0,bg:"secondary",className:`text-info ${l===0?"d-none":"d-inline"}`,children:[l,"a"]}),T&&!L&&v&&e.jsxs("div",{className:"position-absolute text-nowrap d-flex align-items-center border border-0 border-warning p-0 end-0",children:[e.jsx($,{variant:"link",size:"sm",className:"ms-1 p-0 text-secondary d-flex align-items-center",title:"Add Question",onClick:()=>{S(h,!0)},children:e.jsx("img",{width:"22",height:"18",src:tt,alt:"Add Question"})}),e.jsx($,{variant:"link",size:"sm",className:"ms-0 p-0 text-secondary",onClick:U,children:e.jsx(ie,{icon:_e,size:"lg"})})]})]});return e.jsxs(ee.Item,{className:"py-0 px-0 w-100",as:"li",children:[i&&A===x.AddingQuestion&&e.jsxs(e.Fragment,{children:[e.jsx("div",{id:"div-question",className:"ms-0 d-md-none w-100",children:e.jsx(Le,{showCloseButton:!0,source:0})}),e.jsx("div",{ref:k,className:"d-none d-md-block  border rounded-3",children:P})]}),i&&A===x.EditingQuestion&&e.jsxs(e.Fragment,{children:[e.jsx("div",{ref:k,className:"",children:P}),e.jsx("div",{id:"div-question",className:"ms-0 d-md-none w-100",children:e.jsx(nt,{inLine:!0})})]}),i&&A===x.ViewingQuestion&&e.jsxs(e.Fragment,{children:[e.jsx("div",{ref:k,className:"",children:P}),e.jsx("div",{ref:k,id:"div-question",className:"ms-0 d-md-none w-100",children:e.jsx(at,{inLine:!0})})]}),!i&&e.jsx("div",{ref:k,className:"",children:P})]})},rt=({categoryRow:t})=>{const{state:i,loadCategoryQuestions:g}=z(),{keyExpanded:n,loadingQuestion:a,error:u,selectedQuestionId:l}=i,{questionId:h}=n;t.level+=1;const{questionRows:T}=t;let C=!1;async function j(){try{const N={categoryKey:new de(t).categoryKey,startCursor:T.length,includeQuestionId:h??null};console.log("^^^^^^^^^^^^^ loadMore"),console.log("^^^^^^^^^^^^^",{x:N}),console.log("^^^^^^^^^^^^^ loadMore"),await g(N)}catch{}}const[o,{rootRef:S}]=Pt({loading:a,hasNextPage:C,onLoadMore:j,disabled:!!u,rootMargin:"0px 0px 100px 0px"});return e.jsxs("div",{ref:S,className:"ms-0",style:{maxHeight:"400px",overflowY:"auto"},children:[e.jsxs($t,{children:[T.length===0&&e.jsx("label",{children:"No questions"}),T.map(N=>e.jsx(ro,{questionRow:N,isSelected:N.id===l},N.id)),C]}),u&&e.jsxs("p",{children:["Error: ",u.message]})]})},io=({categoryKey:t,tag:i,categoryInAdding:g})=>{const{name:n}=i,{canEdit:a}=le(),{state:u,deleteCategoryVariation:l}=z(),h=()=>{l(t,n)},[T,C]=xe(),j=e.jsxs("div",{ref:T,children:[e.jsx(Ae,{pill:!0,bg:"secondary",children:n}),a&&!0&&C&&e.jsx($,{variant:"link",size:"sm",className:"ms-0 py-0 mx-0 text-secondary",onClick:h,children:e.jsx(ie,{icon:_e,size:"sm"})}),!1]});return e.jsx("div",{className:"py-1 px-1",children:j})},lo=({categoryKey:t,variations:i})=>{const{state:g}=z(),{error:n}=g;return E.useEffect(()=>{},[]),e.jsxs("div",{className:"ms-2",children:[e.jsxs(De,{direction:"horizontal",gap:2,children:[i.length===0&&e.jsx("div",{children:"No"}),i.length>0&&i.map(a=>e.jsx(io,{categoryKey:t,tag:a,categoryInAdding:void 0}))]}),n&&e.jsxs("p",{children:["Error: ",n.message]})]})},Ge=({formMode:t,category:i,cancel:g,close:n,submitForm:a,children:u})=>{const{onCategoryTitleChanged:l}=z(),h=t===x.ViewingCategory,T=t===x.EditingCategory,C=t===x.AddingCategory,{topId:j,id:o,variations:S,questionRows:N,title:b}=i;console.log("CategoryForm render: ",{topId:j,id:o,catTitle:b,formMode:t,variations:S});const q=new de(i).categoryKey;document.getElementById("div-details");const A=N&&N.length>0,G=()=>{n()},F=()=>{g()},[R,L]=E.useState(b),U=Ve(R,300),_=Ke({enableReinitialize:!0,initialValues:i,validationSchema:Ye().shape({title:Ie().required("Required")}),onSubmit:m=>{console.log("CategoryForm.onSubmit",JSON.stringify(m,null,2)),a(m),L(m.title)}});E.useEffect(()=>{(async()=>(console.log("CategoryForm.useEffect - onCategoryTitleChanged",{debouncedSearchTerm:U,title:_.values.title}),_.values.title!==U&&l(j,o,_.values.title)))()},[U,_.values.title,l]);const k=m=>{_.handleChange(m);const B=m.target.value;L(B)},v=E.useRef(null),P=!1;return console.log("CategoryForm render return: ",R),e.jsxs("div",{className:"form-wrapper p-2 category-form",children:[e.jsx(Ue,{onClick:G,className:"float-end"}),e.jsx(we,{className:"text-center text-muted",children:e.jsxs(O.Label,{children:["Category ",h?"Viewing":T?"Editing":"Adding"]})}),e.jsxs(O,{onSubmit:()=>_.handleSubmit,children:[e.jsx(O.Group,{controlId:"Variations",children:e.jsxs(De,{direction:"horizontal",gap:1,children:[e.jsx("div",{className:"px-0",children:e.jsx(O.Label,{children:"Variations:"})}),e.jsx("div",{className:"px-1 border border-1 border-secondary rounded",children:e.jsx(lo,{categoryKey:q,variations:S?S.map(m=>({name:m})):[]})}),e.jsx("div",{className:"ps-2",children:e.jsx(O.Label,{children:"Kind:"})}),e.jsx("div",{className:"px-1 border border-1 border-secondary rounded",children:e.jsxs(O.Group,{controlId:"kind",children:[e.jsx(Oe,{id:"kind",name:"kind",options:Ut,onChange:(m,B)=>{m.preventDefault(),_.setFieldValue("kind",B)},value:_.values.kind,disabled:P,classes:"text-primary"}),e.jsx(O.Text,{className:"text-danger",children:_.touched.kind&&_.errors.kind?e.jsx("div",{className:"text-danger",children:_.errors.kind}):null})]})})]})}),e.jsxs(O.Group,{controlId:"title",children:[e.jsx(O.Label,{children:"Title"}),e.jsx(O.Control,{as:"textarea",name:"title",placeholder:"new Category",value:R,onChange:k,onFocus:m=>{t===x.AddingCategory&&m.target.select()},ref:v,rows:3,className:"text-primary w-100",disabled:h}),e.jsx(O.Text,{className:"text-danger",children:_.touched.title&&_.errors.title?e.jsx("div",{className:"text-danger",children:_.errors.title}):null})]}),e.jsxs(O.Group,{controlId:"link",children:[e.jsx(O.Label,{children:"Link"}),_.values.hasSubCategories?e.jsx(O.Control,{as:"input",placeholder:"/categories/...",name:"link",onChange:_.handleChange,className:"text-primary w-100",value:"Can't have link (has sub categories)",disabled:!0}):e.jsxs(e.Fragment,{children:[e.jsx(O.Control,{as:"input",placeholder:"/categories/...",name:"link",onChange:_.handleChange,className:"text-primary w-100",value:_.values.link??"",disabled:h}),e.jsx(O.Text,{className:"text-danger",children:_.touched.link&&_.errors.link?e.jsx("div",{className:"text-danger",children:_.errors.link}):null})]})]}),e.jsxs(O.Group,{children:[e.jsxs(O.Label,{className:"m-1 mb-0",children:["Questions (",`${_.values.numOfQuestions}`,") "]}),A&&e.jsx(rt,{categoryRow:i})]}),(h||T)&&e.jsx(Be,{created:i.created,modified:i.modified,classes:"text-primary"}),(_.dirty&&T||C)&&e.jsx(We,{cancelForm:F,handleSubmit:_.handleSubmit,title:u})]})]})},it=({inLine:t})=>{const i=le(),{nickName:g}=i.authUser,{state:n,cancelAddCategory:a,updateCategory:u}=z(),{activeCategory:l,keyExpanded:h}=n,{questionId:T}=h,C=async()=>{await a()},j=async()=>{await a()},o=async S=>{const N={...S,created:void 0,modified:{time:new Date,nickName:g}};await u(N,!0)};return e.jsx(Ge,{inLine:t,category:{...l},questionId:T,formMode:x.EditingCategory,cancel:C,close:j,submitForm:o,children:"Update Category"})},Qe=({inLine:t})=>{const{state:i,cancelAddCategory:g}=z(),{activeCategory:n,keyExpanded:a}=i,{questionId:u}=a,l=async()=>{await g()};return e.jsx(Ge,{inLine:t,category:{...n},questionId:u,formMode:x.ViewingCategory,close:l,cancel:l,submitForm:()=>{},children:"View Category"})},lt=({activeCategory:t})=>{const i=le(),{nickName:g}=i.authUser,{cancelAddCategory:n,createCategory:a}=z(),[u]=E.useState({...t}),l=async()=>{await n()},h=async()=>{await n()},T=async C=>{const j={...C,created:{time:new Date,nickName:g},modified:void 0};console.log("**********object",j),await a(j)};return!t===null?null:(console.log("AddCategory render >>>>>:",t),e.jsx(e.Fragment,{children:e.jsx(Ge,{inLine:!1,category:u,questionId:null,formMode:x.AddingCategory,cancel:l,close:h,submitForm:T,children:"Create Category"})}))},co=({categoryRow:t,questionId:i})=>{const{id:g,title:n,hasSubCategories:a,numOfQuestions:u,isExpanded:l,categoryRows:h}=t;t.level+=1;const T=new de(t).categoryKey,{canEdit:C,authUser:j}=le(),{state:o,addCategory:S,viewCategory:N,editCategory:b,deleteCategory:q,expandCategory:A,collapseCategory:G,addQuestion:F}=z();let{formMode:R,activeCategory:L,loadingCategory:U,categoryLoaded:_}=o;const k=L!==null&&L.id===g,v=R===x.AddingCategory,P=l&&u>0,m=()=>{t.modified={time:new Date,nickName:j.nickName},q(t)},B=async()=>{l?await G(t):await A({categoryKey:T})},[te,D]=E.useState(!1);E.useEffect(()=>{D(!0)},[h]);const J=async()=>{C?await b(t,i??"null"):await N(t,i??"null")},[ce,W]=E.useState(!1);E.useEffect(()=>{ce&&(S(t),W(!1))},[S,t,ce]);const[ue,Y]=E.useState(!1);E.useEffect(()=>{ue&&(F(T,l??!1),Y(!1))},[F,T,l,ue]),E.useEffect(()=>{(async()=>{if(k&&!U&&!_&&!v)switch(console.log("CategoryRow formMode:",R),R){case x.ViewingCategory:await N(t,i??"null");break;case x.EditingCategory:C?await b(t,i??"null"):await N(t,i??"null");break}})()},[C,T,_,t,b,A,R,v,k,U,i,N]);const[V,oe]=xe(),H=e.jsxs("div",{children:[e.jsxs("div",{id:`Row${g}`,className:`d-relative d-flex justify-content-start align-items-center w-100 mt-1 category-row${k?"-selected":""}`,style:{marginTop:"1px"},children:[e.jsx($,{variant:"link",size:"sm",className:"py-0 px-1","aria-controls":g+"-2","aria-expanded":te,onClick:se=>{B(),se.stopPropagation()},title:"Expand",disabled:v||!a&&u===0,children:e.jsx(ie,{icon:l?Me:ze,size:"lg"})}),e.jsx($,{variant:"link",size:"sm",className:"py-0 px-1 bg-light",title:"Expand",disabled:!0,children:e.jsx(ie,{icon:Mt,size:"sm"})}),e.jsx($,{variant:"link",size:"sm",className:`py-0 ms-0 me-1 category-row-title ${k?"fw-bold text-white bg-transparent":""}`,title:g,onClick:J,disabled:v,children:n}),u>0&&e.jsxs(Ae,{pill:!0,bg:"secondary",className:"d-inline bg-transparent",children:[u,"Q"]}),!v&&C&&oe&&u===0&&e.jsxs("div",{className:"position-absolute text-nowrap d-flex align-items-center border border-0 border-warning p-0 end-0",children:[e.jsx("div",{className:"d-flex align-items-center",children:e.jsx($,{variant:"link",size:"sm",className:"border-0 py-0 px-0 ms-0 text-success",title:"Add SubCategory",onClick:async()=>{!l&&(a||u>0)&&await B(),setTimeout(()=>W(!0),1e3)},children:e.jsx(ie,{icon:zt,size:"lg"})})}),!v&&!a&&e.jsxs("div",{className:"d-flex align-items-center border border-5",children:[e.jsx($,{variant:"link",size:"sm",title:"Add Question",onClick:async()=>{!l&&u>0&&await B(),setTimeout(()=>Y(!0),500)},children:e.jsx("img",{width:"22",height:"18",src:tt,alt:"Add Question"})}),e.jsx($,{variant:"link",size:"sm",className:"d-flex align-items-center border border-0 border-warning p-0",disabled:a||u>0,onClick:m,children:e.jsx(ie,{icon:_e,size:"lg"})})]})]})]}),P&&e.jsx("div",{className:"ps-3",children:e.jsx(rt,{categoryRow:t})})]});return e.jsxs(e.Fragment,{children:[e.jsxs(ee.Item,{className:"py-0 px-1 w-100 category-bg",as:"li",children:[k&&R===x.AddingCategory&&e.jsxs("div",{children:[e.jsx("div",{ref:V,className:"",children:H}),e.jsx("div",{className:"ms-0 d-md-none w-100",children:e.jsx(lt,{activeCategory:L})})]}),k&&R===x.EditingCategory&&e.jsxs(e.Fragment,{children:[e.jsx("div",{ref:V,children:H}),e.jsx("div",{id:"divInLine",className:"ms-0 d-md-none w-100",children:e.jsx(it,{inLine:!1})})]}),k&&R===x.ViewingCategory&&e.jsxs(e.Fragment,{children:[e.jsx("div",{ref:V,children:H}),e.jsx("div",{id:"divInLine",className:"ms-0 d-md-none w-100",children:e.jsx(Qe,{inLine:!1})})]}),k&&R===x.None&&e.jsxs(e.Fragment,{children:[e.jsx("div",{ref:V,children:H}),e.jsx("div",{id:"divInLine",className:"ms-0 d-md-none w-100",children:e.jsx(Qe,{inLine:!1})})]}),!k&&e.jsx("div",{ref:V,children:H})]}),o.error&&o.whichRowId===g&&e.jsx("div",{className:"text-danger",children:o.error.message}),l&&e.jsx(ee.Item,{className:"py-0 px-0 border-0 border-warning border-bottom-0 category-bg p-0 m-0",variant:"primary",as:"li",children:e.jsx("div",{className:"rambo",children:a&&e.jsx(Qt,{in:te,children:e.jsx("div",{id:g+"-2",style:{marginTop:"1px"},children:e.jsx("div",{style:{border:"1px solid #ddd",borderRadius:"4px"},children:e.jsx(dt,{categoryRow:t,isExpanded:l})})})})})})]})},dt=({categoryRow:t})=>{const{level:i,categoryRows:g}=t,{state:n}=z();let{keyExpanded:a}=n;const{questionId:u}=a??{questionId:null};return e.jsx("div",{className:i>1?"ms-2":"",children:e.jsx(ee,{as:"ul",variant:"dark",className:"mb-0 category-bg",children:g.map(l=>e.jsx(co,{categoryRow:l,questionId:u===""?null:u},l.id))})})},uo=t=>{const{isDarkMode:i}=le(),[g,n]=E.useState("");return E.useEffect(()=>{},[]),e.jsxs(K,{show:t.show,onHide:t.onHide,animation:!0,centered:!0,size:"lg",className:"modal show",contentClassName:`${i?"bg-secondary bg-gradient":"bg-info bg-gradient"}`,children:[e.jsx(K.Header,{closeButton:!0,children:"Store new Question to the Database"}),e.jsx(K.Body,{className:"py-0",children:e.jsx(Le,{closeModal:t.onHide,showCloseButton:!1,source:1,setError:a=>n(a)})}),e.jsx(K.Footer,{children:g})]})},go=({categoryId_questionId:t,fromChatBotDlg:i})=>{const{state:g,expandNodesUpToTheTree:n,loadTopRows:a,addCategory:u}=z(),{allCategoryRows:l,topRows:h,topRowsLoading:T,topRowsLoaded:C,keyExpanded:j,categoryId_questionId_done:o,nodeOpening:S,nodeOpened:N,activeCategory:b,activeQuestion:q,formMode:A,loadingCategories:G,loadingCategory:F,loadingQuestions:R,loadingQuestion:L}=g,{searchQuestions:U,setLastRouteVisited:_,setChatBotDlgEnabled:k}=Ne(),{isDarkMode:v,chatBotDlgEnabled:P,lastRouteVisited:m}=le(),[B,te]=E.useState(!1),[D,J]=E.useState({...be}),ce=et(),W=async V=>{ce({type:r.SET_QUESTION_SELECTED,payload:{questionKey:V}})};let ue="";E.useEffect(()=>{(async()=>!T&&!C&&(console.log("ZOVEM 111 loadTopRows()"),await a()))()},[T,C,a]),E.useEffect(()=>{(async()=>{if(!S&&C&&h.length>0){if(t){if(t==="add_question"){const V=localStorage.getItem("New_Question");if(V){const oe=JSON.parse(V);return J({...be,categoryTitle:"Select",...oe}),te(!0),localStorage.removeItem("New_Question"),null}}else if(t!==o){const V=t.split("_"),oe=V[0],H=V[1],se={topId:"",id:oe,parentId:"ROOT"};console.log("zovem expandNodesUpToTheTree 1111111111111111111)",{categoryId_questionId:t},{categoryId_questionId_done:o}),await n(se,H!=="null"?H:null,i==="from_chat"),console.log("zavrsio expandNodeUpToTheTree 1111111111111111111 DONE)",{categoryId_questionId:t})}}else if(j&&!N){const{topId:V,categoryId:oe,questionId:H}=j;if(oe!==""){const se={topId:V,id:oe,parentId:"ROOT"};console.log("zovem expandNodeUpToTheTree 2222222222222)",{keyExpanded:j,catKey:se}),await n(se,H),console.log("zavrsio expandNodeUpToTheTree 2222222222222 DONE)")}}P||k()}})()},[t,o,C,j,S,N,n,i,P,k]);const Y="/knowledge/categories";return E.useEffect(()=>{m!==Y&&_(Y)},[m,_]),t!=="add_question"&&t&&t!==o?(console.log("zzzzzz loading...",{keyExpanded:j,categoryId_questionId:t,categoryId_questionId_done:o}),e.jsx("div",{children:"loading..."})):C?(console.log("===>>> Categories !!!!!!!!!!!!!!!!!",b),e.jsxs(e.Fragment,{children:[e.jsxs(kt,{children:[e.jsxs("h5",{className:"text-warning mx-auto w-75 fw-bold",children:[e.jsx("span",{className:"categories",children:"Categories / "}),e.jsx("span",{className:"questions",children:"Questions"})]}),e.jsx(we,{className:`${v?"dark":""}`,children:e.jsx(me,{children:e.jsx("div",{className:"d-flex justify-content-start align-items-center",children:e.jsx("div",{className:"w-75 my-1 questions",children:e.jsx(Kt,{tekst:ue,onSelectQuestion:W,allCategoryRows:l,searchQuestions:U})})})})}),e.jsx($,{variant:"secondary",size:"sm",type:"button",style:{padding:"1px 4px"},onClick:()=>u(null),children:"Add Category"}),e.jsxs(we,{className:"my-1 h-auto",children:[e.jsx(me,{xs:12,md:5,children:e.jsx("div",{className:"categories-border",style:{position:"relative"},children:e.jsx(dt,{categoryRow:{...Xe,categoryRows:h},isExpanded:!0})})}),e.jsx(me,{xs:0,md:7,children:e.jsxs("div",{id:"div-details",className:"d-none d-md-block",children:[b&&A===x.ViewingCategory&&e.jsx(Qe,{inLine:!1}),b&&A===x.EditingCategory&&e.jsx(it,{inLine:!1}),b&&A===x.AddingCategory&&e.jsx(lt,{activeCategory:b}),q&&A===x.ViewingQuestion&&e.jsx(at,{inLine:!1}),q&&A===x.EditingQuestion&&e.jsx(nt,{inLine:!1}),q&&A===x.AddingQuestion&&e.jsx(Le,{})]})})]})]}),B&&q&&e.jsx(uo,{show:B,onHide:()=>{te(!1)},newQuestionRow:D}),(G||R)&&e.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{position:"absolute",top:"40%",left:"20%"},children:e.jsx("div",{className:`spinner-border ${R?"question":"category"}-spinner`,role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Loading..."})})}),F&&e.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{position:"absolute",top:"50%",left:"50%"},children:e.jsx("div",{className:"spinner-border category-spinner",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Loading..."})})}),L&&e.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{position:"absolute",top:"50%",left:"50%"},children:e.jsx("div",{className:"spinner-border question-spinner",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Loading..."})})})]})):(console.log("===>>> Categories  VRATIO"),null)},xo=()=>{let{categoryId_questionId:t,fromChatBotDlg:i}=Dt();if(t&&t==="categories"&&(t=void 0),t){const g=t.split("_");console.assert(g.length===2,"expected 'categoryId_questionId'")}return e.jsx(Ht,{children:e.jsx(go,{categoryId_questionId:t,fromChatBotDlg:i})})};export{xo as default};
//# sourceMappingURL=Categories-V09SxcDu.js.map
