const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/AutoSuggestAnswers-DSvwzOb6.js","assets/index-ur131YHT.js","assets/index-CykrPP6v.css","assets/lib-j_GWzg-c.js","assets/utilities-8g5q_ELR.js","assets/AutoSuggestAnswers-vl2QUoNQ.css"])))=>i.map(i=>d[i]);
import{A as s,d as Rt,a as Tt,b as St,F as E,I as Ce,u as je,c as ie,r as m,C as ve,e as Re,f as le,g as Pe,h as jt,Q as $e,i as pe,j as _t,k as Se,l as Nt,m as vt,n as e,B as $,_ as At,o as Ue,R as Ee,D as Te,p as me,q as It,s as Ot,t as bt,v as Qt}from"./index-ur131YHT.js";import{L as Z,F as re,f as Me,a as ze,u as xe,M as V,b as Dt,c as kt,d as _e,B as Ne,e as Ve,g as Ke,h as Ye,i as Ae,j as O,S as Qe,k as Ie,s as Lt,l as Gt,C as Be,m as We,Q as He,n as qt,o as Ft,p as Pt,q as $t,r as Ut}from"./Options-Jby_vknc.js";import{f as Xe,a as Mt}from"./utilities-8g5q_ELR.js";import{A as zt}from"./AutoSuggestQuestions-DJnn_4mt.js";import"./lib-j_GWzg-c.js";const Oe={topId:"",parentId:"null",id:"generateId",categoryTitle:"",title:"",assignedAnswers:[],numOfAssignedAnswers:0,relatedFilters:[],numOfRelatedFilters:0,source:0,status:0,included:!1},Je={topId:"null",parentId:"null",id:"define at BackEnd",kind:0,title:"",link:"",header:"",level:0,variations:[],hasSubCategories:!1,categoryRows:[],questionRows:[],numOfQuestions:0,hasMoreQuestions:!1,isExpanded:!1,doc1:""},Vt=(t,i)=>{console.log("------------------------------->"),console.log("------------------------------->",i.type),console.log("------------------------------->");const{categoryRow:g}=i.payload;if(i.type===s.SET_KEY_EXPANDED){const{keyExpanded:l}=i.payload;return{...t,keyExpanded:l,nodeOpened:l===null?!0:t.nodeOpened}}let n=g?!Rt.includes(i.type):!1;const{topRows:a}=t,u=Tt.includes(i.type)?{...t}:Kt(t,i);if(n&&g){let l;const{topId:w,id:T}=g;if(T===w)l=a.map(h=>h.id===w?new J(g).categoryRow:new J(h).categoryRow);else{const h=a.find(o=>o.id===w);J.idToSet=i.type==="SET_CATEGORY_ADDED"?"generateId":T,J.newCategoryRow=g;const _=new J(h).categoryRow;l=a.map(o=>o.id===w?_:new J(o).categoryRow),J.idToSet=""}u.topRows=l}if(St.includes(i.type)){const{keyExpanded:l}=u,w={keyExpanded:l};localStorage.setItem("CATEGORIES_STATE",JSON.stringify(w))}return console.log("CategoryReducer newState",u),u},Kt=(t,i)=>{switch(i.type){case s.SET_TOP_ROWS_LOADING:return{...t,loadingCategories:!0,topRowsLoading:!0,topRowsLoaded:!1};case s.SET_TOP_ROWS:{const{topRows:n}=i.payload;return console.log("=> CategoriesReducer ActionTypes.SET_TOP_ROWS",t.topRows,n),{...t,topRows:n,topRowsLoading:!1,topRowsLoaded:!0,loadingCategories:!1}}case s.SET_ALL_CATEGORY_ROWS:{const{allCategoryRows:n}=i.payload;return{...t,allCategoryRows:n,allCategoryRowsLoaded:Date.now()}}case s.SET_ALL_GROUP_ROWS:{const{allGroupRows:n}=i.payload;return{...t,allGroupRows:n,allGroupRowsLoaded:Date.now()}}case s.SET_NODE_EXPANDING_UP_THE_TREE:{const{categoryId_questionId_done:n}=i.payload;return{...t,categoryId_questionId_done:n,nodeOpening:!0,loadingCategories:!0,nodeOpened:!1,activeCategory:null,activeQuestion:null}}case s.SET_NODE_EXPANDED_UP_THE_TREE:{const{category:n,questionId:a,question:u,formMode:l}=i.payload;return{...t,activeCategory:n,activeQuestion:u,selectedQuestionId:a,formMode:l,nodeOpening:!1,nodeOpened:!0,loadingCategories:!1}}case s.SET_LOADING_CATEGORY:return{...t,loadingCategory:!0,categoryLoaded:!1};case s.FORCE_OPEN_NODE:const{keyExpanded:g}=i.payload;return alert("FORCE_OPEN_NODE is deprecated, use SET_QUESTION_SELECTED instead"),{...t,topRows:t.topRows.filter(n=>n.parentId===null),keyExpanded:g,nodeOpened:!1,activeCategory:null,activeQuestion:null,selectedQuestionId:null};case s.SET_SUB_CATEGORIES:return{...t,loadingCategory:!1};case s.SET_ERROR:{const{error:n,whichRowId:a}=i.payload;return{...t,error:n,whichRowId:a,loadingCategories:!1,loadingQuestions:!1,loadingCategory:!1,categoryLoaded:!1,loadingQuestion:!1,questionLoaded:!1}}case s.SET_CATEGORY:{const{categoryRow:n}=i.payload;return console.assert(Ce(n)),{...t,loadingCategory:!1,categoryLoaded:!0,activeCategory:n,activeQuestion:null,selectedQuestionId:null}}case s.SET_ROW_EXPANDING:return{...t,rowExpanding:!0,rowExpanded:!1,loadingCategories:!0};case s.SET_ROW_EXPANDED:{const{categoryRow:n}=i.payload,{topId:a,id:u}=n,{keyExpanded:l}=t,w=l?l.questionId:null;return{...t,loadingCategories:!1,keyExpanded:{topId:a,categoryId:u,questionId:w},activeQuestion:null,selectedQuestionId:w,loadingQuestion:!1,questionLoaded:!1,rowExpanding:!1,rowExpanded:!0}}case s.SET_ROW_COLLAPSED:{const{categoryRow:n}=i.payload,{topId:a,parentId:u}=n;return{...t,loadingCategories:!1,keyExpanded:{topId:a,categoryId:u??"",questionId:null},rowExpanding:!1,rowExpanded:!0,activeCategory:null,activeQuestion:null,selectedQuestionId:null}}case s.SET_CATEGORY_TO_VIEW:{const{categoryRow:n}=i.payload;console.assert(Ce(n));const u={...n,isExpanded:!1};return{...t,formMode:E.ViewingCategory,loadingCategory:!1,activeCategory:u,activeQuestion:null,selectedQuestionId:null,error:void 0}}case s.SET_CATEGORY_TO_ADD_TOP:{const{newCategoryRow:n}=i.payload;return{...t,loadingCategory:!1,categoryLoaded:!0,activeCategory:{...n,doc1:""},activeQuestion:null,selectedQuestionId:null,topRows:[n,...t.topRows],formMode:E.AddingCategory}}case s.SET_CATEGORY_TO_ADD:{const{newCategoryRow:n}=i.payload;return{...t,loadingCategory:!1,categoryLoaded:!0,activeCategory:{...n,doc1:""},activeQuestion:null,selectedQuestionId:null,formMode:E.AddingCategory}}case s.SET_CATEGORY_ADDED:{const{categoryRow:n}=i.payload;console.assert(Ce(n));const u={...n,isExpanded:!1},{topId:l,id:w}=u;return{...t,formMode:E.EditingCategory,loadingCategory:!1,categoryLoaded:!1,activeCategory:u,activeQuestion:null,selectedQuestionId:null,keyExpanded:{topId:l,categoryId:w,questionId:null}}}case s.SET_CATEGORY_TO_EDIT:case s.SET_CATEGORY_UPDATED:{const{categoryRow:n,category:a}=i.payload;console.assert(Ce(n));const{topId:u,id:l}=a;return{...t,formMode:E.EditingCategory,loadingCategory:!1,categoryLoaded:!0,keyExpanded:{topId:u,categoryId:l,questionId:null},activeCategory:a,activeQuestion:null,selectedQuestionId:null,error:void 0}}case s.SET_CATEGORY_QUESTIONS_LOADING:return{...t,loadingQuestions:!0,questionLoaded:!1};case s.CATEGORY_QUESTIONS_LOADED:return{...t,loadingQuestions:!1};case s.DELETE_CATEGORY:return{...t,activeCategory:null,formMode:E.None,error:void 0,whichRowId:void 0};case s.CANCEL_CATEGORY_FORM:case s.CLOSE_CATEGORY_FORM:return{...t,activeCategory:null,formMode:E.None};case s.CANCEL_ADD_SUB_CATEGORY:return{...t,activeCategory:null,activeQuestion:null,selectedQuestionId:null,formMode:E.None};case s.SET_LOADING_QUESTION:return{...t,loadingQuestion:!0,questionLoaded:!1};case s.CANCEL_ADD_QUESTION:return{...t,formMode:E.None,activeQuestion:null,selectedQuestionId:null};case s.SET_QUESTION_SELECTED:{const{questionKey:n}=i.payload,{topId:a,parentId:u,id:l}=n;return{...t,topRows:t.topRows.filter(w=>w.parentId===null),keyExpanded:{topId:a,categoryId:u,questionId:l},activeCategory:null,activeQuestion:null,selectedQuestionId:null}}case s.ADD_NEW_QUESTION_TO_ROW:{const{newQuestionRow:n}=i.payload;return{...t,selectedQuestionId:n.id}}case s.SET_QUESTION:{const{question:n,formMode:a}=i.payload;return console.log(s.SET_QUESTION,n),{...t,activeCategory:null,activeQuestion:n,formMode:a,error:void 0,loadingCategory:!1,loadingQuestion:!1,questionLoaded:!0}}case s.SET_QUESTION_AFTER_ASSIGN_ANSWER:{const{question:n}=i.payload;return{...t,activeQuestion:n,loadingQuestion:!1,questionLoaded:!0}}case s.SET_QUESTION_TO_VIEW:{const{question:n}=i.payload,{keyExpanded:a}=t;return{...t,formMode:E.ViewingQuestion,keyExpanded:a,activeQuestion:n,loadingQuestion:!1,questionLoaded:!0}}case s.SET_QUESTION_TO_EDIT:{const{question:n}=i.payload,{topId:a,id:u,parentId:l}=n;return{...t,keyExpanded:{topId:a,categoryId:l,questionId:u},activeQuestion:n,formMode:E.EditingQuestion,selectedQuestionId:n.id,loadingQuestion:!1,questionLoaded:!0}}case s.QUESTION_DELETED:return{...t,activeQuestion:null,selectedQuestionId:null,formMode:E.None,loadingQuestion:!1,questionLoaded:!0};case s.CANCEL_QUESTION_FORM:case s.CLOSE_QUESTION_FORM:return{...t,formMode:E.None,activeQuestion:null,selectedQuestionId:null};default:return alert(`Action ${i.type} not allowed`),{...t}}};class J{static idToSet;static newCategoryRow;constructor(i){const{topId:g,id:n,parentId:a,title:u,link:l,kind:w,header:T,level:h,variations:_,numOfQuestions:o,hasSubCategories:j,categoryRows:N,created:b,modified:L,questionRows:A,isExpanded:G}=i,F=N.map(R=>(console.log("DeepClone >>>>>>>>>>>>>>>",R.id),R.id===J.idToSet?{...J.newCategoryRow}:new J(R).categoryRow));this.categoryRow={topId:g,parentId:a,id:n,kind:w,title:u,link:l,header:T,level:h,hasSubCategories:j,categoryRows:F,numOfQuestions:o,questionRows:A,variations:_??[],created:b,modified:L,isExpanded:G}}categoryRow}const Ze=m.createContext({}),et=m.createContext(()=>null),Yt={formMode:E.None,allCategoryRows:new Map,allCategoryRowsLoaded:void 0,allGroupRows:new Map,allGroupRowsLoaded:void 0,topRows:[],topRowsLoading:!1,topRowsLoaded:!1,nodeOpening:!1,nodeOpened:!1,keyExpanded:null,categoryId_questionId_done:void 0,activeCategory:null,activeQuestion:null,selectedQuestionId:null,loadingCategories:!1,loadingQuestions:!1,loadingCategory:!1,categoryLoaded:!1,loadingQuestion:!1,questionLoaded:!1,error:void 0,rowExpanding:!1,rowExpanded:!1},Bt=({children:t})=>{const{loadAllCategoryRowsGlobal:i,loadAllGroupRowsGlobal:g}=je(),n=ie(),{KnowledgeAPI:a,isAuthenticated:u,workspace:l,authUser:w,canEdit:T}=n,{nickName:h}=w,[_,o]=m.useReducer(Vt,Yt),{formMode:j,activeCategory:N,activeQuestion:b,keyExpanded:L,topRows:A,allCategoryRows:G,allCategoryRowsLoaded:F}=_;console.log("----->>> ----->>> ----->>> CategoryProvider",A),m.useEffect(()=>{let d=l==="DEMO"?{topId:"MTS",categoryId:"REMOTECTRLS",questionId:"qqqqqq111"}:null;if("localStorage"in window){let r=localStorage.getItem("CATEGORIES_STATE");if(console.log("CATEGORIES_STATE from localStorage",r),r!==null){const p=JSON.parse(r);p.keyExpanded!==null&&(d=p.keyExpanded)}}o({type:s.SET_KEY_EXPANDED,payload:{keyExpanded:d}})},[l]);const R=m.useCallback(async(d,r,p=null,y=void 0)=>{const c=localStorage.getItem("accessToken");if(c)try{console.log("------Execute endpoint:",r);let x=null;const f=new Headers,v=`Bearer ${c}`;f.append("Authorization",v),p&&f.append("Content-Type","application/json");let q={method:d,headers:f,body:p?JSON.stringify(p):null};if(x=await fetch(r,q),x.ok){if(x.status===200||x.status===201){let B=null;try{B=await x.json()}catch{o({type:s.SET_ERROR,payload:{error:new Error(`Response status: ${x.status}`),whichRowId:y}})}finally{return B}}}else{const{errors:B}=await x.json(),H=new Error(B?.map(ne=>ne.message).join(`
`)??"unknown");o({type:s.SET_ERROR,payload:{error:H,whichRowId:y}})}}catch(x){console.log("-------------->>> execute",d,r,x),o({type:s.SET_ERROR,payload:{error:new Error("fetch eror"),whichRowId:y}})}return null},[]),k=m.useCallback(async()=>new Promise(async d=>{const r=await i();o(r?{type:s.SET_ALL_CATEGORY_ROWS,payload:{allCategoryRows:r}}:{type:s.SET_ERROR,payload:{error:new Error("Zajeb allCategoryRows")}}),d(r)}),[i]),S=m.useCallback(async()=>new Promise(async d=>{const r=await g();o(r?{type:s.SET_ALL_GROUP_ROWS,payload:{allGroupRows:r}}:{type:s.SET_ERROR,payload:{error:new Error("Zajeb allGroupRows")}}),d(r)}),[g]),U=m.useCallback(async d=>{try{return G.get(d)}catch(r){console.log(r),o({type:s.SET_ERROR,payload:{error:r}})}},[G]);m.useEffect(()=>{(async()=>await k())()},[k]);const D=m.useCallback(async d=>{try{let r="";const p=[];return G.forEach((y,c)=>{c===d?r="":y.parentId===d&&p.push(y)}),{subCats:p,parentHeader:r}}catch(r){return console.log(r),o({type:s.SET_ERROR,payload:{error:r}}),{subCats:[],parentHeader:"Kiks subCats"}}},[G]),P=m.useCallback(async()=>new Promise(async d=>{try{o({type:s.SET_TOP_ROWS_LOADING,payload:{}});const r=`${a.endpointCategoryRow}/${l}/toprows`;console.log("CategoryProvider loadTopRows url:",r),console.log("loadTopRows AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"),console.time(),await R("GET",r).then(p=>{console.timeEnd(),console.log("loadTopRows CCCCCCCCCCCCCCCCCCCC");const y=p.map(c=>(c.IsExpanded=L?c.Id===L.categoryId:!1,new ve(c).categoryRow));o({type:s.SET_TOP_ROWS,payload:{topRows:y}}),d(!0)})}catch(r){console.log(r),o({type:s.SET_ERROR,payload:{error:r}})}}),[R,a.endpointCategoryRow,L,l]),I=m.useCallback(async(d,r)=>{const{topId:p,id:y}=d;return console.log({categoryKey:d,includeQuestionId:r}),new Promise(async c=>{try{const x=`${a.endpointCategory}/${l}/${p}/${y}/${we}/${r}`;console.time(),console.log("================ getCategory ======================="),await R("GET",x).then(f=>{console.timeEnd();const{categoryDto:v,msg:q}=f;c(v?new Re(v).category:new Error(q))})}catch(x){console.log(x),c(x)}})},[R,a.endpointCategory,l]),C=m.useCallback(async(d,r)=>{if(d.topId===r)return d;const{categoryRows:p}=d;let y=p.find(c=>c.id===r);if(!y)for(const c of p){const x=await C(c,r);if(x){y=x,console.log("findCategory Stop the loop for: "+r);break}}return y},[]),ee=m.useCallback(async(d,r,p=!1)=>new Promise(async y=>{try{let{topId:c,parentId:x,id:f}=d;console.assert(f!==null,"id ne sme biti null u expandNodesUpToTheTree"),o({type:s.SET_NODE_EXPANDING_UP_THE_TREE,payload:{fromChatBotDlg:p,categoryId_questionId_done:`${f}_${r}`}}),console.time();const v={topId:c,id:f,parentId:null},q=new le(v).toQuery(l),B=`${a.endpointCategoryRow}?${q}&pageSize=${we}&includeQuestionId=${r??null}`;await R("GET",B).then(async H=>{const{categoryRowDto:ne}=H;if(console.timeEnd(),ne){let ue=null,ge=null;const fe=new ve(ne).categoryRow,ye=await C(fe,f);if(x!==null&&(ue={...ye,doc1:""},r)){const qe=ye.questionRows.find(Fe=>Fe.id===r&&Fe.included);qe&&(ue=null,ge={...qe,assignedAnswers:[],numOfAssignedAnswers:0,numOfRelatedFilters:0,relatedFilters:[],source:0,status:0})}console.log(">>> expandNodeUpToTheTree categoryRow",{categoryRow:ye,questionId:"'"+(r??"jok")+"'"+(r??"JOK")});const Ct=r?T?E.EditingQuestion:E.ViewingQuestion:T?E.EditingCategory:E.ViewingCategory;o({type:s.SET_NODE_EXPANDED_UP_THE_TREE,payload:{catKey:d,categoryRow:fe,category:ue,questionId:r??null,question:ge,formMode:Ct,fromChatBotDlg:p}}),y(!0)}else y(!1)})}catch(c){console.log(c),o({type:s.SET_ERROR,payload:{error:c}})}}),[l,a.endpointCategoryRow,R,G,C,T]),te=m.useCallback(async(d,r=!1,p=null)=>{const y=new le(d).toQuery(l);return new Promise(async c=>{try{const x=`${a.endpointCategoryRow}/${r}/${we}/${p}?${y}`;console.time(),await R("GET",x).then(f=>{console.timeEnd();const{categoryRowDto:v,msg:q}=f;c(v?new ve(v).categoryRow:new Error(q))})}catch(x){console.log(x),c(x)}})},[R,a.endpointCategoryRow,l]),Q=m.useCallback(async({categoryKey:d,includeQuestionId:r,newQuestionRow:p,formMode:y})=>{try{o({type:s.SET_ROW_EXPANDING,payload:{}});const c=await te(d,!0,r);if(c instanceof Error)o({type:s.SET_ERROR,payload:{error:c}}),console.error({cat:c});else{let x;return r&&c.questionRows.filter(f=>f.included).length>0&&(x=r),p&&(c.questionRows=[p,...c.questionRows]),c.isExpanded=!0,console.log("@@@@@@@@@@@@@@@@@ expandCategory:",y,r),y===E.None&&r&&(y=T?E.EditingQuestion:E.ViewingQuestion),o({type:s.SET_ROW_EXPANDED,payload:{categoryRow:c,formMode:y,selectedQuestionId:x}}),c}}catch(c){return console.log("error",c),o({type:s.SET_ERROR,payload:{error:c}}),null}},[T,te]),X=m.useCallback(async d=>{const{topId:r,id:p}=d,y=A.find(x=>x.id===r),c=await C(y,p);c?(d={...c,isExpanded:!1,categoryRows:[],questionRows:[]},o({type:s.SET_ROW_COLLAPSED,payload:{categoryRow:d}})):o({type:s.SET_ERROR,payload:{error:new Error("findCategory sranje"),whichRowId:p}})},[C,A]),de=m.useCallback(async d=>{try{o({type:s.CLOSE_CATEGORY_FORM,payload:{}});const{topId:r,id:p,level:y}=d??{topId:"generateId",id:"generateId",level:0},c={...Je,topId:r,parentId:d?p:null,id:"generateId",level:y+1,title:"New Category",isExpanded:!1};if(d===null)o({type:s.SET_CATEGORY_TO_ADD_TOP,payload:{newCategoryRow:c}});else{const x={...d,level:y+1,categoryRows:[c,...d.categoryRows],hasSubCategories:!0,isExpanded:!0};o({type:s.SET_CATEGORY_TO_ADD,payload:{categoryRow:x,newCategoryRow:{...c}}})}}catch(r){console.log("error",r),o({type:s.SET_ERROR,payload:{error:r}})}},[]),Y=m.useCallback(async()=>{try{const d=N;d&&o({type:s.CANCEL_ADD_SUB_CATEGORY,payload:{categoryRow:d}})}catch(d){console.log("error",d),o({type:s.SET_ERROR,payload:{error:d}})}},[N,Q]),ce=m.useCallback(async d=>{const{id:r}=d;o({type:s.SET_LOADING_CATEGORY,payload:{}});try{const p=new Pe(d,l).categoryDto;console.log("categoryDto",{categoryDto:p});const y=`${a.endpointCategory}`;console.time(),await R("POST",y,p,r).then(async c=>{console.timeEnd();const{categoryDto:x}=c;if(x){const f=new Re(x).category;console.log("Category successfully created",{category:f}),o({type:s.CLOSE_CATEGORY_FORM,payload:{}}),G.set(f.id,{...f,isExpanded:!1}),f.parentId===null?o({type:s.SET_CATEGORY_ADDED,payload:{categoryRow:f}}):o({type:s.SET_CATEGORY_ADDED,payload:{categoryRow:f}})}})}catch(p){console.log(p),o({type:s.SET_ERROR,payload:{error:new Error("Server Error"),whichRowId:r}})}},[R,a.endpointCategory,k,P,l]),K=m.useCallback(async()=>{try{const{topId:d,parentId:r}=b,y={categoryKey:{topId:d,parentId:r,id:r},formMode:E.None},c=await Q(y);c&&o({type:s.CANCEL_ADD_QUESTION,payload:{categoryRow:c}})}catch(d){console.log("error",d),o({type:s.SET_ERROR,payload:{error:d}})}},[b,Q]),z=m.useCallback(async(d,r)=>{j===E.AddingQuestion?await K():j===E.AddingCategory&&await Y(),o({type:s.SET_LOADING_CATEGORY,payload:{categoryRow:d}});const p=new le(d).categoryKey,y=await I(p,r);y instanceof Error?o({type:s.SET_ERROR,payload:{error:y}}):(y.topId=d.topId,o({type:s.SET_CATEGORY_TO_VIEW,payload:{categoryRow:y}}))},[Y,K,j,I]),oe=m.useCallback(async(d,r)=>{j===E.AddingQuestion?await K():j===E.AddingCategory&&await Y(),o({type:s.SET_LOADING_CATEGORY,payload:{}});const p=new le(d).categoryKey,y=await I(p,r);if(y instanceof Error)o({type:s.SET_ERROR,payload:{error:y}});else{const c={...y,isExpanded:!1,categoryRows:[],questionRows:[]};o({type:s.SET_CATEGORY_TO_EDIT,payload:{categoryRow:c,category:y}})}},[Y,K,j,I]),W=m.useCallback(async d=>{o({type:s.SET_LOADING_CATEGORY,payload:{}});try{const r=new Pe(d,l).categoryDto,p=`${a.endpointCategory}`;console.time(),await R("PUT",p,r).then(y=>{console.timeEnd();const{categoryDto:c,msg:x}=y;if(c){const f=new Re(c).category,{topId:v}=f;f.isExpanded=!1,f.topId=v,o({type:s.SET_CATEGORY_UPDATED,payload:{category:f}})}else o({type:s.SET_ERROR,payload:{error:new Error(`${x}`)}})})}catch(r){return console.log(r),o({type:s.SET_ERROR,payload:{error:new Error("Karambol")}}),r}},[R,a.endpointCategory,l]),se=m.useCallback(async d=>{try{const{topId:r,parentId:p}=d,y=new jt(d,l).categoryRowDto,c=`${a.endpointCategory}`;console.time(),await R("DELETE",c,y).then(async x=>{console.timeEnd();const{categoryDto:f,msg:v}=x;v==="OK"?(console.log("Category successfully deleted",{categoryRow:d}),await k().then(async()=>{const q={categoryKey:{topId:r,parentId:"",id:p},formMode:E.None};p?await P():await Q(q).then(()=>{})})):o(v==="HasSubCategories"?{type:s.SET_ERROR,payload:{error:new Error("First remove sub categories"),whichRowId:f.Id}}:v==="HasQuestions"?{type:s.SET_ERROR,payload:{error:new Error("First remove category questions"),whichRowId:f.Id}}:{type:s.SET_ERROR,payload:{error:new Error(v),whichRowId:f.Id}})})}catch(r){return console.log(r),r}},[R,a.endpointCategory,Q,k,P,l]),dt=async(d,r)=>{try{console.log("Deleting Category Tag...",{categoryKey:d,variationName:r}),console.log("Category Tag successfully deleted")}catch(p){console.log("error",p),o({type:s.SET_ERROR,payload:{error:p}})}},we=12,ct=m.useCallback(async({categoryKey:d,startCursor:r,includeQuestionId:p})=>{try{const{topId:y,id:c}=d;o({type:s.SET_CATEGORY_QUESTIONS_LOADING,payload:{}});try{const x=`${a.endpointQuestion}/${l}/${y}/${c}/${r}/${we}/${p}`;console.time(),await R("GET",x).then(f=>{console.timeEnd();const{categoryDto:v}=f;if(v!==null){const q=new Re(v).category;o({type:s.CATEGORY_QUESTIONS_LOADED,payload:{categoryRow:q}})}})}catch(x){console.log(x),o({type:s.SET_ERROR,payload:{error:x}})}}catch(y){console.log(y),o({type:s.SET_ERROR,payload:y})}},[R,a.endpointQuestion,l]),ut=m.useCallback(async d=>{try{const{topId:r,id:p}=d;let y=await U(p);if(!y){alert(`Not found ${p}. Reload all Categories`);return}const c={topId:r,parentId:d.id,id:"generateId",title:"question text",categoryTitle:y.title,numOfAssignedAnswers:0,included:!0},x={...Oe,...c,title:""},f=_.topRows.find(q=>q.id===r),v=await C(f,p);o({type:s.ADD_NEW_QUESTION_TO_ROW,payload:{categoryRow:{...v,questionRows:[c,...v.questionRows]},newQuestionRow:c}}),o({type:s.SET_QUESTION,payload:{question:x,formMode:E.AddingQuestion}})}catch(r){console.log("error",r),o({type:s.SET_ERROR,payload:{error:r}})}},[Q,C,U,_.topRows]),gt=m.useCallback(async d=>{const{topId:r,id:p,parentId:y}=d;o({type:s.SET_LOADING_CATEGORY,payload:{}});try{d.created.nickName=h;const c=new $e(d,l).questionDto,x=`${a.endpointQuestion}`;console.time(),console.log(">>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> createQuestion",c),await R("POST",x,c).then(async f=>{if(console.timeEnd(),f){console.log("::::::::::::::::::::",{questionDtoEx:f});const{questionDto:v}=f;if(v){const q=new pe(v).question;q.topId=r,console.log("Question successfully created"),await k().then(async()=>{const H={categoryKey:{topId:r,parentId:y,id:y},formMode:E.EditingQuestion};await Q(H).then(()=>{o({type:s.SET_QUESTION,payload:{formMode:E.EditingQuestion,question:q}})})})}}})}catch(c){console.log(c),o({type:s.SET_ERROR,payload:{error:new Error("Server Error"),whichRowId:p}})}},[R,a.endpointQuestion,Q,k,h,l]),yt=m.useCallback(async(d,r,p)=>{const{id:y}=r;try{r.modified.nickName=h;const c=new $e(r,l).questionDto,x=`${a.endpointQuestion}`;console.time(),c.oldParentId=d,console.log(">>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> updateQuestion",c);let f=null;return await R("PUT",x,c).then(async v=>{console.timeEnd();const{questionDto:q,msg:B}=v;if(q){f=new pe(q).question,console.log("Question successfully updated: ",f);const{topId:H,parentId:ne}=f;if(p){const{topId:ue,parentId:ge,id:fe}=f,ye={topId:ue,categoryId:ge,questionId:fe};o({type:s.FORCE_OPEN_NODE,payload:{keyExpanded:ye}})}else{const ge={categoryKey:{topId:H,parentId:ne,id:ne},formMode:E.EditingQuestion};await Q(ge).then(()=>{o({type:s.SET_QUESTION,payload:{formMode:E.EditingQuestion,question:f}})})}}else o({type:s.SET_ERROR,payload:{error:new Error(B)}})}),f}catch(c){console.log(c),o({type:s.SET_ERROR,payload:{error:new Error("Server Error"),whichRowId:y}})}},[R,a.endpointQuestion,Q,h,l]),pt=m.useCallback(async(d,r)=>{const{id:p,parentId:y,topId:c}=d;o({type:s.SET_LOADING_QUESTION,payload:{}});try{const x=new _t(d,l).questionRowDto,f=`${a.endpointQuestion}`;console.time(),await R("DELETE",f,x).then(async v=>{const{questionDto:q}=v;if(console.timeEnd(),q){const B=new pe(q).question;console.log("Question successfully deleted"),r&&o({type:s.QUESTION_DELETED,payload:{question:B}});const ne={categoryKey:{topId:c,parentId:y,id:y},formMode:E.None};await Q(ne).then(()=>{})}else console.error(v),o({type:s.SET_ERROR,payload:{error:new Error("Server Error"),whichRowId:p}})})}catch(x){console.log(x),o({type:s.SET_ERROR,payload:{error:new Error("Server Error"),whichRowId:p}})}},[R,a.endpointQuestion,Q,l]),he=m.useCallback(async d=>new Promise(async r=>{try{const p=new Se(d).toQuery(l),y=`${a.endpointQuestion}?${p}`;console.time(),console.log("getQuestion",d),await R("GET",y).then(c=>{console.timeEnd();const{questionDto:x,msg:f}=c;if(x){const v={question:new pe(x).question,msg:f};r(v)}else r({question:null,msg:f})})}catch(p){console.log(p),r({question:null,msg:"Problemos"})}}),[R,a.endpointQuestion,l]),mt=m.useCallback(async d=>{const r=new Se(d).questionKey;o({type:s.SET_LOADING_QUESTION,payload:{}});const p=await he(r);j===E.AddingQuestion?await K():j===E.AddingCategory&&await Y();const{question:y,msg:c}=p;y?(y.topId=d.topId,o({type:s.SET_QUESTION_TO_VIEW,payload:{question:y}})):o({type:s.SET_ERROR,payload:{error:new Error(c)}})},[Y,K,j,he]),Et=m.useCallback(async d=>{const r=new Se(d).questionKey;j===E.AddingQuestion?await K():j===E.AddingCategory&&await Y(),o({type:s.SET_LOADING_QUESTION,payload:{}}),console.log("editQuestion:",r);const p=await he(r),{question:y,msg:c}=p;y?(y.topId=d.topId,o({type:s.CLOSE_QUESTION_FORM,payload:{question:y}}),o({type:s.SET_QUESTION_TO_EDIT,payload:{question:y}})):o({type:s.SET_ERROR,payload:{error:new Error(c)}})},[Y,K,j,he]),xt=m.useCallback(async(d,r,p)=>{try{var{topId:y,id:c}=p,x={topId:y,id:c,created:{time:new Date,nickName:h}};const f=new Nt(x).assignedAnswerDto;f.QuestionKeyDto=new vt(r,l).dto;let v=null;const q=`${a.endpointQuestionAnswer}/${d}`;console.time(),await R("POST",q,f).then(async B=>{console.timeEnd();const{questionDto:H}=B;console.log("::::::::::::::::::::",{questionDtoEx:B}),H&&(v=new pe(H).question,console.log("Question successfully modified"))}),v&&o({type:s.SET_QUESTION_AFTER_ASSIGN_ANSWER,payload:{question:v}})}catch(f){console.log("error",f),o({type:s.SET_ERROR,payload:{error:f}})}},[R,a.endpointQuestionAnswer,h,l]),wt=m.useCallback(async(d,r,p)=>{const y=A.find(x=>x.id===d);let c=await C(y,r);console.log("PROVIDER onCategoryTitleChanged::",c.title,p),c.title!==p&&(c.title=p===""?"New Category":p,o({type:s.RE_RENDER_TREE,payload:{categoryRow:c}}))},[C,A]),ht=m.useCallback(async(d,r,p)=>{const y=A.find(x=>x.id===d);let c=await C(y,r);if(c){const x=c.questionRows.find(f=>f.id===r);x.title!==p&&(x.title=p===""?"New Question":p,console.log("onQuestionTitleChanged+++>>>",r,c),o({type:s.QUESTION_TITLE_CHANGED,payload:{categoryRow:c}}))}},[C,A]),ft={state:_,loadAllCategoryRows:k,getSubCats:D,getCat:U,loadAllGroupRows:S,expandNodesUpToTheTree:ee,loadTopRows:P,addSubCategory:de,cancelAddCategory:Y,createCategory:ce,viewCategory:z,editCategory:oe,updateCategory:W,deleteCategory:se,deleteCategoryVariation:dt,expandCategory:Q,collapseCategory:X,onCategoryTitleChanged:wt,loadCategoryQuestions:ct,addQuestion:ut,cancelAddQuestion:K,createQuestion:gt,viewQuestion:mt,editQuestion:Et,updateQuestion:yt,deleteQuestion:pt,onQuestionTitleChanged:ht,assignQuestionAnswer:xt};return!u||!F?null:e.jsx(Ze.Provider,{value:ft,children:e.jsx(et.Provider,{value:o,children:t})})};function M(){return m.useContext(Ze)}const De=()=>m.useContext(et);var ae=(t=>(t.SET_LOADING="SET_LOADING",t.SET_SUB_CATS="SET_SUB_CATS",t.SET_ERROR="SET_ERROR",t.SET_EXPANDED="SET_EXPANDED",t.SET_PARENT_CAT="SET_PARENT_CAT",t))(ae||{});const Wt=({cat:t,dispatch:i,setParentCat:g,selId:n})=>{const{topId:a,parentId:u,id:l,title:w,level:T,isExpanded:h}=t,_={topId:a,parentId:u,id:l},o=b=>{i({type:ae.SET_EXPANDED,payload:{id:l,expanding:!h}})},j=b=>{g(b)},N=e.jsxs("div",{className:"d-flex justify-content-start align-items-center w-100 text-primary",children:[e.jsx($,{variant:"link",size:"sm",className:"py-0 px-1",onClick:b=>{o(),b.stopPropagation(),b.preventDefault()},title:"Expand",children:e.jsx(re,{icon:h?Me:ze,size:"lg"})}),e.jsx($,{variant:"link",size:"sm",className:"py-0 mx-0 text-decoration-none",title:l,onClick:()=>j(t),children:w})]});return e.jsxs(e.Fragment,{children:[e.jsx(Z.Item,{variant:"primary",className:"py-0 px-1 w-100",as:"li",children:N}),h&&e.jsx(Z.Item,{className:"py-0 px-0",variant:"primary",as:"li",children:e.jsx(ot,{selId:n,level:T+1,categoryKey:_,setParentId:g})})]})},Ht={loading:!1,parentId:null,title:"",cats:[]},Xt=(t,i)=>{switch(i.type){case ae.SET_LOADING:return{...t,loading:!0};case ae.SET_SUB_CATS:{const{subCats:g}=i.payload;return{...t,cats:t.cats.concat(g),loading:!1}}case ae.SET_ERROR:{const{error:g}=i.payload;return{...t,error:g,loading:!1}}case ae.SET_EXPANDED:{const{id:g,expanding:n}=i.payload;let{cats:a}=t;if(!n){const u=tt(a,g);console.log("clean:",u),u.length>0&&(a=a.filter(l=>!u.includes(l.id)))}return{...t,cats:t.cats.map(u=>u.id===g?{...u,isExpanded:n}:u)}}case ae.SET_PARENT_CAT:{const{cat:g}=i.payload,{id:n,title:a}=g;return{...t,parentId:n,title:a}}default:return t}};function tt(t,i){let g=t.filter(n=>n.parentId===i).map(n=>n.id);return g.forEach(n=>{const a=n?tt(t,n):[];g=g.concat(a)}),g}const ot=({selId:t,categoryKey:i,level:g,setParentId:n})=>{const[a,u]=m.useReducer(Xt,Ht),{getSubCats:l}=M(),{id:w}=i??{id:null},[T]=m.useState(i);m.useEffect(()=>{(async()=>{const o=await l(w),{subCats:j}=o;u({type:ae.SET_SUB_CATS,payload:{subCats:j}})})()},[l,T,w]);const h=a.cats.filter(o=>o.parentId===w),_=o=>{u({type:ae.SET_PARENT_CAT,payload:{cat:o}}),n(o)};return e.jsxs("div",{className:g>1?"border  border-7 ms-4 h-25":"border border-7  h-25",style:{overflowY:"auto"},children:[e.jsx(Z,{as:"ul",variant:"dark",className:"mb-0",children:h.filter(o=>o.id!==t).map(o=>e.jsx(Wt,{cat:o,selId:t,dispatch:u,setParentCat:_},o.id))}),a.error&&a.error.message]})},Jt=({questionTitle:t,assignedAnswer:i,isDisabled:g,unAssignAnswer:n})=>{const{id:a,answerTitle:u,created:l}=i,{time:w,nickName:T}=l,h=localStorage.getItem("emailFromClient"),_=`Created by: ${T}, ${Xe(new Date(w))}`,{canEdit:o,isDarkMode:j}=ie(),N=!1,b=()=>{n(i)},L=P=>{console.log(`Selected Answer id=${P}`)},A=()=>{},[G,F]=m.useState(!1),R=()=>F(!1),k=P=>{navigator.clipboard&&navigator.clipboard.writeText(P).then(()=>{console.log("Copied to clipboard successfully."),alert("Answer copied to clipboard")},I=>{console.log("Failed to copy the text to clipboard.",I)})},[S,U]=xe(),D=e.jsxs("div",{ref:S,className:"d-flex justify-content-start align-items-center w-100 text-light bg-info",children:[e.jsx($,{variant:"link",size:"sm",className:"py-0 px-0 text-info",onClick:()=>h?F(!0):k(u),children:e.jsx(re,{icon:h?Dt:kt,size:"sm",title:"Send this Answer in a reply on Question"})}),e.jsx($,{variant:"link",size:"sm",className:"py-0 mx-1 text-decoration-none text-white text-wrap",title:_,onClick:()=>L(a),disabled:N,children:u}),o&&!N&&U&&!g&&e.jsx($,{variant:"link",size:"sm",className:"ms-1 py-0 mx-1 text-secondary",onClick:b,children:e.jsx(re,{icon:_e,size:"lg"})})]});return e.jsxs(Z.Item,{variant:"info",className:"py-0 px-0",as:"li",children:[D,e.jsxs(V,{show:G,onHide:R,animation:!0,centered:!0,size:"lg",className:`${j?"bg":""}`,contentClassName:`${j?"bg-info bg-gradient":""}`,children:[e.jsx(V.Header,{closeButton:!0,children:"Send Answer in a reply on Question"}),e.jsx(V.Body,{className:"py-0",children:e.jsx("table",{className:"table-info table-hover table-bordered w-100 h-100",children:e.jsxs("tbody",{children:[e.jsxs("tr",{className:"border-top-0",children:[e.jsx("td",{children:"To:"}),e.jsx("td",{children:h})]}),e.jsxs("tr",{children:[e.jsx("td",{children:"Subject:"}),e.jsx("td",{children:t})]}),e.jsxs("tr",{className:"border-bottom-0",children:[e.jsx("td",{children:"Body:"}),e.jsx("td",{children:u})]})]})})}),e.jsxs(V.Footer,{children:[e.jsx($,{variant:"secondary",size:"sm",onClick:R,children:"Cancel"}),e.jsx($,{variant:"primary",size:"sm",onClick:A,children:"Send E-Mail"})]})]})]},a)},Zt=({})=>e.jsx("span",{children:"Posle"}),eo=m.lazy(()=>At(()=>import("./AutoSuggestAnswers-DSvwzOb6.js"),__vite__mapDeps([0,1,2,3,4,5])).then(t=>({default:t.AutoSuggestAnswers}))),to=({questionKey:t,questionTitle:i,assignedAnswers:g,isDisabled:n})=>{const{globalState:a,searchAnswers:u}=je(),{isDarkMode:l,variant:w}=a,[T,h]=m.useState(!1),_=()=>h(!1),o=()=>{_()},{state:j,assignQuestionAnswer:N}=M(),{allGroupRows:b}=j,[L,A]=m.useState(!1),G=async S=>{await N("Assign",t,S),A(!1)},F=async S=>{S&&await G({topId:S.topId,id:S.id}),_()},R=async S=>{await N("UnAssign",t,S)},k=async()=>{A(!0)};return e.jsxs("div",{className:"mx-0 my-0 px-1 py-1 border border-2 rounded-2 border-info bg-info",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-muted bg-info fs-6",children:"Assigned Answers"}),e.jsx(Z,{as:"ul",variant:w,className:"my-1",children:g.map(S=>e.jsx(Jt,{questionTitle:i,assignedAnswer:S,groupInAdding:!1,isDisabled:n,unAssignAnswer:R},S.id))}),j.error&&e.jsx("div",{children:"state.error"})]}),e.jsxs("div",{className:"d-flex justify-content-start w-100 align-items-center py-1",children:[e.jsx($,{size:"sm",className:"button-edit py-0 rounded-1",title:"Assign a new Answer",style:{border:"1px solid silver",fontSize:"12px"},variant:w,disabled:n,onClick:k,children:"Assign answer"}),e.jsx($,{size:"sm",className:"button-edit py-0 rounded-1 mx-1",title:"Add and Assign a new Answer",style:{border:"1px solid silver",fontSize:"12px"},variant:w,disabled:n,onClick:async S=>{h(!0),S.preventDefault()},children:"Add a new answer"})]}),e.jsxs(V,{show:T,onHide:_,animation:!0,centered:!0,size:"lg",className:"",contentClassName:`${l?"bg-info bg-gradient":""}`,children:[e.jsx(V.Header,{closeButton:!0,children:e.jsx(V.Title,{children:i})}),e.jsx(V.Body,{children:e.jsx(Zt,{inLine:!0,closeModal:o,onAnswerCreated:F})})]}),e.jsxs(V,{show:L,onHide:()=>A(!1),animation:!0,size:"lg",centered:!0,className:`${l?"dark":""}`,contentClassName:`${l?"dark":""}`,children:[e.jsx(V.Header,{closeButton:!0,children:e.jsx(V.Title,{children:"Assign the answer"})}),e.jsx(V.Body,{style:{height:"40vh",width:"50vw"},className:"answers",children:e.jsx(m.Suspense,{fallback:e.jsx("div",{children:"Loading..."}),children:e.jsx(eo,{tekst:"tekst",onSelectAnswer:G,allGroupRows:b,searchAnswers:u})})})]})]})},oo=({relatedFilter:t})=>{const{filter:i,numOfUsages:g,created:n,lastUsed:a}=t,{time:u,nickName:l}=n,w=`Created by: ${l}, ${Xe(new Date(u))}`,T=!1,h=N=>{console.log("RelatedFilter onSelectAnswer",{filter:N})},[_,o]=xe(),j=e.jsxs("div",{ref:_,className:"d-flex justify-content-start align-items-center w-100 text-light related-filter-row",children:[e.jsx($,{variant:"link",size:"sm",className:"py-0 mx-0 title text-light text-wrap",title:w,onClick:()=>h(i),disabled:T,children:i}),e.jsxs(Ne,{pill:!0,bg:"secondary",className:`text-light ${g===0?"d-none":"d-inline"}`,children:[g,g===1?" usage":" usages"]}),e.jsx("span",{className:"small ms-1",children:Mt(a.time)}),o]});return e.jsx(Z.Item,{className:"py-0 px-0",as:"li",children:j},i)},so=({relatedFilters:t})=>{const{globalState:i}=je(),{variant:g}=i,{state:n}=M(),a=async u=>{console.log("RelatedFilters unAssignFilter",{relatedFilter:u})};return e.jsx("div",{className:"mx-0 my-1 border rounded-2 px-1 py-1border-light fs-6 related-filters",children:e.jsxs("div",{children:[e.jsx("label",{className:"text-muted",children:"Most frequently selected Filters (for the next Question in ChatBot)"}),t.length>0?e.jsx(Z,{as:"ul",variant:g,className:"my-1",children:t.map(u=>e.jsx(oo,{relatedFilter:u,unAssignFilter:a},u.filter))}):e.jsx("div",{className:"border text-light",children:"No filters"}),n.error&&e.jsx("div",{children:"state.error"})]})})},ke=({question:t,submitForm:i,children:g,showCloseButton:n,source:a=0,closeModal:u})=>{const{state:l,onQuestionTitleChanged:w}=M();let{formMode:T}=l;const h=T===E.ViewingQuestion,_=T===E.EditingQuestion,o=T===E.AddingQuestion,j=h,{topId:N,id:b,assignedAnswers:L,relatedFilters:A,title:G}=t,F=new Se(t).questionKey,R=De(),k=()=>{u?u():R({type:s.CLOSE_QUESTION_FORM,payload:{question:t}})},S=()=>{u?u():R({type:s.CANCEL_QUESTION_FORM,payload:{question:t}})},[U,D]=m.useState(G),P=Ve(U,500),I=m.useRef(null),C=Ke({enableReinitialize:!0,initialValues:t,validationSchema:Ye().shape({title:Ae().required("Required"),parentId:Ae().required("Required").notOneOf(["000000000000000000000000"])}),onSubmit:Q=>{i(Q),D(Q.title)}});m.useEffect(()=>{(async()=>C.values.title!==P&&w(N,b,C.values.title))()},[P,C.values.title,w,N,b]),m.useEffect(()=>{I.current.focus(),a!==0&&C.setFieldValue("source",a)},[C,I,a]);const ee=Q=>{C.handleChange(Q);const X=Q.target.value;D(X)},te=Q=>{C.setFieldValue("parentId",Q.id),C.setFieldValue("categoryTitle",Q.title)};return e.jsxs("div",{className:"form-wrapper px-3 py-1 my-0 my-1 w-100 question-form",children:[n&&e.jsx(Ue,{onClick:k,className:"float-end"}),e.jsx(Ee,{className:"text-center",children:e.jsxs(O.Label,{children:["Question  ",h?"Viewing":_?"Editing":"Adding"]})}),e.jsxs(O,{onSubmit:C.handleSubmit,children:[e.jsxs(Qe,{direction:"horizontal",gap:0,className:"border",children:[e.jsx("div",{className:"p-0",children:e.jsx(O.Label,{children:"Category:"})}),e.jsx("div",{className:"p-1",children:e.jsxs(O.Group,{controlId:"parentId",className:"category-select form-select-sm w-90",children:[e.jsxs(Te,{children:[e.jsx(Te.Toggle,{variant:"light",id:"dropdown-basic",className:"px-2 py-0 text-primary border",disabled:j,children:e.jsx("span",{className:"text-wrap me-1",children:C.values.categoryTitle})}),e.jsx(Te.Menu,{className:"p-0 border",children:e.jsx(Te.Item,{className:"p-0 m-0 rounded-3",children:e.jsx(ot,{selId:C.values.parentId,categoryKey:null,level:1,setParentId:te})})})]}),e.jsx(O.Control,{as:"input",name:"parentId",onChange:C.handleChange,value:C.values.parentId?C.values.parentId:"",placeholder:"Category",className:"text-primary w-100",disabled:j,hidden:!0}),e.jsx(O.Text,{className:"text-danger",children:C.touched.parentId&&C.errors.parentId?e.jsx("div",{className:"text-danger",children:C.errors.parentId?"required":""}):null})]})})]}),e.jsxs(O.Group,{controlId:"title",children:[e.jsx(O.Label,{children:"Title"}),e.jsx(O.Control,{as:"textarea",name:"title",placeholder:C.values.title==="new Question"?"new Question":"question text",ref:I,onChange:ee,value:C.values.title,rows:3,className:"text-primary w-100",disabled:j}),e.jsx(O.Text,{className:"text-danger",children:C.touched.title&&C.errors.title?e.jsx("div",{className:"text-danger",children:C.errors.title}):null})]}),e.jsxs(Ee,{children:[e.jsx(me,{children:e.jsxs(O.Group,{controlId:"source",children:[e.jsx(O.Label,{children:"Source"}),e.jsx(Ie,{id:"source",name:"source",options:Lt,onChange:(Q,X)=>{Q.preventDefault(),C.setFieldValue("source",X)},value:C.values.source,disabled:j,classes:"text-primary"}),e.jsx(O.Text,{className:"text-danger",children:C.touched.source&&C.errors.source?e.jsx("div",{className:"text-danger",children:C.errors.source}):null})]})}),e.jsx(me,{children:e.jsxs(O.Group,{controlId:"status",children:[e.jsx(O.Label,{children:"Status"}),e.jsx(Ie,{id:"status",name:"status",options:Gt,onChange:(Q,X)=>{Q.preventDefault(),C.setFieldValue("status",X)},value:C.values.status,disabled:j,classes:"text-primary"}),e.jsx(O.Text,{className:"text-danger",children:C.touched.status&&C.errors.status?e.jsx("div",{className:"text-danger",children:C.errors.status}):null})]})})]}),(h||_)&&e.jsxs("div",{className:"my-1",children:[e.jsx(to,{questionKey:F,questionTitle:U,assignedAnswers:L,isDisabled:j}),e.jsx(so,{questionKey:F,questionTitle:U,relatedFilters:A}),e.jsx(Be,{created:t.created,modified:t.modified,classes:"text-primary"})]}),(C.dirty&&_||o)&&e.jsx(We,{cancelForm:S,handleSubmit:C.handleSubmit,title:g}),l.error&&e.jsx("div",{className:"text-danger",children:l.error.message})]})]})},Le=({closeModal:t,showCloseButton:i,source:g,setError:n})=>{const{state:a,cancelAddQuestion:u,createQuestion:l}=M(),{activeQuestion:w}=a,T=w?w.topId:"",h=async()=>{await u()},_=async o=>{const j={...o,topId:T,created:{time:new Date,nickName:""},modified:void 0},N=await l(j,t!==void 0);N&&(N.message?n(N.message):t&&t())};return w?e.jsx(ke,{question:w,showCloseButton:i??!0,source:g??0,closeModal:h,submitForm:_,children:"Create Question"}):null},st=({})=>{const{state:t,updateQuestion:i,loadAllGroupRows:g}=M(),{activeQuestion:n,allGroupRowsLoaded:a}=t;if(!n)return null;if(!n)return e.jsx("div",{children:"Loading question to edit..."});m.useEffect(()=>{(async()=>a===void 0&&await g())()},[a,g]);const u=async l=>{const w={...l,created:void 0,modified:{time:new Date,nickName:""}},{parentId:T}=n,h=T!==w.parentId;await i(T,w,h)};return e.jsx(ke,{question:n,showCloseButton:!0,source:0,submitForm:u,children:"Update Question"})},nt=({inLine:t})=>{console.log(t?"ViewQuestion inLine":"ViewQuestion not inLine");const{state:i}=M(),{activeQuestion:g}=i,[n,a]=m.useState(null);return m.useEffect(()=>{console.log("#################################### ViewQuestion setQuestion ...",{activeQuestion:g}),a(g)},[g]),e.jsx(ke,{question:n,showCloseButton:!0,source:0,submitForm:()=>{},children:"View Question"})},no=({questionRow:t,isSelected:i})=>{const{id:g,topId:n,parentId:a,title:u,numOfAssignedAnswers:l}=t,w={topId:n,parentId:a,id:a},{canEdit:T,authUser:h}=ie(),{state:_,viewQuestion:o,addQuestion:j,editQuestion:N,deleteQuestion:b}=M(),{activeQuestion:L,formMode:A,loadingQuestion:G,questionLoaded:F}=_,R=L!==null&&L.id===g,k=A===E.AddingQuestion,S=()=>{t.modified={time:new Date,nickName:h.nickName},b(t,R)},U=async C=>{console.log("QuestionRow onSelectQuestion",{id:C}),T?await N(t):await o(t)},[D,P]=xe();m.useEffect(()=>{(async()=>{if(i&&!G&&!F){switch(A){case E.ViewingQuestion:await o(t);break;case E.EditingQuestion:console.log("Zovem from QuestionRow"),T?await N(t):await o(t);break}document.getElementById(`QuestionRow${g}`)?.scrollIntoView({behavior:"smooth",block:"end"})}})()},[T,N,A,g,i,G,F,t,o]);const I=e.jsxs("div",{id:`QuestionRow${g}`,className:`d-relative d-flex justify-content-start align-items-center w-100 mt-0 question-row${i?"-selected":""}`,style:{marginTop:"1px"},children:[e.jsx($,{variant:"link",size:"sm",className:"d-flex align-items-center px-1 text-secondary",children:e.jsx("img",{width:"22",height:"18",src:It,alt:"Question"})}),e.jsx($,{variant:"link",size:"sm",className:`p-0 px-1 m-1 ms-0 question-row-title ${R?"fw-bold":""}`,title:`id:${g.toString()}`,onClick:()=>U(g),disabled:k,children:u}),e.jsxs(Ne,{pill:!0,bg:"secondary",className:`text-info ${l===0?"d-none":"d-inline"}`,children:[l,"a"]}),T&&!k&&P&&e.jsxs("div",{className:"position-absolute text-nowrap d-flex align-items-center border border-0 border-warning p-0 end-0",children:[e.jsx($,{variant:"link",size:"sm",className:"ms-1 p-0 text-secondary d-flex align-items-center",title:"Add Question",onClick:()=>{j(w,!0)},children:e.jsx("img",{width:"22",height:"18",src:He,alt:"Add Question"})}),e.jsx($,{variant:"link",size:"sm",className:"ms-0 p-0 text-secondary",onClick:S,children:e.jsx(re,{icon:_e,size:"lg"})})]})]});return e.jsxs(Z.Item,{className:"py-0 px-0 w-100",as:"li",children:[i&&A===E.AddingQuestion&&e.jsxs(e.Fragment,{children:[e.jsx("div",{id:"div-question",className:"ms-0 d-md-none w-100",children:e.jsx(Le,{showCloseButton:!0,source:0})}),e.jsx("div",{ref:D,className:"d-none d-md-block  border rounded-3",children:I})]}),i&&A===E.EditingQuestion&&e.jsxs(e.Fragment,{children:[e.jsx("div",{ref:D,className:"",children:I}),e.jsx("div",{id:"div-question",className:"ms-0 d-md-none w-100",children:e.jsx(st,{inLine:!0})})]}),i&&A===E.ViewingQuestion&&e.jsxs(e.Fragment,{children:[e.jsx("div",{ref:D,className:"",children:I}),e.jsx("div",{ref:D,id:"div-question",className:"ms-0 d-md-none w-100",children:e.jsx(nt,{inLine:!0})})]}),!i&&e.jsx("div",{ref:D,className:"",children:I})]})},at=({categoryRow:t})=>{const{state:i,loadCategoryQuestions:g}=M(),{keyExpanded:n,loadingQuestion:a,error:u,selectedQuestionId:l}=i,{questionId:w}=n;t.level+=1;const{questionRows:T}=t;let h=!1;async function _(){try{const N={categoryKey:new le(t).categoryKey,startCursor:T.length,includeQuestionId:w??null};console.log("^^^^^^^^^^^^^ loadMore"),console.log("^^^^^^^^^^^^^",{x:N}),console.log("^^^^^^^^^^^^^ loadMore"),await g(N)}catch{}}const[o,{rootRef:j}]=qt({loading:a,hasNextPage:h,onLoadMore:_,disabled:!!u,rootMargin:"0px 0px 100px 0px"});return e.jsxs("div",{ref:j,className:"ms-0",style:{maxHeight:"400px",overflowY:"auto"},children:[e.jsxs(Ft,{children:[T.length===0&&e.jsx("label",{children:"No questions"}),T.map(N=>e.jsx(no,{questionRow:N,isSelected:N.id===l},N.id)),h]}),u&&e.jsxs("p",{children:["Error: ",u.message]})]})},ao=({categoryKey:t,tag:i,categoryInAdding:g})=>{const{name:n}=i,{canEdit:a}=ie(),{state:u,deleteCategoryVariation:l}=M(),w=()=>{l(t,n)},[T,h]=xe(),_=e.jsxs("div",{ref:T,children:[e.jsx(Ne,{pill:!0,bg:"secondary",children:n}),a&&!0&&h&&e.jsx($,{variant:"link",size:"sm",className:"ms-0 py-0 mx-0 text-secondary",onClick:w,children:e.jsx(re,{icon:_e,size:"sm"})}),!1]});return e.jsx("div",{className:"py-1 px-1",children:_})},ro=({categoryKey:t,variations:i})=>{const{state:g}=M(),{error:n}=g;return m.useEffect(()=>{},[]),e.jsxs("div",{className:"ms-2",children:[e.jsxs(Qe,{direction:"horizontal",gap:2,children:[i.length===0&&e.jsx("div",{children:"No variations"}),i.length>0&&i.map(a=>e.jsx(ao,{categoryKey:t,tag:a,categoryInAdding:void 0}))]}),n&&e.jsxs("p",{children:["Error: ",n.message]})]})},Ge=({formMode:t,category:i,submitForm:g,children:n})=>{const{onCategoryTitleChanged:a}=M(),u=t===E.ViewingCategory,l=t===E.EditingCategory,w=t===E.AddingCategory,{topId:T,id:h,variations:_,questionRows:o,title:j}=i;console.log("CategoryForm render: ",{topId:T,id:h,catTitle:j,formMode:t,variations:_});const N=new le(i).categoryKey;document.getElementById("div-details");const b=o&&o.length>0,L=De(),A=()=>{L({type:s.CLOSE_CATEGORY_FORM,payload:{}})},G=()=>{L({type:s.CANCEL_CATEGORY_FORM,payload:{}})},[F,R]=m.useState(j),k=Ve(F,300),S=Ke({enableReinitialize:!0,initialValues:i,validationSchema:Ye().shape({title:Ae().required("Required")}),onSubmit:I=>{console.log("CategoryForm.onSubmit",JSON.stringify(I,null,2)),g(I),R(I.title)}});m.useEffect(()=>{(async()=>(console.log("CategoryForm.useEffect - onCategoryTitleChanged",{debouncedSearchTerm:k,title:S.values.title}),S.values.title!==k&&a(T,h,S.values.title)))()},[k,S.values.title,a]);const U=I=>{S.handleChange(I);const C=I.target.value;R(C)},D=m.useRef(null);m.useEffect(()=>{},[D]);const P=!1;return console.log("CategoryForm render return: ",F),e.jsxs("div",{className:"form-wrapper p-2 category-form",children:[e.jsx(Ue,{onClick:A,className:"float-end"}),e.jsx(Ee,{className:"text-center text-muted",children:e.jsxs(O.Label,{children:["Category ",u?"Viewing":l?"Editing":"Adding"]})}),e.jsxs(O,{onSubmit:()=>S.handleSubmit,children:[e.jsx(O.Group,{controlId:"Variations",children:e.jsxs(Qe,{direction:"horizontal",gap:1,children:[e.jsx("div",{className:"px-0",children:e.jsx(O.Label,{children:"Variations:"})}),e.jsx("div",{className:"px-1 border border-1 border-secondary rounded",children:e.jsx(ro,{categoryKey:N,variations:_?_.map(I=>({name:I})):[]})}),e.jsx("div",{className:"ps-2",children:e.jsx(O.Label,{children:"Kind:"})}),e.jsx("div",{className:"px-1 border border-1 border-secondary rounded",children:e.jsxs(O.Group,{controlId:"kind",children:[e.jsx(Ie,{id:"kind",name:"kind",options:Pt,onChange:(I,C)=>{I.preventDefault(),S.setFieldValue("kind",C)},value:S.values.kind,disabled:P,classes:"text-primary"}),e.jsx(O.Text,{className:"text-danger",children:S.touched.kind&&S.errors.kind?e.jsx("div",{className:"text-danger",children:S.errors.kind}):null})]})})]})}),e.jsxs(O.Group,{controlId:"title",children:[e.jsx(O.Label,{children:"Title"}),e.jsx(O.Control,{as:"textarea",name:"title",placeholder:"new Category",value:F,onChange:U,onFocus:I=>{t===E.AddingCategory&&I.target.select()},ref:D,rows:3,className:"text-primary w-100",disabled:u}),e.jsx(O.Text,{className:"text-danger",children:S.touched.title&&S.errors.title?e.jsx("div",{className:"text-danger",children:S.errors.title}):null})]}),e.jsxs(O.Group,{controlId:"link",children:[e.jsx(O.Label,{children:"Link"}),S.values.hasSubCategories?e.jsx(O.Control,{as:"input",placeholder:"/categories/...",name:"link",onChange:S.handleChange,className:"text-primary w-100",value:"Can't have link (has sub categories)",disabled:!0}):e.jsxs(e.Fragment,{children:[e.jsx(O.Control,{as:"input",placeholder:"/categories/...",name:"link",onChange:S.handleChange,className:"text-primary w-100",value:S.values.link??"",disabled:u}),e.jsx(O.Text,{className:"text-danger",children:S.touched.link&&S.errors.link?e.jsx("div",{className:"text-danger",children:S.errors.link}):null})]})]}),e.jsxs(O.Group,{children:[e.jsxs(O.Label,{className:"m-1 mb-0",children:["Questions (",`${S.values.numOfQuestions}`,") "]}),b&&e.jsx(at,{categoryRow:i})]}),(u||l)&&e.jsx(Be,{created:i.created,modified:i.modified,classes:"text-primary"}),(S.dirty&&l||w)&&e.jsx(We,{cancelForm:G,handleSubmit:S.handleSubmit,title:n})]})]})},rt=({inLine:t})=>{const i=ie(),{nickName:g}=i.authUser,{state:n,updateCategory:a}=M(),{activeCategory:u,keyExpanded:l}=n,{questionId:w}=l,T=async h=>{const _={...h,created:void 0,modified:{time:new Date,nickName:g}};await a(_,!0)};return e.jsx(Ge,{inLine:t,category:{...u},questionId:w,formMode:E.EditingCategory,submitForm:T,children:"Update Category"})},be=({inLine:t})=>{const{state:i}=M(),{activeCategory:g,keyExpanded:n}=i,{questionId:a}=n;return e.jsx(Ge,{inLine:t,category:{...g},questionId:a,formMode:E.ViewingCategory,submitForm:()=>{},children:"View Category"})},it=({activeCategory:t})=>{const i=ie(),{nickName:g}=i.authUser,{createCategory:n}=M(),[a]=m.useState({...t}),u=async l=>{const w={...l,created:{time:new Date,nickName:g},modified:void 0};console.log("**********object",w),await n(w)};return!t===null?null:(console.log("AddCategory render >>>>>:",t),e.jsx(e.Fragment,{children:e.jsx(Ge,{inLine:!1,category:a,questionId:null,formMode:E.AddingCategory,submitForm:u,children:"Create Category"})}))},io=({categoryRow:t,questionId:i})=>{const{id:g,title:n,hasSubCategories:a,numOfQuestions:u,isExpanded:l,categoryRows:w}=t;t.level+=1;const T=new le(t).categoryKey,{canEdit:h,authUser:_}=ie(),{state:o,addSubCategory:j,viewCategory:N,editCategory:b,deleteCategory:L,expandCategory:A,collapseCategory:G,addQuestion:F}=M();let{formMode:R,activeCategory:k,loadingCategory:S,categoryLoaded:U}=o;const D=k!==null&&k.id===g,P=R===E.AddingCategory,I=l&&u>0,C=()=>{t.modified={time:new Date,nickName:_.nickName},L(t)},ee=async()=>{l?await G(t):await A({categoryKey:T})},[te,Q]=m.useState(!1);m.useEffect(()=>{Q(!0)},[w]);const X=async()=>{h?await b(t,i??"null"):await N(t,i??"null")},[de,Y]=m.useState(!1);m.useEffect(()=>{de&&(j(t),Y(!1))},[j,t,de]);const[ce,K]=m.useState(!1);m.useEffect(()=>{ce&&(F(T,l??!1),K(!1))},[F,T,l,ce]),m.useEffect(()=>{(async()=>{if(D&&!S&&!U&&!P)switch(console.log("CategoryRow formMode:",R),R){case E.ViewingCategory:await N(t,i??"null");break;case E.EditingCategory:h?await b(t,i??"null"):await N(t,i??"null");break}})()},[h,T,U,t,b,A,R,P,D,S,i,N]);const[z,oe]=xe(),W=e.jsxs("div",{children:[e.jsxs("div",{id:`Row${g}`,className:`d-relative d-flex justify-content-start align-items-center w-100 mt-1 category-row${D?"-selected":""}`,style:{marginTop:"1px"},children:[e.jsx($,{variant:"link",size:"sm",className:"py-0 px-1","aria-controls":g+"-2","aria-expanded":te,onClick:se=>{ee(),se.stopPropagation()},title:"Expand",disabled:P||!a&&u===0,children:e.jsx(re,{icon:l?Me:ze,size:"lg"})}),e.jsx($,{variant:"link",size:"sm",className:"py-0 px-1 bg-light",title:"Expand",disabled:!0,children:e.jsx(re,{icon:$t,size:"sm"})}),e.jsx($,{variant:"link",size:"sm",className:`py-0 ms-0 me-1 category-row-title ${D?"fw-bold text-white bg-transparent":""}`,title:g,onClick:X,disabled:P,children:n}),u>0&&e.jsxs(Ne,{pill:!0,bg:"secondary",className:"d-inline bg-transparent",children:[u,"Q"]}),h&&oe&&e.jsxs("div",{className:"position-absolute text-nowrap d-flex align-items-center border border-0 border-warning p-0 end-0",children:[e.jsx("div",{className:"d-flex align-items-center",children:e.jsx($,{variant:"link",size:"sm",className:"border-0 py-0 px-0 ms-0 text-success",title:"Add SubCategory",onClick:async()=>{!l&&(a||u>0)&&await ee(),setTimeout(()=>Y(!0),1e3)},children:e.jsx(re,{icon:Ut,size:"lg"})})}),!P&&!a&&e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx($,{variant:"link",size:"sm",className:"p-0 mx-0 text-secondary d-flex align-items-center border border-0 border-warning1",title:"Add Question",onClick:async()=>{!l&&(a||u>0)&&await ee(),setTimeout(()=>K(!0),500)},children:e.jsx("img",{width:"22",height:"18",src:He,alt:"Add Question"})}),e.jsx($,{variant:"link",size:"sm",className:"d-flex align-items-center border border-0 border-warning p-0",disabled:a||u>0,onClick:C,children:e.jsx(re,{icon:_e,size:"lg"})})]})]})]}),I&&e.jsx("div",{className:"ps-3",children:e.jsx(at,{categoryRow:t})})]});return e.jsxs(e.Fragment,{children:[e.jsxs(Z.Item,{className:"py-0 px-1 w-100 category-bg",as:"li",children:[D&&R===E.AddingCategory&&e.jsxs("div",{children:[e.jsx("div",{ref:z,className:"",children:W}),e.jsx("div",{className:"ms-0 d-md-none w-100",children:e.jsx(it,{activeCategory:k})})]}),D&&R===E.EditingCategory&&e.jsxs(e.Fragment,{children:[e.jsx("div",{ref:z,children:W}),e.jsx("div",{id:"divInLine",className:"ms-0 d-md-none w-100",children:e.jsx(rt,{inLine:!1})})]}),D&&R===E.ViewingCategory&&e.jsxs(e.Fragment,{children:[e.jsx("div",{ref:z,children:W}),e.jsx("div",{id:"divInLine",className:"ms-0 d-md-none w-100",children:e.jsx(be,{inLine:!1})})]}),D&&R===E.None&&e.jsxs(e.Fragment,{children:[e.jsx("div",{ref:z,children:W}),e.jsx("div",{id:"divInLine",className:"ms-0 d-md-none w-100",children:e.jsx(be,{inLine:!1})})]}),!D&&e.jsx("div",{ref:z,children:W})]}),o.error&&o.whichRowId===g&&e.jsx("div",{className:"text-danger",children:o.error.message}),l&&e.jsx(Z.Item,{className:"py-0 px-0 border-0 border-warning border-bottom-0 category-bg p-0 m-0",variant:"primary",as:"li",children:e.jsx("div",{className:"rambo",children:a&&e.jsx(Ot,{in:te,children:e.jsx("div",{id:g+"-2",style:{marginTop:"1px"},children:e.jsx("div",{style:{border:"1px solid #ddd",borderRadius:"4px"},children:e.jsx(lt,{categoryRow:t,isExpanded:l})})})})})})]})},lt=({categoryRow:t})=>{const{level:i,categoryRows:g}=t,{state:n}=M();let{keyExpanded:a}=n;const{questionId:u}=a??{questionId:null};return e.jsx("div",{className:i>1?"ms-2":"",children:e.jsx(Z,{as:"ul",variant:"dark",className:"mb-0 category-bg",children:g.map(l=>e.jsx(io,{categoryRow:l,questionId:u===""?null:u},l.id))})})},lo=t=>{const{isDarkMode:i}=ie(),[g,n]=m.useState("");return m.useEffect(()=>{},[]),e.jsxs(V,{show:t.show,onHide:t.onHide,animation:!0,centered:!0,size:"lg",className:"modal show",contentClassName:`${i?"bg-secondary bg-gradient":"bg-info bg-gradient"}`,children:[e.jsx(V.Header,{closeButton:!0,children:"Store new Question to the Database"}),e.jsx(V.Body,{className:"py-0",children:e.jsx(Le,{closeModal:t.onHide,showCloseButton:!1,source:1,setError:a=>n(a)})}),e.jsx(V.Footer,{children:g})]})},co=({categoryId_questionId:t,fromChatBotDlg:i})=>{const{state:g,expandNodesUpToTheTree:n,loadTopRows:a,addSubCategory:u}=M(),{allCategoryRows:l,topRows:w,topRowsLoading:T,topRowsLoaded:h,keyExpanded:_,categoryId_questionId_done:o,nodeOpening:j,nodeOpened:N,activeCategory:b,activeQuestion:L,formMode:A,loadingCategories:G,loadingCategory:F,loadingQuestions:R,loadingQuestion:k}=g,{searchQuestions:S,setLastRouteVisited:U,setChatBotDlgEnabled:D}=je(),{isDarkMode:P,chatBotDlgEnabled:I,lastRouteVisited:C}=ie(),[ee,te]=m.useState(!1),[Q,X]=m.useState({...Oe}),de=De(),Y=async z=>{de({type:s.SET_QUESTION_SELECTED,payload:{questionKey:z}})};let ce="";m.useEffect(()=>{(async()=>!T&&!h&&(console.log("ZOVEM 111 loadTopRows()"),await a()))()},[T,h,a]),m.useEffect(()=>{(async()=>{if(!j&&h&&w.length>0){if(t){if(t==="add_question"){const z=localStorage.getItem("New_Question");if(z){const oe=JSON.parse(z);return X({...Oe,categoryTitle:"Select",...oe}),te(!0),localStorage.removeItem("New_Question"),null}}else if(t!==o){const z=t.split("_"),oe=z[0],W=z[1],se={topId:"",id:oe,parentId:"ROOT"};console.log("zovem expandNodesUpToTheTree 1111111111111111111)",{categoryId_questionId:t},{categoryId_questionId_done:o}),await n(se,W!=="null"?W:null,i==="from_chat"),console.log("zavrsio expandNodeUpToTheTree 1111111111111111111 DONE)",{categoryId_questionId:t})}}else if(_&&!N){const{topId:z,categoryId:oe,questionId:W}=_;if(oe!==""){const se={topId:z,id:oe,parentId:"ROOT"};console.log("zovem expandNodeUpToTheTree 2222222222222)",{keyExpanded:_,catKey:se}),await n(se,W),console.log("zavrsio expandNodeUpToTheTree 2222222222222 DONE)")}}I||D()}})()},[t,o,h,_,j,N,n,i,I,D]);const K="/knowledge/categories";return m.useEffect(()=>{C!==K&&U(K)},[C,U]),t!=="add_question"&&t&&t!==o?(console.log("zzzzzz loading...",{keyExpanded:_,categoryId_questionId:t,categoryId_questionId_done:o}),e.jsx("div",{children:"loading..."})):h?(console.log("===>>> Categories !!!!!!!!!!!!!!!!!",b),e.jsxs(e.Fragment,{children:[e.jsxs(Qt,{children:[e.jsxs("h5",{className:"text-warning mx-auto w-75 fw-bold",children:[e.jsx("span",{className:"categories",children:"Categories / "}),e.jsx("span",{className:"questions",children:"Questions"})]}),e.jsx(Ee,{className:`${P?"dark":""}`,children:e.jsx(me,{children:e.jsx("div",{className:"d-flex justify-content-start align-items-center",children:e.jsx("div",{className:"w-75 my-1 questions",children:e.jsx(zt,{tekst:ce,onSelectQuestion:Y,allCategoryRows:l,searchQuestions:S})})})})}),e.jsx($,{variant:"secondary",size:"sm",type:"button",style:{padding:"1px 4px"},onClick:()=>u(null),children:"Add Category"}),e.jsxs(Ee,{className:"my-1 h-auto",children:[e.jsx(me,{xs:12,md:5,children:e.jsx("div",{className:"categories-border",style:{position:"relative"},children:e.jsx(lt,{categoryRow:{...Je,categoryRows:w},isExpanded:!0})})}),e.jsx(me,{xs:0,md:7,children:e.jsxs("div",{id:"div-details",className:"d-none d-md-block",children:[b&&A===E.ViewingCategory&&e.jsx(be,{inLine:!1}),b&&A===E.EditingCategory&&e.jsx(rt,{inLine:!1}),b&&A===E.AddingCategory&&e.jsx(it,{activeCategory:b}),L&&A===E.ViewingQuestion&&e.jsx(nt,{inLine:!1}),L&&A===E.EditingQuestion&&e.jsx(st,{inLine:!1}),L&&A===E.AddingQuestion&&e.jsx(Le,{})]})})]})]}),ee&&L&&e.jsx(lo,{show:ee,onHide:()=>{te(!1)},newQuestionRow:Q}),(G||R)&&e.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{position:"absolute",top:"40%",left:"20%"},children:e.jsx("div",{className:`spinner-border ${R?"question":"category"}-spinner`,role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Loading..."})})}),F&&e.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{position:"absolute",top:"50%",left:"50%"},children:e.jsx("div",{className:"spinner-border category-spinner",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Loading..."})})}),k&&e.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{position:"absolute",top:"50%",left:"50%"},children:e.jsx("div",{className:"spinner-border question-spinner",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Loading..."})})})]})):(console.log("===>>> Categories  VRATIO"),null)},Eo=()=>{let{categoryId_questionId:t,fromChatBotDlg:i}=bt();if(t&&t==="categories"&&(t=void 0),t){const g=t.split("_");console.assert(g.length===2,"expected 'categoryId_questionId'")}return e.jsx(Bt,{children:e.jsx(co,{categoryId_questionId:t,fromChatBotDlg:i})})};export{Eo as default};
//# sourceMappingURL=Categories-IqdPM-Cs.js.map
