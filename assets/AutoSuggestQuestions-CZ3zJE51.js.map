{"version":3,"file":"AutoSuggestQuestions-CZ3zJE51.js","sources":["../../src/categories/AutoSuggestQuestions.tsx"],"sourcesContent":["import React, { type JSX } from 'react';\r\nimport Autosuggest from 'react-autosuggest';\r\nimport AutosuggestHighlightMatch from \"autosuggest-highlight/match\";\r\nimport AutosuggestHighlightParse from \"autosuggest-highlight/parse\";\r\n\r\nimport { isMobile } from 'react-device-detect'\r\n\r\nimport { debounce, escapeRegexCharacters } from '@/common/utilities'\r\nimport './AutoSuggestQuestions.css'\r\nimport { type ICategoryRow, type IQuestionKey, type IQuestionRow, QuestionKey } from '@/categories/types';\r\n\r\n\r\ninterface ICatMy {\r\n\tid: string,\r\n\tparentCategoryUp: string,\r\n\tcategoryParentTitle: string,\r\n\tcategoryTitle: string,\r\n\tquestionRows: IQuestionRow[]\r\n}\r\n\r\ninterface ICatSection {\r\n\tid: string | null,\r\n\tcategoryTitle: string,\r\n\tparentCategoryUp: string,\r\n\tcategoryParentTitle: string, // TODO ???\r\n\tquestionRows: IQuestionRow[]\r\n}\r\n\r\n// https://developer.mozilla.org/en/docs/Web/JavaScript/Guide/Regular_Expression\r\n// s#Using_Special_Characters\r\n// function escapeRegexCharacters(str: string): string {\r\n// \treturn str.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');\r\n// }\r\n\r\n// autoFocus does the job\r\n//let inputAutosuggest = createRef<HTMLInputElement>();\r\n// interface ICatIdTitle {\r\n// \tid: string;\r\n// \ttitle: string;\r\n// }\r\n\r\nconst QuestionAutosuggestMulti = Autosuggest as { new(): Autosuggest<IQuestionRow, ICatMy> };\r\n\r\nexport class AutoSuggestQuestions extends React.Component<{\r\n\ttekst: string | undefined,\r\n\tonSelectQuestion: (questionKey: IQuestionKey, underFilter: string) => void,\r\n\tallCategoryRows: Map<string, ICategoryRow>,\r\n\tsearchQuestions: (filter: string, count: number) => Promise<IQuestionRow[]>\r\n}, any> {\r\n\t// region Fields\r\n\tstate: any;\r\n\tisMob: boolean;\r\n\tallCategoryRows: Map<string, ICategoryRow>;\r\n\tsearchQuestions: (filter: string, count: number) => Promise<IQuestionRow[]>;\r\n\tdebouncedLoadSuggestions: (value: string) => void;\r\n\t//inputAutosuggest: React.RefObject<HTMLInputElement>;\r\n\t// endregion region Constructor\r\n\tconstructor(props: any) {\r\n\t\tconsole.log(\"AutoSuggestQuestions CONSTRUCTOR\")\r\n\t\tsuper(props);\r\n\t\tthis.state = {\r\n\t\t\tvalue: props.tekst || '',\r\n\t\t\tsuggestions: [], //this.getSuggestions(''),\r\n\t\t\tnoSuggestions: false,\r\n\t\t\thighlighted: ''\r\n\t\t};\r\n\t\t//this.inputAutosuggest = createRef<HTMLInputElement>();\r\n\t\tthis.allCategoryRows = props.allCategoryRows;\r\n\t\tthis.searchQuestions = props.searchQuestions;\r\n\t\tthis.isMob = isMobile;\r\n\t\tthis.loadSuggestions = this.loadSuggestions.bind(this);\r\n\t\tthis.debouncedLoadSuggestions = debounce(this.loadSuggestions, 300);\r\n\t}\r\n\r\n\r\n\tasync loadSuggestions(value: string) {\r\n\t\tthis.setState({\r\n\t\t\tisLoading: true\r\n\t\t});\r\n\r\n\t\tconsole.time();\r\n\t\tconst suggestions = await this.getSuggestions(value);\r\n\t\tconsole.timeEnd();\r\n\r\n\t\tif (value === this.state.value) {\r\n\t\t\tthis.setState({\r\n\t\t\t\tisLoading: false,\r\n\t\t\t\tsuggestions,\r\n\t\t\t\tnoSuggestions: suggestions.length === 0\r\n\t\t\t});\r\n\t\t}\r\n\t\telse { // Ignore suggestions if input value changed\r\n\t\t\tthis.setState({\r\n\t\t\t\tisLoading: false\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tcomponentDidMount() {\r\n\t\tsetTimeout(() => {\r\n\t\t\twindow.focus()\r\n\t\t\t// inputAutosuggest!.current!.focus();\r\n\t\t}, 300)\r\n\t}\r\n\r\n\t// endregion region Rendering methods\r\n\trender(): JSX.Element {\r\n\t\tconst { value, suggestions, noSuggestions } = this.state;\r\n\r\n\t\treturn <div>\r\n\t\t\t<QuestionAutosuggestMulti\r\n\t\t\t\tonSuggestionsClearRequested={this.onSuggestionsClearRequested}  // (sl) added\r\n\t\t\t\tmultiSection={true}\r\n\t\t\t\tsuggestions={suggestions}\r\n\t\t\t\tonSuggestionsFetchRequested={this.onSuggestionsFetchRequested.bind(this)}\r\n\t\t\t\tonSuggestionSelected={this.onSuggestionSelected.bind(this)}\r\n\t\t\t\tgetSuggestionValue={this.getSuggestionValue}\r\n\t\t\t\trenderSuggestion={this.renderSuggestion}\r\n\t\t\t\trenderSectionTitle={this.renderSectionTitle}\r\n\t\t\t\tgetSectionSuggestions={this.getSectionSuggestions}\r\n\t\t\t\t// onSuggestionHighlighted={this.onSuggestionHighlighted} (sl)\r\n\t\t\t\tonSuggestionHighlighted={this.onSuggestionHighlighted.bind(this)}\r\n\t\t\t\thighlightFirstSuggestion={false}\r\n\t\t\t\trenderInputComponent={this.renderInputComponent}\r\n\t\t\t\t// renderSuggestionsContainer={this.renderSuggestionsContainer}\r\n\t\t\t\tfocusInputOnSuggestionClick={!this.isMob}\r\n\t\t\t\tinputProps={{\r\n\t\t\t\t\tplaceholder: `Type 'remote'`,\r\n\t\t\t\t\tvalue,\r\n\t\t\t\t\tonChange: (e, changeEvent) => this.onChange(e, changeEvent),\r\n\t\t\t\t\tautoFocus: true\r\n\t\t\t\t}}\r\n\t\t\t/>\r\n\t\t\t{noSuggestions &&\r\n\t\t\t\t<div className=\"no-suggestions\">\r\n\t\t\t\t\tNo questions to suggest\r\n\t\t\t\t</div>\r\n\t\t\t}\r\n\t\t</div>\r\n\t}\r\n\r\n\r\n\t// private satisfyingCategories = (searchWords: string[]): ICatIdTitle[] => {\r\n\t// \tconst arr: ICatIdTitle[] = [];\r\n\t// \tsearchWords.filter(w => w.length >= 3).forEach(w => {\r\n\t// \t\tthis.allCategoryRows.forEach(async cat => {\r\n\t// \t\t\t//const parentId = cat.id;\r\n\t// \t\t\t//let j = 0;\r\n\t// \t\t\t// cat.words.forEach(catw => {\r\n\t// \t\t\t// \tif (catw.includes(w)) {\r\n\t// \t\t\t// \t\tconsole.log(\"Add all questions of category\")\r\n\t// \t\t\t// \t\tarr.push({ id: cat.id, title: cat.title })\r\n\t// \t\t\t// \t}\r\n\t// \t\t\t// })\r\n\t// \t\t})\r\n\t// \t})\r\n\t// \treturn arr;\r\n\t// }\r\n\r\n\tprotected async getSuggestions(search: string): Promise<ICatSection[]> {\r\n\t\tconst escapedValue = escapeRegexCharacters(search.trim());\r\n\t\tif (escapedValue === '') {\r\n\t\t\treturn [];\r\n\t\t}\r\n\t\tif (search.length < 3)\r\n\t\t\treturn [];\r\n\t\tconst catSection = new Map<string | null, IQuestionRow[]>();\r\n\t\tconst questionKeys: IQuestionKey[] = [];\r\n\t\ttry {\r\n\t\t\tconsole.log('--------->>>>> getSuggestions')\r\n\t\t\tvar questionRows: IQuestionRow[] = await this.searchQuestions(escapedValue, 10);\r\n\t\t\tquestionRows.forEach((questionRow: IQuestionRow) => {\r\n\t\t\t\tconst { topId, parentId, id, title, numOfAssignedAnswers, included } = questionRow;\r\n\t\t\t\tconst questionKey = new QuestionKey(questionRow).questionKey!;\r\n\t\t\t\tif (!questionKeys.includes(questionKey)) {\r\n\t\t\t\t\tquestionKeys.push(questionKey);\r\n\r\n\t\t\t\t\t// 2) Group questions by parentId\r\n\t\t\t\t\tconst row: IQuestionRow = {\r\n\t\t\t\t\t\ttopId,\r\n\t\t\t\t\t\tparentId,\r\n\t\t\t\t\t\tid,\r\n\t\t\t\t\t\tnumOfAssignedAnswers,\r\n\t\t\t\t\t\ttitle,\r\n\t\t\t\t\t\tcategoryTitle: '',\r\n\t\t\t\t\t\tincluded\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (!catSection.has(parentId)) {\r\n\t\t\t\t\t\tcatSection.set(parentId, [row]);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tcatSection.get(parentId)!.push(row);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t}\r\n\t\tcatch (error: any) {\r\n\t\t\tconsole.debug(error)\r\n\t\t};\r\n\r\n\t\t////////////////////////////////////////////////////////////////////////////////\r\n\t\t// Search for Categories title words, and add all the questions of the Category\r\n\t\t/*\r\n\t\tif (questionKeys.length === 0) {\r\n\t\t\ttry {\r\n\t\t\t\tconst tx = this.dbp!.transaction('Questions')\r\n\t\t\t\tconst index = tx.store.index('parentCategory_idx');\r\n\t\t\t\tconst catIdTitles = this.satisfyingCategories(searchWords)\r\n\t\t\t\tlet i = 0;\r\n\t\t\t\twhile (i < catIdTitles.length) {\r\n\t\t\t\t\tconst catIdTitle = catIdTitles[i];\r\n\t\t\t\t\tconst parentId = catIdTitle.id;\r\n\t\t\t\t\tfor await (const cursor of index.iterate(parentId)) {\r\n\t\t\t\t\t\tconst q: IQuestion = cursor.value;\r\n\t\t\t\t\t\tconst { id, title } = q;\r\n\t\t\t\t\t\t//if (!questionRows.includes(id!))\r\n\t\t\t\t\t\t//\tquestionRows.push(id!);\r\n\r\n\t\t\t\t\t\tconst questionKey = { parentId, id }\r\n\t\t\t\t\t\tif (!questionKeys.includes(questionKey)) {\r\n\t\t\t\t\t\t\tquestionKeys.push(questionKey);\r\n\r\n\t\t\t\t\t\t\t//console.log(q);\r\n\t\t\t\t\t\t\t// 2) Group questions by parentId\r\n\t\t\t\t\t\t\tconst quest: IQuestionRow = {\r\n\t\t\t\t\t\t\t\tid,\r\n\t\t\t\t\t\t\t\tparentId,\r\n\t\t\t\t\t\t\t\ttitle,\r\n\t\t\t\t\t\t\t\tcategoryTitle: catIdTitle.title\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (!catQuests.has(parentId)) {\r\n\t\t\t\t\t\t\t\tcatQuests.set(parentId, [quest]);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\tcatQuests.get(parentId)!.push(quest);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tawait tx.done;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tcatch (error: any) {\r\n\t\t\t\tconsole.debug(error)\r\n\t\t\t};\r\n\t\t}\r\n\t\tawait tx.done;\r\n\t\t*/\r\n\r\n\t\tif (questionKeys.length === 0)\r\n\t\t\treturn [];\r\n\r\n\t\ttry {\r\n\t\t\t////////////////////////////////////////////////////////////\r\n\t\t\t// map\r\n\t\t\t// 0 = {'DALJINSKI' => IQuestionRow[2]}\r\n\t\t\t// 1 = {'EDGE2' => IQuestionRow[3]}\r\n\t\t\t// 2 = {'EDGE3' => IQuestionRow[4]}4\r\n\r\n\t\t\t////////////////////////////////////////////////////////////\r\n\t\t\t// \r\n\t\t\tlet catSections: ICatSection[] = [];\r\n\t\t\tcatSection.forEach((quests, id) => {\r\n\t\t\t\t//let variationsss: string[] = [];\r\n\t\t\t\tconst catSection: ICatSection = {\r\n\t\t\t\t\tid,\r\n\t\t\t\t\tcategoryTitle: '',\r\n\t\t\t\t\tcategoryParentTitle: 'kuro',\r\n\t\t\t\t\tparentCategoryUp: '',\r\n\t\t\t\t\tquestionRows: []\r\n\t\t\t\t};\r\n\t\t\t\tif (id !== null) {\r\n\t\t\t\t\tconst cat = this.allCategoryRows.get(id);\r\n\t\t\t\t\tif (cat) {\r\n\t\t\t\t\t\tconst { title, titlesUpTheTree/*, variations*/ } = cat!;\r\n\t\t\t\t\t\tcatSection.categoryTitle = title;\r\n\t\t\t\t\t\tcatSection.parentCategoryUp = titlesUpTheTree!;\r\n\t\t\t\t\t\t//variationsss = variations;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\talert(`${id} Not found in allCats`)\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t}\r\n\t\t\t\t// const catSection: ICatSection = {\r\n\t\t\t\t// \tid: id,\r\n\t\t\t\t// \tcategoryTitle: title,\r\n\t\t\t\t// \tcategoryParentTitle: 'kuro',\r\n\t\t\t\t// \tparentCategoryUp: titlesUpTheTree!,\r\n\t\t\t\t// \tquestionRows: []\r\n\t\t\t\t// };\r\n\t\t\t\tquests.forEach(quest => {\r\n\t\t\t\t\t// console.log(quest);\r\n\t\t\t\t\t/*\r\n\t\t\t\t\tif (variationsss.length > 0) {\r\n\t\t\t\t\t\tlet wordsIncludesTag = false;\r\n\t\t\t\t\t\t// searchWords.forEach(w => {\r\n\t\t\t\t\t\t// \tvariationsss.forEach(variation => {\r\n\t\t\t\t\t\t// \t\tif (variation === w.toUpperCase()) {\r\n\t\t\t\t\t\t// \t\t\twordsIncludesTag = true;\r\n\t\t\t\t\t\t// \t\t\tcatSection.quests.push({ ...quest, title: quest.title + ' ' + variation });\r\n\t\t\t\t\t\t// \t\t}\r\n\t\t\t\t\t\t// \t})\r\n\t\t\t\t\t\t// })\r\n\t\t\t\t\t\tif (!wordsIncludesTag) {\r\n\t\t\t\t\t\t\t// variationsss.forEach(variation => {\r\n\t\t\t\t\t\t\t// \t// console.log(quest);\r\n\t\t\t\t\t\t\t// \tcatSection.questionRows.push({ ...quest, title: quest.title + ' ' + variation });\r\n\t\t\t\t\t\t\t// });\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t*/\r\n\t\t\t\t\tcatSection.questionRows.push(quest);\r\n\t\t\t\t\t/*}*/\r\n\t\t\t\t});\r\n\t\t\t\tcatSections.push(catSection);\r\n\t\t\t\t//console.log(catSections)\r\n\t\t\t});\r\n\t\t\treturn catSections;\r\n\t\t}\r\n\t\tcatch (error: any) {\r\n\t\t\tconsole.log(error)\r\n\t\t};\r\n\t\treturn [];\r\n\t}\r\n\r\n\r\n\tprotected onSuggestionsClearRequested = () => {\r\n\t\tthis.setState({\r\n\t\t\tsuggestions: [],\r\n\t\t\tnoSuggestions: false\r\n\t\t});\r\n\t};\r\n\r\n\tprotected onSuggestionSelected(event: React.FormEvent<any>, data: Autosuggest.SuggestionSelectedEventData<IQuestionRow>): void {\r\n\t\tevent.preventDefault(); // ?\r\n\t\tconst question: IQuestionRow = data.suggestion;\r\n\t\tconst { topId, parentId, id } = question;\r\n\t\t// alert(`Selected question is ${question.questionId} (${question.text}).`);\r\n\t\tthis.props.onSelectQuestion({ topId, parentId, id }, this.state.value);\r\n\t}\r\n\r\n\t/*\r\n\tprotected renderSuggestion(suggestion: Question, params: Autosuggest.RenderSuggestionParams): JSX.Element {\r\n\t\t const className = params.isHighlighted ? \"highlighted\" : undefined;\r\n\t\t return <span className={className}>{suggestion.name}</span>;\r\n\t}\r\n\t*/\r\n\r\n\t// TODO bac ovo u external css   style={{ textAlign: 'left'}}\r\n\tprotected renderSuggestion(suggestion: IQuestionRow, params: Autosuggest.RenderSuggestionParams): JSX.Element {\r\n\t\t// const className = params.isHighlighted ? \"highlighted\" : undefined;\r\n\t\t//return <span className={className}>{suggestion.name}</span>;\r\n\t\tconst matches = AutosuggestHighlightMatch(suggestion.title, params.query);\r\n\t\tconst parts = AutosuggestHighlightParse(suggestion.title, matches);\r\n\t\treturn (\r\n\t\t\t<span className=\"d-inline-block text-truncate\" style={{ textAlign: 'left' }}>\r\n\t\t\t\t{parts.map((part, index) => {\r\n\t\t\t\t\tconst cls = part.highlight ? 'react-autosuggest__suggestion-match' : undefined;\r\n\t\t\t\t\treturn (\r\n\t\t\t\t\t\t<span key={index} className={`${cls ?? ''}`}>\r\n\t\t\t\t\t\t\t{part.text}\r\n\t\t\t\t\t\t</span>\r\n\t\t\t\t\t);\r\n\t\t\t\t})}\r\n\t\t\t</span>\r\n\t\t);\r\n\t}\r\n\r\n\tprotected renderSectionTitle(section: ICatMy): JSX.Element {\r\n\t\tconst { parentCategoryUp } = section; // , categoryParentTitle, categoryTitle\r\n\t\t// let str = (categoryParentTitle ? (categoryParentTitle + \" / \") : \"\") + categoryTitle;\r\n\t\t// if (parentCategoryUp)\r\n\t\t// \tstr = \" ... / \" + str;\r\n\t\treturn <span>{parentCategoryUp}</span>\r\n\t\t// <strong>\r\n\t\t//{parentCategoryUp}\r\n\t\t// </strong>;\r\n\t}\r\n\r\n\t// protected renderInputComponent(inputProps: Autosuggest.InputProps<IQuestionShort>): JSX.Element {\r\n\t// \t const { onChange, onBlur, ...restInputProps } = inputProps;\r\n\t// \t return (\r\n\t// \t\t  <div>\r\n\t// \t\t\t\t<input {...restInputProps} />\r\n\t// \t\t  </div>\r\n\t// \t );\r\n\t// }\r\n\r\n\tprotected renderInputComponent(inputProps: Autosuggest.RenderInputComponentProps): JSX.Element {\r\n\t\tconst { ref, ...restInputProps } = inputProps;\r\n\t\t// if (ref !== undefined)\r\n\t\t// \tthis.inputAutosuggest = ref as React.RefObject<HTMLInputElement>;\r\n\r\n\t\treturn (\r\n\t\t\t<div>\r\n\t\t\t\t{/* <input {...restInputProps} ref={inputAutosuggest} /> */}\r\n\t\t\t\t<input ref={ref} autoFocus {...restInputProps} />\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n\r\n\t// const Input = forwardRef<HTMLInputElement, Omit<InputProps, \"ref\">>(\r\n\t// \t(props: Omit<InputProps, \"ref\">, ref): JSX.Element => (\r\n\t// \t  <input {...props} ref={ref} />\r\n\t// \t)\r\n\t//   );\r\n\r\n\t// protected renderSuggestionsContainer({ containerProps, children, query }:\r\n\t// \tAutosuggest.RenderSuggestionsContainerParams): JSX.Element {\r\n\t// \treturn (\r\n\t// \t\t<div {...containerProps}>\r\n\t// \t\t\t<span>{children}</span>\r\n\t// \t\t</div>\r\n\t// \t);\r\n\t// }\r\n\t// endregion region Event handlers\r\n\r\n\r\n\r\n\tprotected onChange(event: /*React.ChangeEvent<HTMLInputElement>*/ React.FormEvent<any>, { newValue }: Autosuggest.ChangeEvent): void {\r\n\t\tevent.preventDefault(); // ?\r\n\t\tthis.setState({ value: newValue });\r\n\t}\r\n\r\n\t// getParentTitle = async (id: string): Promise<any> => {\r\n\t// \tlet category = await this.dbp.get('Categories', id);\r\n\t// \treturn { parentCategoryTitle: category.title, parentCategoryUp: '' };\r\n\t// }\r\n\r\n\tprotected async onSuggestionsFetchRequested({ value }: any): Promise<void> {\r\n\t\treturn /*await*/ this.debouncedLoadSuggestions(value);\r\n\t}\r\n\r\n\t// private anyWord = (valueWordRegex: RegExp[], questionWords: string[]): boolean => {\r\n\t// \tfor (let valWordRegex of valueWordRegex)\r\n\t// \t\tfor (let questionWord of questionWords)\r\n\t// \t\t\tif (valWordRegex.test(questionWord))\r\n\t// \t\t\t\treturn true;\r\n\t// \treturn false;\r\n\t// }\r\n\r\n\t////////////////////////////////////\r\n\t// endregion region Helper methods\r\n\r\n\tprotected getSuggestionValue(suggestion: IQuestionRow) {\r\n\t\treturn suggestion.title;\r\n\t}\r\n\r\n\tprotected getSectionSuggestions(section: ICatMy) {\r\n\t\treturn section.questionRows;\r\n\t}\r\n\r\n\tprotected onSuggestionHighlighted(params: Autosuggest.SuggestionHighlightedParams): void {\r\n\t\tthis.setState({\r\n\t\t\thighlighted: params.suggestion\r\n\t\t});\r\n\t}\r\n\t// endregion\r\n}"],"names":["QuestionAutosuggestMulti","Autosuggest","AutoSuggestQuestions","React","props","isMobile","debounce","value","suggestions","noSuggestions","jsx","e","changeEvent","search","escapedValue","escapeRegexCharacters","catSection","questionKeys","questionRows","questionRow","topId","parentId","id","title","numOfAssignedAnswers","included","questionKey","QuestionKey","row","error","catSections","quests","cat","titlesUpTheTree","quest","event","data","question","suggestion","params","matches","AutosuggestHighlightMatch","parts","AutosuggestHighlightParse","part","index","cls","section","parentCategoryUp","inputProps","ref","restInputProps","newValue"],"mappings":"gIAyCA,MAAMA,EAA2BC,EAE1B,MAAMC,UAA6BC,EAAM,SAKxC,CAEP,MACA,MACA,gBACA,gBACA,yBAGA,YAAYC,EAAY,CACvB,QAAQ,IAAI,kCAAkC,EAC9C,MAAMA,CAAK,EACX,KAAK,MAAQ,CACZ,MAAOA,EAAM,OAAS,GACtB,YAAa,CAAA,EACb,cAAe,GACf,YAAa,EAAA,EAGd,KAAK,gBAAkBA,EAAM,gBAC7B,KAAK,gBAAkBA,EAAM,gBAC7B,KAAK,MAAQC,EAAAA,SACb,KAAK,gBAAkB,KAAK,gBAAgB,KAAK,IAAI,EACrD,KAAK,yBAA2BC,EAAS,KAAK,gBAAiB,GAAG,CACnE,CAGA,MAAM,gBAAgBC,EAAe,CACpC,KAAK,SAAS,CACb,UAAW,EAAA,CACX,EAED,QAAQ,KAAA,EACR,MAAMC,EAAc,MAAM,KAAK,eAAeD,CAAK,EACnD,QAAQ,QAAA,EAEJA,IAAU,KAAK,MAAM,MACxB,KAAK,SAAS,CACb,UAAW,GACX,YAAAC,EACA,cAAeA,EAAY,SAAW,CAAA,CACtC,EAGD,KAAK,SAAS,CACb,UAAW,EAAA,CACX,CAEH,CAEA,mBAAoB,CACnB,WAAW,IAAM,CAChB,OAAO,MAAA,CAER,EAAG,GAAG,CACP,CAGA,QAAsB,CACrB,KAAM,CAAE,MAAAD,EAAO,YAAAC,EAAa,cAAAC,CAAA,EAAkB,KAAK,MAEnD,cAAQ,MAAA,CACP,SAAA,CAAAC,EAAAA,IAACV,EAAA,CACA,4BAA6B,KAAK,4BAClC,aAAc,GACd,YAAAQ,EACA,4BAA6B,KAAK,4BAA4B,KAAK,IAAI,EACvE,qBAAsB,KAAK,qBAAqB,KAAK,IAAI,EACzD,mBAAoB,KAAK,mBACzB,iBAAkB,KAAK,iBACvB,mBAAoB,KAAK,mBACzB,sBAAuB,KAAK,sBAE5B,wBAAyB,KAAK,wBAAwB,KAAK,IAAI,EAC/D,yBAA0B,GAC1B,qBAAsB,KAAK,qBAE3B,4BAA6B,CAAC,KAAK,MACnC,WAAY,CACX,YAAa,gBACb,MAAAD,EACA,SAAU,CAACI,EAAGC,IAAgB,KAAK,SAASD,EAAGC,CAAW,EAC1D,UAAW,EAAA,CACZ,CAAA,EAEAH,GACAC,EAAAA,IAAC,MAAA,CAAI,UAAU,iBAAiB,SAAA,yBAAA,CAEhC,CAAA,EAEF,CACD,CAoBA,MAAgB,eAAeG,EAAwC,CACtE,MAAMC,EAAeC,EAAsBF,EAAO,KAAA,CAAM,EACxD,GAAIC,IAAiB,GACpB,MAAO,CAAA,EAER,GAAID,EAAO,OAAS,EACnB,MAAO,CAAA,EACR,MAAMG,MAAiB,IACjBC,EAA+B,CAAA,EACrC,GAAI,CACH,QAAQ,IAAI,+BAA+B,EAC3C,IAAIC,EAA+B,MAAM,KAAK,gBAAgBJ,EAAc,EAAE,EAC9EI,EAAa,QAASC,GAA8B,CACnD,KAAM,CAAE,MAAAC,EAAO,SAAAC,EAAU,GAAAC,EAAI,MAAAC,EAAO,qBAAAC,EAAsB,SAAAC,GAAaN,EACjEO,EAAc,IAAIC,EAAYR,CAAW,EAAE,YACjD,GAAI,CAACF,EAAa,SAASS,CAAW,EAAG,CACxCT,EAAa,KAAKS,CAAW,EAG7B,MAAME,EAAoB,CACzB,MAAAR,EACA,SAAAC,EACA,GAAAC,EACA,qBAAAE,EACA,MAAAD,EACA,cAAe,GACf,SAAAE,CAAA,EAEIT,EAAW,IAAIK,CAAQ,EAI3BL,EAAW,IAAIK,CAAQ,EAAG,KAAKO,CAAG,EAHlCZ,EAAW,IAAIK,EAAU,CAACO,CAAG,CAAC,CAKhC,CACD,CAAC,CACF,OACOC,EAAY,CAClB,QAAQ,MAAMA,CAAK,CACpB,CAkDA,GAAIZ,EAAa,SAAW,EAC3B,MAAO,CAAA,EAER,GAAI,CASH,IAAIa,EAA6B,CAAA,EACjC,OAAAd,EAAW,QAAQ,CAACe,EAAQT,IAAO,CAElC,MAAMN,EAA0B,CAC/B,GAAAM,EACA,cAAe,GACf,oBAAqB,OACrB,iBAAkB,GAClB,aAAc,CAAA,CAAC,EAEhB,GAAIA,IAAO,KAAM,CAChB,MAAMU,EAAM,KAAK,gBAAgB,IAAIV,CAAE,EACvC,GAAIU,EAAK,CACR,KAAM,CAAE,MAAAT,EAAO,gBAAAU,CAAA,EAAoCD,EACnDhB,EAAW,cAAgBO,EAC3BP,EAAW,iBAAmBiB,CAE/B,MAEC,MAAM,GAAGX,CAAE,uBAAuB,CAEpC,CAUAS,EAAO,QAAQG,GAAS,CAsBvBlB,EAAW,aAAa,KAAKkB,CAAK,CAEnC,CAAC,EACDJ,EAAY,KAAKd,CAAU,CAE5B,CAAC,EACMc,CACR,OACOD,EAAY,CAClB,QAAQ,IAAIA,CAAK,CAClB,CACA,MAAO,CAAA,CACR,CAGU,4BAA8B,IAAM,CAC7C,KAAK,SAAS,CACb,YAAa,CAAA,EACb,cAAe,EAAA,CACf,CACF,EAEU,qBAAqBM,EAA6BC,EAAmE,CAC9HD,EAAM,eAAA,EACN,MAAME,EAAyBD,EAAK,WAC9B,CAAE,MAAAhB,EAAO,SAAAC,EAAU,GAAAC,CAAA,EAAOe,EAEhC,KAAK,MAAM,iBAAiB,CAAE,MAAAjB,EAAO,SAAAC,EAAU,GAAAC,GAAM,KAAK,MAAM,KAAK,CACtE,CAUU,iBAAiBgB,EAA0BC,EAAyD,CAG7G,MAAMC,EAAUC,EAA0BH,EAAW,MAAOC,EAAO,KAAK,EAClEG,EAAQC,EAA0BL,EAAW,MAAOE,CAAO,EACjE,OACC9B,EAAAA,IAAC,OAAA,CAAK,UAAU,+BAA+B,MAAO,CAAE,UAAW,MAAA,EACjE,SAAAgC,EAAM,IAAI,CAACE,EAAMC,IAAU,CAC3B,MAAMC,EAAMF,EAAK,UAAY,sCAAwC,OACrE,OACClC,EAAAA,IAAC,QAAiB,UAAW,GAAGoC,GAAO,EAAE,GACvC,SAAAF,EAAK,IAAA,EADIC,CAEX,CAEF,CAAC,CAAA,CACF,CAEF,CAEU,mBAAmBE,EAA8B,CAC1D,KAAM,CAAE,iBAAAC,GAAqBD,EAI7B,OAAOrC,EAAAA,IAAC,QAAM,SAAAsC,CAAA,CAAiB,CAIhC,CAWU,qBAAqBC,EAAgE,CAC9F,KAAM,CAAE,IAAAC,EAAK,GAAGC,CAAA,EAAmBF,EAInC,OACCvC,EAAAA,IAAC,OAEA,SAAAA,EAAAA,IAAC,QAAA,CAAM,IAAAwC,EAAU,UAAS,GAAE,GAAGC,CAAA,CAAgB,CAAA,CAChD,CAEF,CAoBU,SAAShB,EAAqE,CAAE,SAAAiB,GAA2C,CACpIjB,EAAM,eAAA,EACN,KAAK,SAAS,CAAE,MAAOiB,CAAA,CAAU,CAClC,CAOA,MAAgB,4BAA4B,CAAE,MAAA7C,GAA6B,CAC1E,OAAiB,KAAK,yBAAyBA,CAAK,CACrD,CAaU,mBAAmB+B,EAA0B,CACtD,OAAOA,EAAW,KACnB,CAEU,sBAAsBS,EAAiB,CAChD,OAAOA,EAAQ,YAChB,CAEU,wBAAwBR,EAAuD,CACxF,KAAK,SAAS,CACb,YAAaA,EAAO,UAAA,CACpB,CACF,CAED"}