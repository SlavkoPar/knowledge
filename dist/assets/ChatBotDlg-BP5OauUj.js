const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/AutoSuggestQuestions-BACKsPf7.js","assets/index-CuxjKTJ_.js","assets/index-i_Noyz8o.css","assets/lib-CcS-psvA.js","assets/AutoSuggestQuestions-DN6HBK-e.css"])))=>i.map(i=>d[i]);
import{r as a,K as le,d as ce,e as de,_ as ue,j as e,aw as y,C as xe,B as C,ax as we,J as he,y as B}from"./index-CuxjKTJ_.js";import{R as _,C as q}from"./App-BbS5zoGd.js";class K{constructor(x){const{topId:w,id:g,answerTitle:f,answerLink:p}=x;this.chatBotAnswer={topId:w,id:g,answerTitle:f??"",answerLink:p??"",created:x.created,modified:x.modified}}chatBotAnswer}const me=()=>{const[u,x]=a.useState(null),[w,g]=a.useState(0),f=async i=>{x(i);let l=!1,c=null;if(i){const{assignedAnswers:h}=i;if(h&&h.length>0){const A=h[0];c=new K(A).chatBotAnswer,l=h.length>1,g(0)}}return{firstChatBotAnswer:c,hasMoreAnswers:l}},p=a.useCallback(async()=>u,[u]),b=a.useCallback(async()=>{const{assignedAnswers:i}=u,l=i.length,c=w+1;return w+1<l?(g(c),{nextChatBotAnswer:new K(i[c]).chatBotAnswer,hasMoreAnswers:c+1<l}):{nextChatBotAnswer:null,hasMoreAnswers:!1}},[u,w]);return[f,p,b]},pe=({show:u,onHide:x})=>{let{tekst:w}=le();const[g,f]=a.useState(w),[p,b,i]=me(),[l,c]=a.useState(null),[h,A]=a.useState(1),[F,Q]=a.useState(!1),[t,N]=a.useState(null),[G,S]=a.useState(!1),{getSubCats:O,getQuestion:U,addHistory:I,addHistoryFilter:H,searchQuestions:z}=ce(),{authUser:k,isDarkMode:V,allCategoryRowsGlobal:P,allCategoryRowsGlobalLoaded:W}=de(),[J]=a.useState(!0),[D,E]=a.useState(!0),[$,M]=a.useState([]),[X,j]=a.useState([]);let L;(s=>{s[s.AUTO_SUGGEST=0]="AUTO_SUGGEST",s[s.QUESTION=1]="QUESTION",s[s.ANSWER=2]="ANSWER"})(L||(L={}));const Y=async()=>{M([]);const s="MTS",r=await O(s),{subCats:n,parentHeader:d}=r;M(o=>[...o,{level:1,catId:s,header:d,subCats:n,subCatIdSelected:null}]),console.log($)},Z=a.useRef(null),ee=a.lazy(()=>ue(()=>import("./AutoSuggestQuestions-BACKsPf7.js"),__vite__mapDeps([0,1,2,3,4])).then(s=>({default:s.AutoSuggestQuestions})));if(!W)return e.jsx("div",{children:"cats not loaded..."});const se=async(s,r)=>{const n=await b();if(n){console.log({questionCurr:n});const m={questionKey:new B(n).questionKey,filter:r,created:{time:new Date,nickName:k.nickName}};await H(m)}if(t){const m={type:2,isDisabled:!0,txt:t.answerTitle,link:t.answerLink};j(v=>[...v,m])}const d=await U(s),{question:o}=d;if(!o)return;o.numOfRelatedFilters>0&&f(o.relatedFilters[0].filter);const re=await p(o);let{firstChatBotAnswer:oe,hasMoreAnswers:ie}=re;if(o){const m={type:1,isDisabled:!0,txt:o.title,link:null};j(v=>[...v,m])}A(m=>m+1),E(!1),c(o),Q(!0),S(ie),N(oe)},te=async()=>{const s={type:2,isDisabled:!0,txt:t?t.answerTitle:"no answer title",link:t?t.answerLink:"no answer link",hasMoreAnswers:!0};j(n=>[...n,s]);const r={questionKey:new B(l).questionKey,assignedAnswerKey:{topId:t.topId,id:t.id},userAction:"Fixed",created:{nickName:k.nickName,time:new Date}};I(r),S(!1),N(t),Q(!1)},ne=async()=>{const s={type:2,isDisabled:!0,txt:t?t.answerTitle:"no answer",link:t?t.answerLink:"no link",hasMoreAnswers:!0};j(o=>[...o,s]);const r=await i(),{nextChatBotAnswer:n,hasMoreAnswers:d}=r;if(t){const o={questionKey:new B(l).questionKey,assignedAnswerKey:{topId:t.topId,id:t.id},userAction:n?"NotFixed":"NotClicked",created:{nickName:k.nickName,time:new Date}};I(o)}S(d),console.log("----->>>>",{nextChatBotAnswer:n}),N(n)},ae=s=>{const{txt:r}=s;return e.jsx("div",{id:h.toString(),className:"d-flex flex-row mx-0 justify-content-start align-items-center",children:e.jsxs("div",{className:"d-flex flex-row mx-0 justify-content-start align-items-center",children:[e.jsx("img",{width:"22",height:"18",src:he,alt:"Question",className:"ms-1"}),e.jsx("div",{className:"p-1 bg-warning text-light flex-wrap text-wrap border rounded-1",children:r})]})})},R=s=>{console.log("--------------------------------------AnswerComponent",s);const{isDisabled:r,txt:n,link:d}=s;return e.jsx("div",{id:t?.id,className:`${V?"dark":"light"} mt-1 mx-1 border border-0 rounded-1`,children:e.jsxs("div",{className:"d-flex flex-row mx-0 justify-content-start align-items-center",children:[e.jsxs("div",{className:"d-flex flex-row mx-0 justify-content-start align-items-center",children:[e.jsx("img",{width:"22",height:"18",src:we,alt:"Answer",className:"ms-1"}),d?e.jsx("div",{className:"p-1 bg-info text-light flex-wrap text-wrap border rounded-1 ",children:e.jsx("a",{href:d,rel:"noopener noreferrer",target:"_blank",className:"text-light text-decoration-underline",children:n})}):e.jsx("div",{className:"p-1 bg-info text-light flex-wrap text-wrap border rounded-1",children:n})]}),!r&&t&&e.jsxs("div",{children:[e.jsx(C,{size:"sm",type:"button",onClick:te,disabled:!t,className:"align-middle ms-1 px-1  py-0",variant:"success",children:"Fixed"}),e.jsx(C,{size:"sm",type:"button",onClick:ne,disabled:!t,className:"align-middle ms-1 border border-1 rounded-1 px-1 py-0",variant:"danger",children:"Not fixed"})]})]})})},T=s=>{const{isDisabled:r,txt:n}=s;return e.jsxs("div",{className:"dark",children:[e.jsx("label",{className:"text-warning",children:"Please enter the Question"}),e.jsx("div",{className:"text-start",children:e.jsxs("div",{className:"questions",children:[r&&e.jsx("div",{children:n}),!r&&e.jsx(a.Suspense,{fallback:e.jsx("div",{children:"Loading..."}),children:e.jsx(ee,{tekst:n,onSelectQuestion:se,allCategoryRows:P,searchQuestions:z})})]})})]})};return console.log("=====================>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> rendering ChatBotDlg"),e.jsx("div",{className:"pe-6 overflow-auto chat-bot-dlg",children:e.jsxs(y,{show:u,onHide:x,placement:"end",scroll:!0,backdrop:!0,onEntering:Y,children:[" ",e.jsx(y.Header,{closeButton:!0,children:e.jsx(y.Title,{className:"fs-6",children:"I am your Buddy"})}),e.jsx(y.Body,{className:"p-0 border border-1 rounded-3",children:e.jsxs(xe,{id:"container",fluid:!0,className:"text-primary",children:[" ",e.jsx(_,{className:"m-0",children:e.jsx(q,{})}),e.jsx(_,{className:"m-0",children:e.jsxs(q,{className:"border border-0 border-primary mx-1 text-white p-0",children:[e.jsx("div",{className:"history",children:X.map(s=>{switch(s.type){case 0:return e.jsx(T,{...s});case 1:return e.jsx(ae,{...s});case 2:return e.jsx(R,{...s});default:return e.jsx("div",{children:"unknown"})}})},"history"),F&&e.jsx("div",{children:e.jsx(R,{type:2,isDisabled:!1,txt:t?t.answerTitle:"no answers",hasMoreAnswers:G,link:t?t.answerLink:""})},"answer"),J&&!D&&e.jsx(C,{variant:"secondary",size:"sm",type:"button",onClick:()=>{A(h+1),E(!0)},className:"m-1 border border-1 rounded-1 py-0",children:"New Question"},"newQuestion"),D&&e.jsx("div",{className:"pb-35 questions",children:e.jsx(T,{type:0,isDisabled:!1,txt:g,link:null})}),e.jsx("div",{ref:Z,children:"dno dna"})]})})]})})]})})};export{pe as default};
//# sourceMappingURL=ChatBotDlg-BP5OauUj.js.map
