{"version":3,"file":"ChatBotDlg-CfUt7u5j.js","sources":["../../src/hooks/useAI.tsx","../../src/ChatBotDlg.tsx"],"sourcesContent":["import { useCallback, useState } from \"react\";\r\n\r\nimport type { IAssignedAnswer, IQuestion, IQuestionKey } from '@/categories/types';\r\nimport { type IWhoWhen } from \"@/global/types\";\r\n\r\nexport interface IChatBotAnswer {\r\n  questionKey?: IQuestionKey;\r\n  topId: string;\r\n  id: string;\r\n  answerTitle: string;\r\n  answerLink: string | null;\r\n  created: IWhoWhen,\r\n  modified: IWhoWhen | null\r\n}\r\n\r\nclass ChatBotAnswer {\r\n  constructor(assignedAnswer: IAssignedAnswer) {\r\n    const { topId, id, answerTitle, answerLink } = assignedAnswer; // , created, modified\r\n    this.chatBotAnswer = {\r\n      topId,\r\n      id,\r\n      answerTitle: answerTitle ?? '',\r\n      answerLink: answerLink ?? '',\r\n      created: assignedAnswer.created!,\r\n      modified: assignedAnswer.modified!\r\n    }\r\n  }\r\n  chatBotAnswer: IChatBotAnswer\r\n}\r\n\r\n\r\nexport interface INewQuestion {\r\n  firstChatBotAnswer: IChatBotAnswer | null;\r\n  hasMoreAnswers: boolean;\r\n}\r\n\r\nexport interface INextAnswer {\r\n  nextChatBotAnswer: IChatBotAnswer | null; //undefined;\r\n  hasMoreAnswers: boolean;\r\n}\r\n\r\nexport const useAI = (/*categories: ICategory[]*/): [\r\n  (question: IQuestion) => Promise<INewQuestion>,\r\n  () => Promise<IQuestion | null>,\r\n  () => Promise<INextAnswer>] => {\r\n\r\n\r\n  const [question, setQuestion] = useState<IQuestion | null>(null);\r\n  const [index, setIndex] = useState<number>(0);\r\n\r\n  const setNewQuestion = async (q: IQuestion): Promise<INewQuestion> => {\r\n    setQuestion(q);\r\n    let hasMoreAnswers = false;\r\n    let firstChatBotAnswer: IChatBotAnswer | null = null;\r\n    if (q) {\r\n      const { assignedAnswers } = q;\r\n      if (assignedAnswers && assignedAnswers.length > 0) {\r\n        const assignedAnswer = assignedAnswers[0];\r\n        firstChatBotAnswer = new ChatBotAnswer(assignedAnswer).chatBotAnswer;\r\n        hasMoreAnswers = assignedAnswers.length > 1;\r\n        setIndex(0);\r\n      }\r\n    }\r\n    return { firstChatBotAnswer, hasMoreAnswers };\r\n  }\r\n\r\n  const getCurrQuestion = useCallback(\r\n    async (): Promise<IQuestion | null> => {\r\n      return question\r\n    }, [question]);\r\n\r\n\r\n  const getNextChatBotAnswer = useCallback(\r\n    async (): Promise<INextAnswer> => {\r\n      const { assignedAnswers } = question!;\r\n      const len = assignedAnswers.length;\r\n      const i = index + 1;\r\n      if (index + 1 < len) {\r\n        setIndex(i);\r\n        return {\r\n          nextChatBotAnswer: new ChatBotAnswer(assignedAnswers[i]).chatBotAnswer,\r\n          hasMoreAnswers: i + 1 < len\r\n        }\r\n      }\r\n      return { nextChatBotAnswer: null, hasMoreAnswers: false }\r\n    }, [question, index]);\r\n\r\n  return [setNewQuestion, getCurrQuestion, getNextChatBotAnswer]\r\n  // useCallback(setNewQuestion, []), \r\n  // useCallback(getCurrQuestion, [question]), \r\n  // useCallback(getNextChatBotAnswer, [question])\r\n}\r\n","import { useState, useRef,  useEffect } from 'react';\r\nimport { Container, Row, Col, Button, Offcanvas } from \"react-bootstrap\";\r\n//import { useNavigate } from \"react-router-dom\";\r\n\r\nimport { useGlobalContext, useGlobalState } from '@/global/GlobalProvider';\r\n\r\nimport { useParams } from 'react-router-dom' // useRouteMatch\r\nimport { AutoSuggestQuestions } from '@/categories/AutoSuggestQuestions';\r\n\r\n// import { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\r\n// import { faFolder } from '@fortawesome/free-solid-svg-icons'\r\n\r\nimport { type ICategoryRow, type IQuestion, type IQuestionEx, type IQuestionKey, QuestionKey } from '@/categories/types';\r\nimport type { IHistory, IHistoryFilter } from '@/global/types';\r\nimport { type IChatBotAnswer, type INewQuestion, type INextAnswer, useAI } from '@/hooks/useAI'\r\n\r\nimport Q from '@/assets/Q.png';\r\nimport A from '@/assets/A.png';\r\n// import { useCategoryDispatch } from '@/categories/CategoryProvider';\r\n\r\ntype ChatBotParams = {\r\n    source: string;\r\n    tekst: string;\r\n    email?: string;\r\n};\r\n\r\ntype ICatLevel = {\r\n    level: number;\r\n    catId: string | null;\r\n    header: string;\r\n    subCats: ICategoryRow[];\r\n    subCatIdSelected: string | null;\r\n}\r\n\r\ninterface IProps {\r\n    show: boolean,\r\n    onHide: () => void;\r\n}\r\n\r\n\r\nconst ChatBotDlg = ({ show, onHide }: IProps) => {\r\n    let { tekst } = useParams<ChatBotParams>();\r\n    const [autoSuggestionValue, setAutoSuggestionValue] = useState(tekst!)\r\n    const [setNewQuestion, getCurrQuestion, getNextChatBotAnswer] = useAI(/*[]*/);\r\n    const [selectedQuestion, setSelectedQuestion] = useState<IQuestion | null>(null);\r\n    const [autoSuggestId, setAutoSuggestId] = useState<number>(1);\r\n    const [showAnswer, setShowAnswer] = useState(false);\r\n    const [chatBotAnswer, setChatBotAnswer] = useState<IChatBotAnswer | null>(null);\r\n    const [hasMoreAnswers, setHasMoreAnswers] = useState<boolean>(false);\r\n\r\n    const { loadAllCategoryRowsGlobal, getSubCats, getQuestion, addHistory, addHistoryFilter, searchQuestions } = useGlobalContext();\r\n    const { authUser, isDarkMode, allCategoryRowsGlobal, allCategoryRowsGlobalLoaded } = useGlobalState();\r\n    //const navigate = useNavigate();\r\n\r\n    const [catsSelected] = useState(true);\r\n    const [showAutoSuggest, setShowAutoSuggest] = useState(true); //false);\r\n\r\n    const [catLevels, setCatLevels] = useState<ICatLevel[]>([]);\r\n\r\n    const [pastEvents, setPastEvents] = useState<IChild[]>([]);\r\n\r\n    enum ChildType {\r\n        AUTO_SUGGEST,\r\n        QUESTION,\r\n        ANSWER\r\n    }\r\n\r\n    interface IChild {\r\n        type: ChildType;\r\n        isDisabled: boolean;\r\n        txt: string,\r\n        link: string | null,\r\n        hasMoreAnswers?: boolean\r\n    }\r\n    // const deca: JSX.Element[] = [];\r\n    useEffect(() => {\r\n        (async () => {\r\n            if (!allCategoryRowsGlobalLoaded)\r\n                await loadAllCategoryRowsGlobal();\r\n        })()\r\n    }, [allCategoryRowsGlobalLoaded, loadAllCategoryRowsGlobal]);\r\n\r\n    const onEntering = async (/*node: HTMLElement, isAppearing: boolean*/): Promise<any> => {\r\n        setCatLevels([]);\r\n        const parentId = 'MTS';\r\n        const res = await getSubCats(parentId);\r\n        const { subCats, parentHeader } = res;\r\n        setCatLevels((prevState) => ([\r\n            ...prevState,\r\n            {\r\n                level: 1,\r\n                catId: parentId,\r\n                header: parentHeader,\r\n                subCats,\r\n                subCatIdSelected: null\r\n            }\r\n        ]))\r\n        console.log(catLevels)\r\n\r\n    }\r\n\r\n    const scrollableRef = useRef<HTMLDivElement>(null);\r\n\r\n    // useEffect(() => {\r\n    //     scrollToBottom();\r\n    // }, []);\r\n\r\n    // const AutoSuggestQuestions = lazy(() =>\r\n    //     // named export\r\n    //     import(\"@/categories/AutoSuggestQuestions\").then((module) => ({ default: module.AutoSuggestQuestions }))\r\n    // );\r\n\r\n    if (!allCategoryRowsGlobalLoaded) // || catsOptions.length === 0)\r\n        return <div>Loading ...</div>\r\n\r\n    /*\r\n    const onOptionChange = async (id: string, level: number, title: string) => {//event: React.ChangeEvent<HTMLInputElement>) => {\r\n        //const target = event.target;\r\n        //const { id, name } = target;\r\n        //const value = type === 'checkbox' ? target.checked : target.value;\r\n        //const level = parseInt(name as any);\r\n        // update the last level\r\n        const prev = catLevels.map(catLevel => catLevel.level === level\r\n            ? {\r\n                ...catLevel,\r\n                subCatIdSelected: id,\r\n                header: title\r\n            }\r\n            : catLevel\r\n        )\r\n\r\n        const res = await getSubCats(id);\r\n        const { subCats, parentHeader } = res;\r\n\r\n        console.log('///////////////////////////////////////////////////// id:', id, subCats)\r\n        setCatLevels((prevState) => ([\r\n            ...prev,\r\n            {\r\n                level: level + 1,\r\n                catId: id,\r\n                header: parentHeader,\r\n                subCats,\r\n                subCatIdSelected: null\r\n            }\r\n        ]))\r\n        //setShowUsage(true);\r\n        // setCatOptions((prevState) => ({ \r\n        // \tstateName: prevState.stateName + 1 \r\n        // }))\r\n        // this.setState({\r\n        // \t [name]: value\r\n        // });\r\n    }\r\n    */\r\n\r\n    const onSelectQuestion = async (questionKey: IQuestionKey, underFilter: string) => {\r\n        const questionCurr = await getCurrQuestion();\r\n        if (questionCurr) {\r\n            console.log({ questionCurr })\r\n            const historyFilter: IHistoryFilter = {\r\n                questionKey: new QuestionKey(questionCurr).questionKey!,\r\n                filter: underFilter,\r\n                created: { time: new Date(), nickName: authUser.nickName }\r\n            }\r\n            await addHistoryFilter(historyFilter);\r\n        }\r\n        // navigate(`/categories/${categoryId}_${questionId.toString()}`)\r\n        // const question = await getQuestion(questionId);\r\n\r\n        // salji kasnije kad klikne na Fixed\r\n        /* TODO proveri\r\n        if (answer) {\r\n            const history: IHistory = {\r\n                questionId: questionKey.id,\r\n                answerId: answer.id,\r\n                fixed: undefined,\r\n                created: { \r\n                    nickName: authUser.nickName, \r\n                    time: new Date() \r\n                }\r\n            }\r\n            addHistory(history);\r\n        }\r\n        */\r\n        if (chatBotAnswer) {\r\n            const props: IChild = {\r\n                type: ChildType.ANSWER,\r\n                isDisabled: true,\r\n                txt: chatBotAnswer.answerTitle,\r\n                link: chatBotAnswer.answerLink\r\n            }\r\n            setPastEvents((prevEvents) => [...prevEvents, props]);\r\n        }\r\n\r\n        const questionEx: IQuestionEx = await getQuestion(questionKey);\r\n        const { question } = questionEx;\r\n        if (!question) {\r\n            //alert(questionEx.msg)\r\n            return;\r\n        }\r\n        if (question.numOfRelatedFilters > 0) {\r\n            setAutoSuggestionValue(question.relatedFilters[0].filter)\r\n        }\r\n\r\n        const res: INewQuestion = await setNewQuestion(question);\r\n        let { firstChatBotAnswer, hasMoreAnswers } = res; // as unknown as INewQuestion;\r\n\r\n        if (question) {\r\n            const props: IChild = {\r\n                type: ChildType.QUESTION,\r\n                isDisabled: true,\r\n                txt: question.title,\r\n                link: null\r\n            }\r\n            setPastEvents((prevEvents) => [...prevEvents, props]);\r\n        }\r\n\r\n        setAutoSuggestId((autoSuggestId) => autoSuggestId + 1);\r\n        setShowAutoSuggest(false);\r\n        setSelectedQuestion(question);\r\n        setShowAnswer(true);\r\n        setHasMoreAnswers(hasMoreAnswers);\r\n        //setAnswerId((answerId) => answerId + 1);\r\n        setChatBotAnswer(firstChatBotAnswer);\r\n        // // salji kasnije kad klikne na Fixed\r\n        // if (firstAnswer) {\r\n        // \taddHistory(dbp, {\r\n        // \t\tconversation: conv,\r\n        // \t\tclient: authUser.nickName,\r\n        // \t\tquestionId: question!.id!,\r\n        // \t\tanswerId: firstAnswer.id!,\r\n        // \t\tfixed: undefined,\r\n        // \t\tcreated: new Date()\r\n        // \t})\r\n        // }\r\n    }\r\n\r\n    const onAnswerFixed = async () => {\r\n        const props: IChild = {\r\n            type: ChildType.ANSWER,\r\n            isDisabled: true,\r\n            txt: chatBotAnswer ? chatBotAnswer.answerTitle : 'no answer title',\r\n            link: chatBotAnswer ? chatBotAnswer.answerLink : 'no answer link',\r\n            hasMoreAnswers: true\r\n        }\r\n        setPastEvents((prevHistory) => [...prevHistory, props]);\r\n\r\n        const history: IHistory = {\r\n            questionKey: new QuestionKey(selectedQuestion!).questionKey!,\r\n            assignedAnswerKey: { topId: chatBotAnswer!.topId, id: chatBotAnswer!.id },\r\n            userAction: 'Fixed',\r\n            created: {\r\n                nickName: authUser.nickName,\r\n                time: new Date()\r\n            }\r\n        }\r\n        addHistory(history);\r\n\r\n        //\r\n        // TODO logic \r\n        //\r\n\r\n        setHasMoreAnswers(false);\r\n        //setAnswerId((answerId) => answerId + 1);\r\n        setChatBotAnswer(chatBotAnswer); //undefined);\r\n        setShowAnswer(false);\r\n    }\r\n\r\n    const getNextAnswer = async () => {\r\n        // past events\r\n        const props: IChild = {\r\n            type: ChildType.ANSWER,\r\n            isDisabled: true,\r\n            txt: chatBotAnswer ? chatBotAnswer.answerTitle : 'no answer',\r\n            link: chatBotAnswer ? chatBotAnswer.answerLink : 'no link',\r\n            hasMoreAnswers: true\r\n        }\r\n        setPastEvents((prevHistory) => [...prevHistory, props]);\r\n\r\n        const next: INextAnswer = await getNextChatBotAnswer();\r\n        const { nextChatBotAnswer, hasMoreAnswers } = next;\r\n\r\n        if (chatBotAnswer) {\r\n            const history: IHistory = {\r\n                questionKey: new QuestionKey(selectedQuestion!).questionKey!,\r\n                assignedAnswerKey: { topId: chatBotAnswer.topId, id: chatBotAnswer.id },\r\n                userAction: nextChatBotAnswer ? 'NotFixed' : 'NotClicked',\r\n                created: {\r\n                    nickName: authUser.nickName,\r\n                    time: new Date()\r\n                }\r\n            }\r\n            addHistory(history);\r\n        }\r\n\r\n        // salji gore\r\n        // if (nextAnswer) {\r\n        // \taddHistory(dbp, {\r\n        // \t\tconversation,\r\n        // \t\tclient: authUser.nickName,\r\n        // \t\tquestionId: selectedQuestion!.id!,\r\n        // \t\tanswerId: nextAnswer.id!,\r\n        // \t\tfixed: hasMoreAnswers ? undefined : false,\r\n        // \t\tcreated: new Date()\r\n        // \t})\r\n        // }\r\n        setHasMoreAnswers(hasMoreAnswers);\r\n        //setAnswerId((answerId) => answerId + 1); PPP\r\n        console.log('----->>>>', { nextChatBotAnswer })\r\n        setChatBotAnswer(nextChatBotAnswer);\r\n    }\r\n\r\n    /*const NavigLink = (link: string) => {\r\n        //dispatch({ type: ActionTypes.RESET_CATEGORY_QUESTION_DONE })\r\n        //dispatch({ type: ActionTypes.CLEAN_SUB_TREE, payload: { categoryKey: null } });\r\n        // new CategoryKey(parentCat).categoryKey } });\r\n        setTimeout(() => {\r\n            navigate(link + \"/true\")\r\n        }, 100);\r\n    }\r\n    */\r\n\r\n\r\n    const QuestionComponent = (props: IChild) => {\r\n        const { txt } = props;\r\n        return (\r\n            <div id={autoSuggestId.toString()} className=\"d-flex flex-row mx-0 justify-content-start align-items-center\">\r\n                <div className=\"d-flex flex-row mx-0 justify-content-start align-items-center\">\r\n                    <img width=\"22\" height=\"18\" src={Q} alt=\"Question\" className='ms-1' />\r\n                    <div className=\"p-1 bg-warning text-light flex-wrap text-wrap border rounded-1\">{txt}</div>\r\n                </div>\r\n            </div>\r\n        )\r\n    }\r\n\r\n    const AnswerComponent = (props: IChild) => {\r\n        console.log('--------------------------------------AnswerComponent', props)\r\n        const { isDisabled, txt, link } = props;\r\n        return (\r\n            <div\r\n                // id={answerId.toString()}   PPP\r\n                id={chatBotAnswer?.id}\r\n                className={`${isDarkMode ? \"dark\" : \"light\"} mt-1 mx-1 border border-0 rounded-1`}\r\n            >\r\n                {/* <Row>\r\n                    <Col xs={12} md={12} className={`${isDisabled ? 'secondary' : 'primary'} d-flex justify-content-start align-items-center p-0`}> */}\r\n\r\n                <div className=\"d-flex flex-row mx-0 justify-content-start align-items-center\">\r\n                    <div className=\"d-flex flex-row mx-0 justify-content-start align-items-center\">\r\n                        <img width=\"22\" height=\"18\" src={A} alt=\"Answer\" className='ms-1' />\r\n                        {link\r\n                            ? <div className=\"p-1 bg-info text-light flex-wrap text-wrap border rounded-1 \">\r\n                                <a\r\n                                    href={link!}\r\n                                    rel=\"noopener noreferrer\"\r\n                                    target=\"_blank\"\r\n                                    className=\"text-light text-decoration-underline\"\r\n                                >\r\n                                    {txt}\r\n                                </a>\r\n                            </div>\r\n                            : <div className=\"p-1 bg-info text-light flex-wrap text-wrap border rounded-1\">\r\n                                {txt}\r\n                            </div>\r\n\r\n                        }\r\n                    </div>\r\n\r\n                    {!isDisabled && chatBotAnswer &&\r\n                        <div>\r\n                            <Button\r\n                                size=\"sm\"\r\n                                type=\"button\"\r\n                                onClick={onAnswerFixed}\r\n                                disabled={!chatBotAnswer}\r\n                                className='align-middle ms-1 px-1  py-0'\r\n                                variant=\"success\"\r\n                            >\r\n                                Fixed\r\n                            </Button>\r\n                            <Button\r\n                                size=\"sm\"\r\n                                type=\"button\"\r\n                                onClick={getNextAnswer}\r\n                                disabled={!chatBotAnswer}\r\n                                className='align-middle ms-1 border border-1 rounded-1 px-1 py-0'\r\n                                variant=\"danger\"\r\n                            >\r\n                                Not fixed\r\n                            </Button>\r\n                        </div>\r\n                    }\r\n                </div>\r\n\r\n                {/* <div className=\"d-flex flex-row flex-wrap mx-0\"> */}\r\n                {/* <div className=\"card card-block  bg-info text-light\">\r\n                                <div className=\"card-body p-0\">\r\n                                    <div className=\"card-text d-flex justify-content-start align-items-center\">\r\n                                        \r\n                                        \r\n                                        {link ? <a href={link} target=\"_blank\" className=\"text-reset text-decoration-none fw-lighter fs-6\" >{link}</a> : null}\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                            <div className=\"card card-block  border-0\">\r\n                                <div className=\"card-body p-0 border-0\">\r\n                                    <div className=\"card-text\">\r\n                                        {!isDisabled && chatBotAnswer &&\r\n                                            <div>\r\n                                                <Button\r\n                                                    size=\"sm\"\r\n                                                    type=\"button\"\r\n                                                    onClick={onAnswerFixed}\r\n                                                    disabled={!chatBotAnswer}\r\n                                                    className='align-middle ms-1 p-0'\r\n                                                    variant=\"success\"\r\n                                                >\r\n                                                    Fixed\r\n                                                </Button>\r\n                                                <Button\r\n                                                    size=\"sm\"\r\n                                                    type=\"button\"\r\n                                                    onClick={getNextAnswer}\r\n                                                    disabled={!chatBotAnswer}\r\n                                                    className='align-middle ms-1 border border-1 rounded-1 p-0'\r\n                                                    variant=\"danger\"\r\n                                                >\r\n                                                    Not fixed\r\n                                                </Button>\r\n                                            </div>\r\n                                        }\r\n                                    </div>\r\n                                </div>\r\n                            </div> */}\r\n\r\n                {/* </div> */}\r\n\r\n                {/* </Col>\r\n                </Row> */}\r\n            </div>\r\n        );\r\n    };\r\n\r\n    const AutoSuggestComponent = (props: IChild) => {\r\n        const { isDisabled, txt } = props;\r\n        return <div className=\"dark\">\r\n            <label className=\"text-warning\">Please enter the Question</label>\r\n            <div className=\"text-start\">\r\n                <div className=\"questions\">\r\n                    {isDisabled &&\r\n                        <div>\r\n                            {txt}\r\n                        </div>\r\n                    }\r\n                    {!isDisabled &&\r\n                            <AutoSuggestQuestions\r\n                                tekst={txt}\r\n                                onSelectQuestion={onSelectQuestion}\r\n                                allCategoryRows={allCategoryRowsGlobal}\r\n                                searchQuestions={searchQuestions}\r\n                            />\r\n                    }\r\n                </div>\r\n            </div>\r\n        </div>\r\n    }\r\n\r\n    // const scrollToBottom = () => {\r\n    //     scrollableRef.current?.scrollIntoView({ behavior: 'smooth', block: 'end' });\r\n    // };\r\n    console.log(\"=====================>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> rendering ChatBotDlg\")\r\n    return (\r\n        <div className=\"pe-6 overflow-auto chat-bot-dlg\">\r\n            {/* <Button variant=\"primary\" onClick={onHide}>\r\n                Toggle static offcanvas\r\n            </Button> */}\r\n\r\n            {/* backdrop=\"static\" */}\r\n            <Offcanvas show={show} onHide={onHide} placement='end' scroll={true} backdrop={true} onEntering={onEntering}> {/* backdropClassName='chat-bot-dlg' */}\r\n                <Offcanvas.Header closeButton>\r\n                    <Offcanvas.Title className=\"fs-6\">\r\n                        I am your Buddy\r\n                    </Offcanvas.Title>\r\n                </Offcanvas.Header>\r\n                <Offcanvas.Body className=\"p-0 border border-1 rounded-3\">\r\n                    <Container id='container' fluid className='text-primary'> {/* align-items-center\" */}\r\n                        <Row className=\"m-0\">\r\n                            <Col>\r\n                                {/* <p className='p-0 m-0 fw-lighter'>For test, Select:</p>\r\n                                <ul className=\"m-0\">\r\n                                    <li className='p-0 fw-lighter'>Sale</li>\r\n                                    <li className='mx-2 fw-lighter'>Phones, TV, ...</li>\r\n                                    <li className='mx-4 p-0 mb-4 fw-lighter'>Televisions, remote controllers, ...</li>\r\n                                </ul> */}\r\n                            </Col>\r\n                        </Row>\r\n                        {/* badge */}\r\n                        <Row className=\"m-0\">\r\n                            <Col className='border border-0 border-primary mx-1 text-white p-0'>\r\n                                {/* <div className=\"d-inline\"> */}\r\n                                {/* <div key='Welcome'>\r\n                                    <p><b>Welcome</b>, I am Buddy and I am here to help You</p>\r\n                                </div> */}\r\n\r\n                                {/* <div className='border border-0 border-primary mx-0 text-white'>\r\n                                    {catLevels.map((catLevel) =>\r\n                                        <CatLevelComponent key={catLevel.level} {...catLevel} />\r\n                                    )}\r\n                                </div> */}\r\n\r\n                                <div key='history' className='history'>\r\n                                    {\r\n                                        pastEvents.map(childProps => {\r\n                                            switch (childProps.type) {\r\n                                                case ChildType.AUTO_SUGGEST:\r\n                                                    return <AutoSuggestComponent {...childProps} />;\r\n                                                case ChildType.QUESTION:\r\n                                                    return <QuestionComponent {...childProps} />;\r\n                                                case ChildType.ANSWER:\r\n                                                    return <AnswerComponent {...childProps} />;\r\n                                                default:\r\n                                                    return <div>unknown</div>\r\n                                            }\r\n                                        })\r\n                                    }\r\n                                </div>\r\n\r\n                                {showAnswer &&\r\n                                    <div key=\"answer\">\r\n                                        <AnswerComponent\r\n                                            type={ChildType.ANSWER}\r\n                                            isDisabled={false}\r\n                                            txt={chatBotAnswer ? chatBotAnswer.answerTitle : 'no answers'}\r\n                                            hasMoreAnswers={hasMoreAnswers}\r\n                                            link={chatBotAnswer ? chatBotAnswer.answerLink : ''}\r\n                                        />\r\n                                    </div>\r\n                                }\r\n\r\n                                {catsSelected && !showAutoSuggest &&\r\n                                    <Button\r\n                                        key=\"newQuestion\"\r\n                                        variant=\"secondary\"\r\n                                        size=\"sm\"\r\n                                        type=\"button\"\r\n                                        onClick={() => {\r\n                                            setAutoSuggestId(autoSuggestId + 1);\r\n                                            setShowAutoSuggest(true);\r\n                                        }}\r\n                                        className='m-1 border border-1 rounded-1 py-0'\r\n                                    >\r\n                                        New Question\r\n                                    </Button>\r\n                                }\r\n\r\n                                {showAutoSuggest &&\r\n                                    <div className=\"pb-35 questions\">\r\n                                        <AutoSuggestComponent\r\n                                            type={ChildType.AUTO_SUGGEST}\r\n                                            isDisabled={false}\r\n                                            txt={autoSuggestionValue!}\r\n                                            link={null}\r\n                                        />\r\n                                    </div>\r\n                                }\r\n                                {/* </div> */}\r\n                                <div ref={scrollableRef}>dno dna</div>\r\n                            </Col>\r\n                        </Row>\r\n                    </Container>\r\n                </Offcanvas.Body>\r\n            </Offcanvas>\r\n\r\n        </div>\r\n    )\r\n};\r\n\r\nexport default ChatBotDlg;"],"names":["ChatBotAnswer","assignedAnswer","topId","id","answerTitle","answerLink","useAI","question","setQuestion","useState","index","setIndex","setNewQuestion","q","hasMoreAnswers","firstChatBotAnswer","assignedAnswers","getCurrQuestion","useCallback","getNextChatBotAnswer","len","i","ChatBotDlg","show","onHide","tekst","useParams","autoSuggestionValue","setAutoSuggestionValue","selectedQuestion","setSelectedQuestion","autoSuggestId","setAutoSuggestId","showAnswer","setShowAnswer","chatBotAnswer","setChatBotAnswer","setHasMoreAnswers","loadAllCategoryRowsGlobal","getSubCats","getQuestion","addHistory","addHistoryFilter","searchQuestions","useGlobalContext","authUser","isDarkMode","allCategoryRowsGlobal","allCategoryRowsGlobalLoaded","useGlobalState","catsSelected","showAutoSuggest","setShowAutoSuggest","catLevels","setCatLevels","pastEvents","setPastEvents","ChildType","useEffect","onEntering","parentId","res","subCats","parentHeader","prevState","scrollableRef","useRef","jsx","onSelectQuestion","questionKey","underFilter","questionCurr","historyFilter","QuestionKey","props","prevEvents","questionEx","onAnswerFixed","prevHistory","history","getNextAnswer","next","nextChatBotAnswer","QuestionComponent","txt","jsxs","Q","AnswerComponent","isDisabled","link","A","Button","AutoSuggestComponent","AutoSuggestQuestions","Offcanvas","Container","Row","Col","childProps"],"mappings":"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"}